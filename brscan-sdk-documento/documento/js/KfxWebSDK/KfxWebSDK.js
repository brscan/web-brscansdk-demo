var compatibility=function(){"use strict";var e=0,t=!0,i=window.URL||window.webkitURL,a=function(t,i){var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,i){var a=(new Date).getTime(),n=Math.max(0,16-(a-e)),r=window.setTimeout(function(){t(a+n)},n);return e=a+n,r};return a.call(window,t,i)},n=function(e){var t=window.cancelAnimationFrame||function(e){clearTimeout(e)};return t.call(window,e)},r=function(e,t,i){if(!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia){var a=window.navigator.mediaDevices.getUserMedia||window.navigator.getUserMedia||window.navigator.mozGetUserMedia||window.navigator.webkitGetUserMedia||window.navigator.msGetUserMedia||function(e,t,i){i()};return a.call(window.navigator,e,t,i)}window.navigator.mediaDevices.getUserMedia(e).then(function(e){t(e)})["catch"](function(e){i(e)})},o=function(){var e=new ArrayBuffer(8),i=new Uint32Array(e);return i[0]=4278190080,t=!0,255===e[0]&&(t=!1),t};return{URL:i,requestAnimationFrame:a,cancelAnimationFrame:n,getUserMedia:r,detectEndian:o,isLittleEndian:t}}();/*
The MIT License (MIT)

Copyright (c) 2008 Jacob Seidelin

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/
(function(){"use strict";function e(e){return!!e.exifdata}function t(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var i=atob(e),a=i.length,n=new ArrayBuffer(a),r=new Uint8Array(n),o=0;o<a;o++)r[o]=i.charCodeAt(o);return n}function i(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(e){200!=this.status&&0!==this.status||t(this.response)},i.send()}function a(e,a){function o(t){var i=n(t),o=r(t);e.exifdata=i||{},e.iptcdata=o||{},a&&a.call(e)}if(e.src)if(/^data\:/i.test(e.src)){var s=t(e.src);o(s)}else if(/^blob\:/i.test(e.src)){var l=new FileReader;l.onload=function(e){o(e.target.result)},i(e.src,function(e){l.readAsArrayBuffer(e)})}else{var c=new XMLHttpRequest;c.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";o(c.response),c=null},c.open("GET",e.src,!0),c.responseType="arraybuffer",c.send(null)}else if(window.FileReader&&(e instanceof window.Blob||e instanceof window.File)){var l=new FileReader;l.onload=function(e){f&&console.log("Got file of length "+e.target.result.byteLength),o(e.target.result)},l.readAsArrayBuffer(e)}}function n(e){var t=new DataView(e);if(f&&console.log("Got file of length "+e.byteLength),255!=t.getUint8(0)||216!=t.getUint8(1))return f&&console.log("Not a valid JPEG"),!1;for(var i,a=2,n=e.byteLength;a<n;){if(255!=t.getUint8(a))return f&&console.log("Not a valid marker at offset "+a+", found: "+t.getUint8(a)),!1;if(i=t.getUint8(a+1),f&&console.log(i),225==i)return f&&console.log("Found 0xFFE1 marker"),u(t,a+4,t.getUint16(a+2)-2);a+=2+t.getUint16(a+2)}}function r(e){var t=new DataView(e);if(f&&console.log("Got file of length "+e.byteLength),255!=t.getUint8(0)||216!=t.getUint8(1))return f&&console.log("Not a valid JPEG"),!1;for(var i=2,a=e.byteLength,n=function(e,t){return 56===e.getUint8(t)&&66===e.getUint8(t+1)&&73===e.getUint8(t+2)&&77===e.getUint8(t+3)&&4===e.getUint8(t+4)&&4===e.getUint8(t+5)};i<a;){if(n(t,i)){var r=t.getUint8(i+7);r%2!==0&&(r+=1),0===r&&(r=4);var s=i+8+r,l=t.getUint16(i+6+r);return o(e,s,l)}i++}}function o(e,t,i){for(var a,n,r,o,s,l=new DataView(e),u={},f=t;f<t+i;)28===l.getUint8(f)&&2===l.getUint8(f+1)&&(o=l.getUint8(f+2),o in y&&(r=l.getInt16(f+3),s=r+5,n=y[o],a=c(l,f+5,r),u.hasOwnProperty(n)?u[n]instanceof Array?u[n].push(a):u[n]=[u[n],a]:u[n]=a)),f++;return u}function s(e,t,i,a,n){var r,o,s,c=e.getUint16(i,!n),u={};for(s=0;s<c;s++)r=i+12*s+2,o=a[e.getUint16(r,!n)],!o&&f&&console.log("Unknown tag: "+e.getUint16(r,!n)),u[o]=l(e,r,t,i,n);return u}function l(e,t,i,a,n){var r,o,s,l,u,f,h=e.getUint16(t+2,!n),d=e.getUint32(t+4,!n),p=e.getUint32(t+8,!n)+i;switch(h){case 1:case 7:if(1==d)return e.getUint8(t+8,!n);for(r=d>4?p:t+8,o=[],l=0;l<d;l++)o[l]=e.getUint8(r+l);return o;case 2:return r=d>4?p:t+8,c(e,r,d-1);case 3:if(1==d)return e.getUint16(t+8,!n);for(r=d>2?p:t+8,o=[],l=0;l<d;l++)o[l]=e.getUint16(r+2*l,!n);return o;case 4:if(1==d)return e.getUint32(t+8,!n);for(o=[],l=0;l<d;l++)o[l]=e.getUint32(p+4*l,!n);return o;case 5:if(1==d)return u=e.getUint32(p,!n),f=e.getUint32(p+4,!n),s=new Number(u/f),s.numerator=u,s.denominator=f,s;for(o=[],l=0;l<d;l++)u=e.getUint32(p+8*l,!n),f=e.getUint32(p+4+8*l,!n),o[l]=new Number(u/f),o[l].numerator=u,o[l].denominator=f;return o;case 9:if(1==d)return e.getInt32(t+8,!n);for(o=[],l=0;l<d;l++)o[l]=e.getInt32(p+4*l,!n);return o;case 10:if(1==d)return e.getInt32(p,!n)/e.getInt32(p+4,!n);for(o=[],l=0;l<d;l++)o[l]=e.getInt32(p+8*l,!n)/e.getInt32(p+4+8*l,!n);return o}}function c(e,t,i){var a="";for(d=t;d<t+i;d++)a+=String.fromCharCode(e.getUint8(d));return a}function u(e,t){if("Exif"!=c(e,t,4))return f&&console.log("Not valid EXIF data! "+c(e,t,4)),!1;var i,a,n,r,o,l=t+6;if(18761==e.getUint16(l))i=!1;else{if(19789!=e.getUint16(l))return f&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;i=!0}if(42!=e.getUint16(l+2,!i))return f&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var u=e.getUint32(l+4,!i);if(u<8)return f&&console.log("Not valid TIFF data! (First offset less than 8)",e.getUint32(l+4,!i)),!1;if(a=s(e,l,l+u,g,i),a.ExifIFDPointer){r=s(e,l,l+a.ExifIFDPointer,m,i);for(n in r){switch(n){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":r[n]=S[n][r[n]];break;case"ExifVersion":case"FlashpixVersion":r[n]=String.fromCharCode(r[n][0],r[n][1],r[n][2],r[n][3]);break;case"ComponentsConfiguration":r[n]=S.Components[r[n][0]]+S.Components[r[n][1]]+S.Components[r[n][2]]+S.Components[r[n][3]]}a[n]=r[n]}}if(a.GPSInfoIFDPointer){o=s(e,l,l+a.GPSInfoIFDPointer,v,i);for(n in o){switch(n){case"GPSVersionID":o[n]=o[n][0]+"."+o[n][1]+"."+o[n][2]+"."+o[n][3]}a[n]=o[n]}}return a}var f=!1,h=this,d=0,p=function(e){return e instanceof p?e:this instanceof p?void(this.EXIFwrapped=e):new p(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports.EXIF=p):h.EXIF=p;var m=p.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},g=p.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},v=p.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},S=p.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},y={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};p.getData=function(t,i){return!((t instanceof Image||t instanceof HTMLImageElement)&&!t.complete)&&(e(t)?i&&i.call(t):a(t,i),!0)},p.getTag=function(t,i){if(e(t))return t.exifdata[i]},p.getAllTags=function(t){if(!e(t))return{};var i,a=t.exifdata,n={};for(i in a)a.hasOwnProperty(i)&&(n[i]=a[i]);return n},p.pretty=function(t){if(!e(t))return"";var i,a=t.exifdata,n="";for(i in a)a.hasOwnProperty(i)&&(n+="object"==typeof a[i]?a[i]instanceof Number?i+" : "+a[i]+" ["+a[i].numerator+"/"+a[i].denominator+"]\r\n":i+" : ["+a[i].length+" values]\r\n":i+" : "+a[i]+"\r\n");return n},p.readFromBinaryFile=function(e){return n(e)},"function"==typeof define&&define.amd?define("exif-js",[],function(){return p}):"undefined"!=typeof exports?exports.EXIF=p:window.EXIF=p}).call(this);/*
The MIT License

Copyright (c) 2012 Eugene Zatepyakin

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/
var jsfeat=jsfeat||{REVISION:"ALPHA"};!function(e){"use strict";var t=1.192092896e-7,i=1e-37,a=256,n=512,r=1024,o=2048,s=4096,l=1,c=2,u=3,f=4,h=new Int32Array([-1,1,4,-1,4,-1,-1,-1,8,-1,-1,-1,-1,-1,-1,-1,8]),d=function(){return function(e){return 65280&e}}(),p=function(){return function(e){return 255&e}}(),m=function(){return function(e){return h[(65280&e)>>8]}}(),g=0,v=1,S=2,y=3,w=1,b=1,C=2,T=function(){function e(e,t){this.size=(e+7|0)&-8,"undefined"==typeof t?this.buffer=new ArrayBuffer(this.size):(this.buffer=t,this.size=t.length),this.u8=new Uint8Array(this.buffer),this.i32=new Int32Array(this.buffer),this.f32=new Float32Array(this.buffer),this.f64=new Float64Array(this.buffer)}return e}(),A=function(){function e(e,t,i,o){this.type=0|d(i),this.channel=0|p(i),this.cols=0|e,this.rows=0|t,"undefined"==typeof o?this.allocate():(this.buffer=o,this.data=this.type&a?this.buffer.u8:this.type&n?this.buffer.i32:this.type&r?this.buffer.f32:this.buffer.f64)}return e.prototype.allocate=function(){delete this.data,delete this.buffer,this.buffer=new T(this.cols*m(this.type)*this.channel*this.rows),this.data=this.type&a?this.buffer.u8:this.type&n?this.buffer.i32:this.type&r?this.buffer.f32:this.buffer.f64},e.prototype.copy_to=function(e){for(var t=e.data,i=this.data,a=0,n=this.cols*this.rows*this.channel|0;a<n-4;a+=4)t[a]=i[a],t[a+1]=i[a+1],t[a+2]=i[a+2],t[a+3]=i[a+3];for(;a<n;++a)t[a]=i[a]},e.prototype.resize=function(e,t,i){"undefined"==typeof i&&(i=this.channel);var a=e*m(this.type)*i*t;a>this.buffer.size?(this.cols=e,this.rows=t,this.channel=i,this.allocate()):(this.cols=e,this.rows=t,this.channel=i)},e}(),P=function(){function e(e){this.levels=0|e,this.data=new Array(e),this.pyrdown=jsfeat.imgproc.pyrdown}return e.prototype.allocate=function(e,t,i){for(var a=this.levels;--a>=0;)this.data[a]=new A(e>>a,t>>a,i)},e.prototype.build=function(e,t){"undefined"==typeof t&&(t=!0);var i=2,a=e,n=this.data[0];if(!t)for(var r=e.cols*e.rows;--r>=0;)n.data[r]=e.data[r];for(n=this.data[1],this.pyrdown(a,n);i<this.levels;++i)a=n,n=this.data[i],this.pyrdown(a,n)},e}(),E=function(){function e(e,t,i,a,n){"undefined"==typeof e&&(e=0),"undefined"==typeof t&&(t=0),"undefined"==typeof i&&(i=0),"undefined"==typeof a&&(a=0),"undefined"==typeof n&&(n=-1),this.x=e,this.y=t,this.score=i,this.level=a,this.angle=n}return e}();e.U8_t=a,e.S32_t=n,e.F32_t=r,e.S64_t=o,e.F64_t=s,e.C1_t=l,e.C2_t=c,e.C3_t=u,e.C4_t=f,e.U8C1_t=a|l,e.U8C3_t=a|u,e.U8C4_t=a|f,e.F32C1_t=r|l,e.F32C2_t=r|c,e.S32C1_t=n|l,e.S32C2_t=n|c,e.EPSILON=t,e.FLT_MIN=i,e.COLOR_RGBA2GRAY=g,e.COLOR_RGB2GRAY=v,e.COLOR_BGRA2GRAY=S,e.COLOR_BGR2GRAY=y,e.BOX_BLUR_NOSCALE=w,e.SVD_U_T=b,e.SVD_V_T=C,e.get_data_type=d,e.get_channel=p,e.get_data_type_size=m,e.data_t=T,e.matrix_t=A,e.pyramid_t=P,e.keypoint_t=E}(jsfeat),function(e){var t=function(){var e,t,i=function(){function e(e){this.next=null,this.data=new jsfeat.data_t(e),this.size=this.data.size,this.buffer=this.data.buffer,this.u8=this.data.u8,this.i32=this.data.i32,this.f32=this.data.f32,this.f64=this.data.f64}return e.prototype.resize=function(e){delete this.data,this.data=new jsfeat.data_t(e),this.size=this.data.size,this.buffer=this.data.buffer,this.u8=this.data.u8,this.i32=this.data.i32,this.f32=this.data.f32,this.f64=this.data.f64},e}(),a=0;return{allocate:function(n,r){e=t=new i(r);for(var o=0;o<n;++o){var s=new i(r);t=t.next=s,a++}},get_buffer:function(t){var i=e;return e=e.next,a--,t>i.size&&i.resize(t),i},put_buffer:function(e){t=t.next=e,a++}}}();e.cache=t,t.allocate(30,2560)}(jsfeat),function(e){var t=function(){var e=new Int32Array(96);return{get_gaussian_kernel:function(e,t,i,a){var n=0,r=0,o=0,s=0,l=0,c=0,u=jsfeat.cache.get_buffer(e<<2),f=u.f32;if(1==(1&e)&&e<=7&&t<=0)switch(e>>1){case 0:f[0]=1,c=1;break;case 1:f[0]=.25,f[1]=.5,f[2]=.25,c=1;break;case 2:f[0]=.0625,f[1]=.25,f[2]=.375,f[3]=.25,f[4]=.0625,c=1;break;case 3:f[0]=.03125,f[1]=.109375,f[2]=.21875,f[3]=.28125,f[4]=.21875,f[5]=.109375,f[6]=.03125,c=1}else for(s=t>0?t:.3*(.5*(e-1)-1)+.8,l=-.5/(s*s);n<e;++n)r=n-.5*(e-1),o=Math.exp(l*r*r),f[n]=o,c+=o;if(a&jsfeat.U8_t)for(c=256/c,n=0;n<e;++n)i[n]=f[n]*c+.5|0;else for(c=1/c,n=0;n<e;++n)i[n]=f[n]*c;jsfeat.cache.put_buffer(u)},perspective_4point_transform:function(e,t,i,a,n,r,o,s,l,c,u,f,h,d,p,m,g){var v=t,S=c,y=o,w=v*S*y,b=p,C=v*b,T=S*C,A=u,P=v*A,E=r,I=i,_=d,x=I*_,D=x*E,M=_*E*A,L=_*y,R=_*A,O=S*y,k=b*S,G=b*E,F=A*E,U=1/(L-R-O+k-G+F),j=v*_,N=I*E,B=y*v,H=b*B,V=I*S,W=x*A,z=I*A*E,K=y*b*S,X=b*I,q=-(T-w+P*E-E*C-x*S+D-M+L*S)*U,Y=(w-T-j*y+j*A+D-S*N+G*S-M)*U,Z=v,J=(-A*C+H+V*y-x*y+W-z+G*A-K)*U,Q=(-H+B*A-X*S+W-z+X*E+K-L*A)*U,$=I,ee=(-P+B+V-N+R-L-k+G)*U,te=(-C+P+x-V+G-F-L+O)*U;v=a,S=f,y=l,w=v*S*y,b=g,C=v*b,T=S*C,A=h,P=v*A,E=s,I=n,_=m,x=I*_,D=x*E,M=_*E*A,L=_*y,R=_*A,O=S*y,k=b*S,G=b*E,F=A*E,U=1/(L-R-O+k-G+F),j=v*_,N=I*E,B=y*v,H=b*B,V=I*S,W=x*A,z=I*A*E,K=y*b*S,X=b*I;var ie=-(T-w+P*E-E*C-x*S+D-M+L*S)*U,ae=(w-T-j*y+j*A+D-S*N+G*S-M)*U,ne=v,re=(-A*C+H+V*y-x*y+W-z+G*A-K)*U,oe=(-H+B*A-X*S+W-z+X*E+K-L*A)*U,se=I,le=(-P+B+V-N+R-L-k+G)*U,ce=(-C+P+x-V+G-F-L+O)*U;S=Q-te*$,y=q*Q,w=q*$,C=J*Y,T=Z*J,P=Y*ee;var ue=Z*ee;_=1/(y-w*te-C+T*te+P*$-ue*Q),D=-J+$*ee;var fe=-J*te+Q*ee;F=-Y+Z*te;var he=q-ue;N=q*te-P,B=-Y*$+Z*Q;var de=w-T,pe=y-C;z=S*_;var me=F*_,ge=B*_,ve=e.data;ve[0]=ie*z+ae*(D*_)-ne*(fe*_),ve[1]=ie*me+ae*(he*_)-ne*(N*_),ve[2]=-ie*ge-ae*(de*_)+ne*(pe*_),ve[3]=re*z+oe*(D*_)-se*(fe*_),ve[4]=re*me+oe*(he*_)-se*(N*_),ve[5]=-re*ge-oe*(de*_)+se*(pe*_),ve[6]=le*z+ce*(D*_)-fe*_,ve[7]=le*me+ce*(he*_)-N*_,ve[8]=-le*ge-ce*(de*_)+pe*_},qsort:function(t,i,a,n){var r,o,s,l,c=7,u=0,f=0,h=0,d=0,p=0,m=0,g=0,v=0,S=0,y=0,w=0,b=0,C=0,T=0,A=0,P=0,E=0,I=0,_=e;if(!(a-i+1<=1))for(_[0]=i,_[1]=a;u>=0;)for(f=_[u<<1],h=_[(u<<1)+1],u--;;){if(p=h-f+1,p<=c){for(g=f+1;g<=h;g++)for(v=g;v>f&&n(t[v],t[v-1]);v--)r=t[v],t[v]=t[v-1],t[v-1]=r;break}for(I=0,y=f,b=h,T=f+(p>>1),p>40&&(S=p>>3,A=f,P=f+S,E=f+(S<<1),o=t[A],s=t[P],l=t[E],f=n(o,s)?n(s,l)?P:n(o,l)?E:A:n(l,s)?P:n(o,l)?A:E,A=T-S,P=T,E=T+S,o=t[A],s=t[P],l=t[E],T=n(o,s)?n(s,l)?P:n(o,l)?E:A:n(l,s)?P:n(o,l)?A:E,A=h-(S<<1),P=h-S,E=h,o=t[A],s=t[P],l=t[E],h=n(o,s)?n(s,l)?P:n(o,l)?E:A:n(l,s)?P:n(o,l)?A:E),A=f,P=T,E=h,o=t[A],s=t[P],l=t[E],T=n(o,s)?n(s,l)?P:n(o,l)?E:A:n(l,s)?P:n(o,l)?A:E,T!=y&&(r=t[T],t[T]=t[y],t[y]=r,T=y),f=w=y+1,h=C=b,o=t[T];;){for(;f<=h&&!n(o,t[f]);)n(t[f],o)||(f>w&&(r=t[w],t[w]=t[f],t[f]=r),I=1,w++),f++;for(;f<=h&&!n(t[h],o);)n(o,t[h])||(h<C&&(r=t[C],t[C]=t[h],t[h]=r),I=1,C--),h--;if(f>h)break;r=t[f],t[f]=t[h],t[h]=r,I=1,f++,h--}if(0==I){for(f=y,h=b,g=f+1;g<=h;g++)for(v=g;v>f&&n(t[v],t[v-1]);v--)r=t[v],t[v]=t[v-1],t[v-1]=r;break}for(p=Math.min(w-y,f-w),m=f-p|0,d=0;d<p;++d,++m)r=t[y+d],t[y+d]=t[m],t[m]=r;for(p=Math.min(b-C,C-h),m=b-p+1|0,d=0;d<p;++d,++m)r=t[f+d],t[f+d]=t[m],t[m]=r;if(p=f-w,m=C-h,p>1)m>1?p>m?(++u,_[u<<1]=y,_[(u<<1)+1]=y+p-1,f=b-m+1,h=b):(++u,_[u<<1]=b-m+1,_[(u<<1)+1]=b,f=y,h=y+p-1):(f=y,h=y+p-1);else{if(!(m>1))break;f=b-m+1,h=b}}},median:function(e,t,i){for(var a,n=0,r=0,o=0,s=t+i>>1;;){if(i<=t)return e[s];if(i==t+1)return e[t]>e[i]&&(a=e[t],e[t]=e[i],e[i]=a),e[s];for(n=t+i>>1,e[n]>e[i]&&(a=e[n],e[n]=e[i],e[i]=a),e[t]>e[i]&&(a=e[t],e[t]=e[i],e[i]=a),e[n]>e[t]&&(a=e[n],e[n]=e[t],e[t]=a),r=t+1,a=e[n],e[n]=e[r],e[r]=a,o=i;;){do++r;while(e[t]>e[r]);do--o;while(e[o]>e[t]);if(o<r)break;a=e[r],e[r]=e[o],e[o]=a}a=e[t],e[t]=e[o],e[o]=a,o<=s?t=r:o>=s&&(i=o-1)}}}}();e.math=t}(jsfeat),function(e){var t=function(){return{identity:function(e,t){"undefined"==typeof t&&(t=1);for(var i=e.data,a=e.rows,n=e.cols,r=n+1|0,o=a*n,s=o;--o>=0;)i[o]=0;for(o=s,s=0;s<o;)i[s]=t,s+=r},transpose:function(e,t){for(var i=0,a=0,n=t.rows,r=t.cols,o=0,s=0,l=0,c=t.data,u=e.data;i<n;s+=1,o+=r,i++)for(l=s,a=0;a<r;l+=n,a++)u[l]=c[o+a]},multiply:function(e,t,i){for(var a=0,n=0,r=0,o=0,s=0,l=0,c=0,u=0,f=t.cols,h=t.rows,d=i.cols,p=t.data,m=i.data,g=e.data,v=0;a<h;o+=f,a++)for(c=0,n=0;n<d;u++,c++,n++){for(l=c,s=o,v=0,r=0;r<f;s++,l+=d,r++)v+=p[s]*m[l];g[u]=v}},multiply_ABt:function(e,t,i){for(var a=0,n=0,r=0,o=0,s=0,l=0,c=0,u=t.cols,f=t.rows,h=i.rows,d=t.data,p=i.data,m=e.data,g=0;a<f;o+=u,a++)for(l=0,n=0;n<h;c++,n++){for(s=o,g=0,r=0;r<u;s++,l++,r++)g+=d[s]*p[l];m[c]=g}},multiply_AtB:function(e,t,i){for(var a=0,n=0,r=0,o=0,s=0,l=0,c=0,u=0,f=t.cols,h=t.rows,d=i.cols,p=t.data,m=i.data,g=e.data,v=0;a<f;o++,a++)for(c=0,n=0;n<d;u++,c++,n++){for(l=c,s=o,v=0,r=0;r<h;s+=f,l+=d,r++)v+=p[s]*m[l];g[u]=v}},multiply_AAt:function(e,t){for(var i=0,a=0,n=0,r=0,o=0,s=0,l=0,c=0,u=0,f=t.cols,h=t.rows,d=t.data,p=e.data,m=0;i<h;r+=h+1,o=s,i++)for(c=r,u=r,l=o,a=i;a<h;c++,u+=h,a++){for(s=o,m=0,n=0;n<f;n++)m+=d[s++]*d[l++];p[c]=m,p[u]=m}},multiply_AtA:function(e,t){for(var i=0,a=0,n=0,r=0,o=0,s=0,l=0,c=0,u=0,f=t.cols,h=t.rows,d=t.data,p=e.data,m=0;i<f;l+=f,i++)for(r=i,u=l+i,c=u,a=i;a<f;c++,u+=f,a++){for(o=r,s=a,m=0,n=0;n<h;o+=f,s+=f,n++)m+=d[o]*d[s];p[c]=m,p[u]=m}},identity_3x3:function(e,t){"undefined"==typeof t&&(t=1);var i=e.data;i[0]=i[4]=i[8]=t,i[1]=i[2]=i[3]=0,i[5]=i[6]=i[7]=0},invert_3x3:function(e,t){var i=e.data,a=t.data,n=i[4],r=i[8],o=i[5],s=i[7],l=i[0],c=l*n,u=l*o,f=i[3],h=i[1],d=f*h,p=i[2],m=f*p,g=i[6],v=g*h,S=g*p,y=1/(c*r-u*s-d*r+m*s+v*o-S*n);a[0]=(n*r-o*s)*y,a[1]=-(h*r-p*s)*y,a[2]=-(-h*o+p*n)*y,a[3]=-(f*r-o*g)*y,a[4]=(l*r-S)*y,a[5]=-(u-m)*y,a[6]=-(-f*s+n*g)*y,a[7]=-(l*s-v)*y,a[8]=(c-d)*y},multiply_3x3:function(e,t,i){var a=e.data,n=t.data,r=i.data,o=n[0],s=n[1],l=n[2],c=n[3],u=n[4],f=n[5],h=n[6],d=n[7],p=n[8],m=r[0],g=r[1],v=r[2],S=r[3],y=r[4],w=r[5],b=r[6],C=r[7],T=r[8];a[0]=o*m+s*S+l*b,a[1]=o*g+s*y+l*C,a[2]=o*v+s*w+l*T,a[3]=c*m+u*S+f*b,a[4]=c*g+u*y+f*C,a[5]=c*v+u*w+f*T,a[6]=h*m+d*S+p*b,a[7]=h*g+d*y+p*C,a[8]=h*v+d*w+p*T},mat3x3_determinant:function(e){var t=e.data;return t[0]*t[4]*t[8]-t[0]*t[5]*t[7]-t[3]*t[1]*t[8]+t[3]*t[2]*t[7]+t[6]*t[1]*t[5]-t[6]*t[2]*t[4]},determinant_3x3:function(e,t,i,a,n,r,o,s,l){return e*n*l-e*r*s-a*t*l+a*i*s+o*t*r-o*i*n}}}();e.matmath=t}(jsfeat),function(e){var t=function(){var e=function(e,t,i,a){a=e[t],e[t]=e[i],e[i]=a},t=function(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?(t/=e,e*Math.sqrt(1+t*t)):t>0?(e/=t,t*Math.sqrt(1+e*e)):0},i=function(i,a,n,r,o,s){var l=jsfeat.EPSILON,c=0,u=0,f=0,h=0,d=0,p=0,m=0,g=0,v=0,S=s*s*30,y=0,w=0,b=0,C=0,T=0,A=0,P=0,E=0,I=0,_=jsfeat.cache.get_buffer(s<<2),x=jsfeat.cache.get_buffer(s<<2),D=_.i32,M=x.i32;if(r)for(;c<s;c++){for(f=c*o,u=0;u<s;u++)r[f+u]=0;r[f+c]=1}for(f=0;f<s;f++){if(n[f]=i[(a+1)*f],f<s-1){for(h=f+1,y=Math.abs(i[a*f+h]),c=f+2;c<s;c++)w=Math.abs(i[a*f+c]),y<w&&(y=w,h=c);D[f]=h}if(f>0){for(h=0,y=Math.abs(i[f]),c=1;c<f;c++)w=Math.abs(i[a*c+f]),y<w&&(y=w,h=c);M[f]=h}}if(s>1)for(;v<S;v++){for(f=0,y=Math.abs(i[D[0]]),c=1;c<s-1;c++)w=Math.abs(i[a*c+D[c]]),y<w&&(y=w,f=c);for(d=D[f],c=1;c<s;c++)w=Math.abs(i[a*M[c]+c]),y<w&&(y=w,f=M[c],d=c);if(b=i[a*f+d],Math.abs(b)<=l)break;for(C=.5*(n[d]-n[f]),T=Math.abs(C)+t(b,C),A=t(b,T),P=T/A,A=b/A,T=b/T*b,C<0&&(A=-A,T=-T),i[a*f+d]=0,n[f]-=T,n[d]+=T,c=0;c<f;c++)m=a*c+f,g=a*c+d,E=i[m],I=i[g],i[m]=E*P-I*A,i[g]=E*A+I*P;for(c=f+1;c<d;c++)m=a*f+c,g=a*c+d,E=i[m],I=i[g],i[m]=E*P-I*A,i[g]=E*A+I*P;for(c=d+1,m=a*f+c,g=a*d+c;c<s;c++,m++,g++)E=i[m],I=i[g],i[m]=E*P-I*A,i[g]=E*A+I*P;if(r)for(m=o*f,g=o*d,c=0;c<s;c++,m++,g++)E=r[m],I=r[g],r[m]=E*P-I*A,r[g]=E*A+I*P;for(u=0;u<2;u++){if(p=0==u?f:d,p<s-1){for(h=p+1,y=Math.abs(i[a*p+h]),c=p+2;c<s;c++)w=Math.abs(i[a*p+c]),y<w&&(y=w,h=c);D[p]=h}if(p>0){for(h=0,y=Math.abs(i[p]),c=1;c<p;c++)w=Math.abs(i[a*c+p]),y<w&&(y=w,h=c);M[p]=h}}}for(f=0;f<s-1;f++){for(h=f,c=f+1;c<s;c++)n[h]<n[c]&&(h=c);if(f!=h&&(e(n,h,f,y),r))for(c=0;c<s;c++)e(r,o*h+c,o*f+c,y)}jsfeat.cache.put_buffer(_),jsfeat.cache.put_buffer(x)},a=function(i,a,n,r,o,s,l,c){for(var u=2*jsfeat.EPSILON,f=jsfeat.FLT_MIN,h=0,d=0,p=0,m=0,g=Math.max(s,30),v=0,S=0,y=0,w=0,b=0,C=0,T=0,A=0,P=0,E=0,I=0,_=0,x=0,D=0,M=0,L=0,R=0,O=4660,k=0,G=0,F=0,U=jsfeat.cache.get_buffer(l<<3),j=U.f64;h<l;h++){for(p=0,I=0;p<s;p++)A=i[h*a+p],I+=A*A;if(j[h]=I,r){for(p=0;p<l;p++)r[h*o+p]=0;r[h*o+h]=1}}for(;m<g;m++){for(b=0,h=0;h<l-1;h++)for(d=h+1;d<l;d++){for(v=h*a|0,S=d*a|0,M=j[h],L=0,R=j[d],p=2,L+=i[v]*i[S],L+=i[v+1]*i[S+1];p<s;p++)L+=i[v+p]*i[S+p];if(!(Math.abs(L)<=u*Math.sqrt(M*R))){for(L*=2,_=M-R,x=t(L,_),_<0?(D=.5*(x-_),T=Math.sqrt(D/x),C=L/(x*T*2)):(C=Math.sqrt((x+_)/(2*x)),T=L/(x*C*2)),M=0,R=0,p=2,P=C*i[v]+T*i[S],E=-T*i[v]+C*i[S],i[v]=P,i[S]=E,M+=P*P,R+=E*E,P=C*i[v+1]+T*i[S+1],E=-T*i[v+1]+C*i[S+1],i[v+1]=P,i[S+1]=E,M+=P*P,R+=E*E;p<s;p++)P=C*i[v+p]+T*i[S+p],E=-T*i[v+p]+C*i[S+p],i[v+p]=P,i[S+p]=E,M+=P*P,R+=E*E;if(j[h]=M,j[d]=R,b=1,r)for(y=h*o|0,w=d*o|0,p=2,P=C*r[y]+T*r[w],E=-T*r[y]+C*r[w],r[y]=P,r[w]=E,P=C*r[y+1]+T*r[w+1],E=-T*r[y+1]+C*r[w+1],r[y+1]=P,r[w+1]=E;p<l;p++)P=C*r[y+p]+T*r[w+p],E=-T*r[y+p]+C*r[w+p],r[y+p]=P,r[w+p]=E}}if(0==b)break}for(h=0;h<l;h++){for(p=0,I=0;p<s;p++)A=i[h*a+p],I+=A*A;j[h]=Math.sqrt(I)}for(h=0;h<l-1;h++){for(d=h,p=h+1;p<l;p++)j[d]<j[p]&&(d=p);if(h!=d&&(e(j,h,d,I),r)){for(p=0;p<s;p++)e(i,h*a+p,d*a+p,A);for(p=0;p<l;p++)e(r,h*o+p,d*o+p,A)}}for(h=0;h<l;h++)n[h]=j[h];if(!r)return void jsfeat.cache.put_buffer(U);for(h=0;h<c;h++){for(I=h<l?j[h]:0;I<=f;){for(G=1/s,p=0;p<s;p++)O=214013*O+2531011,k=0!=(O>>16&32767&256)?G:-G,i[h*a+p]=k;for(m=0;m<2;m++)for(d=0;d<h;d++){for(I=0,p=0;p<s;p++)I+=i[h*a+p]*i[d*a+p];for(F=0,p=0;p<s;p++)A=i[h*a+p]-I*i[d*a+p],i[h*a+p]=A,F+=Math.abs(A);for(F=F?1/F:0,p=0;p<s;p++)i[h*a+p]*=F}for(I=0,p=0;p<s;p++)A=i[h*a+p],I+=A*A;I=Math.sqrt(I)}for(T=1/I,p=0;p<s;p++)i[h*a+p]*=T}jsfeat.cache.put_buffer(U)};return{lu_solve:function(t,i){var a,n,r,o,s=0,l=0,c=0,u=1,f=t.cols,h=t.data,d=i.data;for(s=0;s<f;s++){for(c=s,l=s+1;l<f;l++)Math.abs(h[l*f+s])>Math.abs(h[c*f+s])&&(c=l);if(Math.abs(h[c*f+s])<jsfeat.EPSILON)return 0;if(c!=s){for(l=s;l<f;l++)e(h,s*f+l,c*f+l,a);e(d,s,c,a),u=-u}for(r=-1/h[s*f+s],l=s+1;l<f;l++){for(n=h[l*f+s]*r,c=s+1;c<f;c++)h[l*f+c]+=n*h[s*f+c];d[l]+=n*d[s]}h[s*f+s]=-r}for(s=f-1;s>=0;s--){for(o=d[s],c=s+1;c<f;c++)o-=h[s*f+c]*d[c];d[s]=o*h[s*f+s]}return 1},cholesky_solve:function(e,t){var i,a,n=0,r=0,o=0,s=0,l=0,c=0,u=0,f=e.cols,h=e.data,d=t.data;for(n=0;n<f;n++)for(a=1,s=n*f,l=s,r=n;r<f;r++){for(i=h[l+n],o=0;o<n;o++)i-=h[o*f+n]*h[l+o];if(r==n){if(h[l+n]=i,0==i)return 0;a=1/i}else h[s+r]=i,h[l+n]=i*a;l+=f}for(s=0,c=0;c<f;c++){for(i=d[c],u=0;u<c;u++)i-=h[s+u]*d[u];d[c]=i,s+=f}for(s=0,c=0;c<f;c++)d[c]/=h[s+c],s+=f;for(c=f-1;c>=0;c--){for(i=d[c],u=c+1,s=u*f;u<f;u++)i-=h[s+c]*d[u],s+=f;d[c]=i}return 1},svd_decompose:function(e,t,i,n,r){"undefined"==typeof r&&(r=0);var o=0,s=0,l=e.rows,c=e.cols,u=l,f=c,h=e.type|jsfeat.C1_t;u<f&&(o=1,s=u,u=f,f=s);var d=jsfeat.cache.get_buffer(u*u<<3),p=jsfeat.cache.get_buffer(f<<3),m=jsfeat.cache.get_buffer(f*f<<3),g=new jsfeat.matrix_t(u,u,h,d.data),v=new jsfeat.matrix_t(1,f,h,p.data),S=new jsfeat.matrix_t(f,f,h,m.data);if(0==o)jsfeat.matmath.transpose(g,e);else{for(s=0;s<c*l;s++)g.data[s]=e.data[s];for(;s<f*u;s++)g.data[s]=0}if(a(g.data,u,v.data,S.data,f,u,f,u),t){for(s=0;s<f;s++)t.data[s]=v.data[s];for(;s<c;s++)t.data[s]=0}if(0==o){if(i&&r&jsfeat.SVD_U_T)for(s=u*u;--s>=0;)i.data[s]=g.data[s];else i&&jsfeat.matmath.transpose(i,g);if(n&&r&jsfeat.SVD_V_T)for(s=f*f;--s>=0;)n.data[s]=S.data[s];else n&&jsfeat.matmath.transpose(n,S)}else{if(i&&r&jsfeat.SVD_U_T)for(s=f*f;--s>=0;)i.data[s]=S.data[s];else i&&jsfeat.matmath.transpose(i,S);if(n&&r&jsfeat.SVD_V_T)for(s=u*u;--s>=0;)n.data[s]=g.data[s];else n&&jsfeat.matmath.transpose(n,g)}jsfeat.cache.put_buffer(d),jsfeat.cache.put_buffer(p),jsfeat.cache.put_buffer(m)},svd_solve:function(e,t,i){var a=0,n=0,r=0,o=0,s=0,l=e.rows,c=e.cols,u=0,f=0,h=0,d=e.type|jsfeat.C1_t,p=jsfeat.cache.get_buffer(l*l<<3),m=jsfeat.cache.get_buffer(c<<3),g=jsfeat.cache.get_buffer(c*c<<3),v=new jsfeat.matrix_t(l,l,d,p.data),S=new jsfeat.matrix_t(1,c,d,m.data),y=new jsfeat.matrix_t(c,c,d,g.data),w=i.data,b=v.data,C=S.data,T=y.data;for(this.svd_decompose(e,S,v,y,0),h=jsfeat.EPSILON*C[0]*c;a<c;a++,s+=c){for(f=0,n=0;n<c;n++)if(C[n]>h){for(r=0,u=0,o=0;r<l;r++,o+=c)u+=b[o+n]*w[r];f+=u*T[s+n]/C[n]}t.data[a]=f}jsfeat.cache.put_buffer(p),jsfeat.cache.put_buffer(m),jsfeat.cache.put_buffer(g)},svd_invert:function(e,t){var i=0,a=0,n=0,r=0,o=0,s=0,l=t.rows,c=t.cols,u=0,f=0,h=t.type|jsfeat.C1_t,d=jsfeat.cache.get_buffer(l*l<<3),p=jsfeat.cache.get_buffer(c<<3),m=jsfeat.cache.get_buffer(c*c<<3),g=new jsfeat.matrix_t(l,l,h,d.data),v=new jsfeat.matrix_t(1,c,h,p.data),S=new jsfeat.matrix_t(c,c,h,m.data),y=e.data,w=g.data,b=v.data,C=S.data;for(this.svd_decompose(t,v,g,S,0),f=jsfeat.EPSILON*b[0]*c;i<c;i++,o+=c)for(a=0,r=0;a<l;a++,s++){for(n=0,u=0;n<c;n++,r++)b[n]>f&&(u+=C[o+n]*w[r]/b[n]);y[s]=u}jsfeat.cache.put_buffer(d),jsfeat.cache.put_buffer(p),jsfeat.cache.put_buffer(m)},eigenVV:function(e,t,a){for(var n=e.cols,r=n*n,o=e.type|jsfeat.C1_t,s=jsfeat.cache.get_buffer(n*n<<3),l=jsfeat.cache.get_buffer(n<<3),c=new jsfeat.matrix_t(n,n,o,s.data),u=new jsfeat.matrix_t(1,n,o,l.data);--r>=0;)c.data[r]=e.data[r];if(i(c.data,n,u.data,t?t.data:null,n,n),a)for(;--n>=0;)a.data[n]=u.data[n];jsfeat.cache.put_buffer(s),jsfeat.cache.put_buffer(l)}}}();e.linalg=t}(jsfeat),function(e){var t=function(){var e=function(e){return e*e},t=function(e,t,i,a,n){for(var r=0,o=0,s=0,l=0,c=0,u=0,f=0,h=0,d=0,p=0,m=0;r<n;++r)o+=e[r].x,s+=e[r].y,u+=t[r].x,f+=t[r].y;for(o/=n,s/=n,u/=n,f/=n,r=0;r<n;++r)p=e[r].x-o,m=e[r].y-s,l+=Math.sqrt(p*p+m*m),p=t[r].x-u,m=t[r].y-f,h+=Math.sqrt(p*p+m*m);l/=n,h/=n,c=Math.SQRT2/l,d=Math.SQRT2/h,i[0]=i[4]=c,i[2]=-o*c,i[5]=-s*c,i[1]=i[3]=i[6]=i[7]=0,i[8]=1,a[0]=a[4]=d,a[2]=-u*d,a[5]=-f*d,a[1]=a[3]=a[6]=a[7]=0,a[8]=1},i=new jsfeat.matrix_t(3,3,jsfeat.F32_t|jsfeat.C1_t),a=new jsfeat.matrix_t(3,3,jsfeat.F32_t|jsfeat.C1_t),n=new jsfeat.matrix_t(6,6,jsfeat.F32_t|jsfeat.C1_t),r=new jsfeat.matrix_t(6,1,jsfeat.F32_t|jsfeat.C1_t),o=function(){function o(){}return o.prototype.run=function(e,o,s,l){var c,u,f=0,h=0,d=s.type|jsfeat.C1_t,p=s.data,m=i.data,g=a.data,v=0,S=0;t(e,o,m,g,l);for(var y=jsfeat.cache.get_buffer(2*l*6<<3),w=jsfeat.cache.get_buffer(2*l<<3),b=new jsfeat.matrix_t(6,2*l,d,y.data),C=new jsfeat.matrix_t(1,2*l,d,w.data),T=b.data,A=C.data;f<l;++f)c=e[f],u=o[f],v=m[0]*c.x+m[1]*c.y+m[2],S=m[3]*c.x+m[4]*c.y+m[5],h=2*f*6,T[h]=v,T[h+1]=S,T[h+2]=1,T[h+3]=0,T[h+4]=0,T[h+5]=0,h+=6,T[h]=0,T[h+1]=0,T[h+2]=0,T[h+3]=v,T[h+4]=S,T[h+5]=1,A[f<<1]=g[0]*u.x+g[1]*u.y+g[2],A[(f<<1)+1]=g[3]*u.x+g[4]*u.y+g[5];return jsfeat.matmath.multiply_AtA(n,b),jsfeat.matmath.multiply_AtB(r,b,C),jsfeat.linalg.lu_solve(n,r),p[0]=r.data[0],p[1]=r.data[1],p[2]=r.data[2],p[3]=r.data[3],p[4]=r.data[4],p[5]=r.data[5],p[6]=0,p[7]=0,p[8]=1,jsfeat.matmath.invert_3x3(a,a),jsfeat.matmath.multiply_3x3(s,a,s),jsfeat.matmath.multiply_3x3(s,s,i),jsfeat.cache.put_buffer(y),jsfeat.cache.put_buffer(w),1},o.prototype.error=function(t,i,a,n,r){for(var o,s,l=0,c=a.data;l<r;++l)o=t[l],s=i[l],n[l]=e(s.x-c[0]*o.x-c[1]*o.y-c[2])+e(s.y-c[3]*o.x-c[4]*o.y-c[5])},o.prototype.check_subset=function(e,t,i){return!0},o}(),s=new jsfeat.matrix_t(9,9,jsfeat.F32_t|jsfeat.C1_t),l=new jsfeat.matrix_t(9,9,jsfeat.F32_t|jsfeat.C1_t),c=function(){function e(){}return e.prototype.run=function(e,t,n,r){for(var o=0,c=0,u=n.data,f=i.data,h=a.data,d=s.data,p=l.data,m=0,g=0,v=0,S=0,y=0,w=0,b=0,C=0,T=0,A=0,P=0,E=0;o<r;++o)b+=t[o].x,C+=t[o].y,P+=e[o].x,E+=e[o].y;for(b/=r,C/=r,P/=r,E/=r,o=0;o<r;++o)y+=Math.abs(t[o].x-b),w+=Math.abs(t[o].y-C),T+=Math.abs(e[o].x-P),A+=Math.abs(e[o].y-E);if(Math.abs(y)<jsfeat.EPSILON||Math.abs(w)<jsfeat.EPSILON||Math.abs(T)<jsfeat.EPSILON||Math.abs(A)<jsfeat.EPSILON)return 0;for(y=r/y,w=r/w,T=r/T,A=r/A,f[0]=T,f[1]=0,f[2]=-P*T,f[3]=0,f[4]=A,f[5]=-E*A,f[6]=0,f[7]=0,f[8]=1,h[0]=1/y,h[1]=0,h[2]=b,h[3]=0,h[4]=1/w,h[5]=C,h[6]=0,h[7]=0,h[8]=1,o=81;--o>=0;)d[o]=0;for(o=0;o<r;++o)m=(t[o].x-b)*y,g=(t[o].y-C)*w,v=(e[o].x-P)*T,S=(e[o].y-E)*A,d[0]+=v*v,d[1]+=v*S,d[2]+=v,d[6]+=v*-m*v,d[7]+=v*-m*S,d[8]+=v*-m,d[10]+=S*S,d[11]+=S,d[15]+=S*-m*v,d[16]+=S*-m*S,d[17]+=S*-m,d[20]+=1,d[24]+=-m*v,d[25]+=-m*S,d[26]+=-m,d[30]+=v*v,d[31]+=v*S,d[32]+=v,d[33]+=v*-g*v,d[34]+=v*-g*S,d[35]+=v*-g,d[40]+=S*S,d[41]+=S,d[42]+=S*-g*v,d[43]+=S*-g*S,d[44]+=S*-g,d[50]+=1,d[51]+=-g*v,d[52]+=-g*S,d[53]+=-g,d[60]+=-m*v*-m*v+-g*v*-g*v,d[61]+=-m*v*-m*S+-g*v*-g*S,d[62]+=-m*v*-m+-g*v*-g,d[70]+=-m*S*-m*S+-g*S*-g*S,d[71]+=-m*S*-m+-g*S*-g,d[80]+=-m*-m+-g*-g;for(o=0;o<9;++o)for(c=0;c<o;++c)d[9*o+c]=d[9*c+o];return jsfeat.linalg.eigenVV(s,l),u[0]=p[72],u[1]=p[73],u[2]=p[74],u[3]=p[75],u[4]=p[76],u[5]=p[77],u[6]=p[78],u[7]=p[79],u[8]=p[80],jsfeat.matmath.multiply_3x3(n,a,n),jsfeat.matmath.multiply_3x3(n,n,i),m=1/u[8],u[0]*=m,u[1]*=m,u[2]*=m,u[3]*=m,u[4]*=m,u[5]*=m,u[6]*=m,u[7]*=m,u[8]=1,1},e.prototype.error=function(e,t,i,a,n){for(var r,o,s=0,l=0,c=0,u=0,f=i.data;s<n;++s)r=e[s],o=t[s],l=1/(f[6]*r.x+f[7]*r.y+1),c=(f[0]*r.x+f[1]*r.y+f[2])*l-o.x,u=(f[3]*r.x+f[4]*r.y+f[5])*l-o.y,a[s]=c*c+u*u},e.prototype.check_subset=function(e,t,i){if(4==i){var a=0,n=e[0],r=e[1],o=e[2],s=e[3],l=t[0],c=t[1],u=t[2],f=t[3],h=n.x,d=n.y,p=1,m=r.x,g=r.y,v=1,S=o.x,y=o.y,w=1,b=l.x,C=l.y,T=1,A=c.x,P=c.y,E=1,I=u.x,_=u.y,x=1,D=jsfeat.matmath.determinant_3x3(h,d,p,m,g,v,S,y,w),M=jsfeat.matmath.determinant_3x3(b,C,T,A,P,E,I,_,x);if(D*M<0&&a++,h=r.x,d=r.y,m=o.x,g=o.y,S=s.x,y=s.y,b=c.x,C=c.y,A=u.x,P=u.y,I=f.x,_=f.y,D=jsfeat.matmath.determinant_3x3(h,d,p,m,g,v,S,y,w),M=jsfeat.matmath.determinant_3x3(b,C,T,A,P,E,I,_,x),D*M<0&&a++,h=n.x,d=n.y,m=o.x,g=o.y,S=s.x,y=s.y,b=l.x,C=l.y,A=u.x,P=u.y,I=f.x,_=f.y,D=jsfeat.matmath.determinant_3x3(h,d,p,m,g,v,S,y,w),M=jsfeat.matmath.determinant_3x3(b,C,T,A,P,E,I,_,x),D*M<0&&a++,h=n.x,d=n.y,m=r.x,g=r.y,S=s.x,y=s.y,b=l.x,C=l.y,A=c.x,P=c.y,I=f.x,_=f.y,D=jsfeat.matmath.determinant_3x3(h,d,p,m,g,v,S,y,w),M=jsfeat.matmath.determinant_3x3(b,C,T,A,P,E,I,_,x),D*M<0&&a++,0!=a&&4!=a)return!1}return!0},e}();return{affine2d:o,homography2d:c}}(),i=function(){function e(e,t,i,a){"undefined"==typeof e&&(e=0),"undefined"==typeof t&&(t=.5),"undefined"==typeof i&&(i=.5),"undefined"==typeof a&&(a=.99),this.size=e,this.thresh=t,this.eps=i,this.prob=a}return e.prototype.update_iters=function(e,t){var i=Math.log(1-this.prob),a=Math.log(1-Math.pow(1-e,this.size));return 0|(a>=0||-i>=t*-a?t:Math.round(i/a))},e}(),a=function(){var e=function(e,t,i,a,n,r,o){for(var s=1e3,l=[],c=0,u=0,f=0,h=0,d=!1;f<s;++f){for(c=0;c<a&&f<s;){for(d=!1,h=0;!d;)for(d=!0,h=l[c]=0|Math.floor(Math.random()*n),u=0;u<c;++u)if(h==l[u]){d=!1;break}r[c]=t[h],o[c]=i[h],e.check_subset(r,o,c+1)?++c:f++}break}return c==a&&f<s},t=function(e,t,i,a,n,r,o,s){var l=0,c=0,u=0,f=r*r;for(e.error(i,a,t,o,n);c<n;++c)u=o[c]<=f,s[c]=u,l+=u;return l};return{ransac:function(i,a,n,r,o,s,l,c){if("undefined"==typeof c&&(c=1e3),o<i.size)return!1;var u=i.size,f=c,h=0,d=!1,p=[],m=[],g=!1,v=s.cols,S=s.rows,y=s.type|jsfeat.C1_t,w=jsfeat.cache.get_buffer(v*S<<3),b=jsfeat.cache.get_buffer(o),C=jsfeat.cache.get_buffer(o<<2),T=new jsfeat.matrix_t(v,S,y,w.data),A=new jsfeat.matrix_t(o,1,jsfeat.U8C1_t,b.data),P=-1,E=0,I=0,_=C.f32;if(o==u){if(a.run(n,r,T,o)<=0)return jsfeat.cache.put_buffer(w),jsfeat.cache.put_buffer(b),jsfeat.cache.put_buffer(C),!1;if(T.copy_to(s),l)for(;--o>=0;)l.data[o]=1;return jsfeat.cache.put_buffer(w),jsfeat.cache.put_buffer(b),jsfeat.cache.put_buffer(C),!0}for(;h<f;++h){if(g=e(a,n,r,u,o,p,m),!g){if(0==h)return jsfeat.cache.put_buffer(w),jsfeat.cache.put_buffer(b),jsfeat.cache.put_buffer(C),!1;break}I=a.run(p,m,T,u),I<=0||(E=t(a,T,n,r,o,i.thresh,_,A.data),E>Math.max(P,u-1)&&(T.copy_to(s),P=E,l&&A.copy_to(l),f=i.update_iters((o-E)/o,f),d=!0))}return jsfeat.cache.put_buffer(w),jsfeat.cache.put_buffer(b),jsfeat.cache.put_buffer(C),d},lmeds:function(i,a,n,r,o,s,l,c){if("undefined"==typeof c&&(c=1e3),o<i.size)return!1;var u=i.size,f=c,h=0,d=!1,p=[],m=[],g=!1,v=s.cols,S=s.rows,y=s.type|jsfeat.C1_t,w=jsfeat.cache.get_buffer(v*S<<3),b=jsfeat.cache.get_buffer(o),C=jsfeat.cache.get_buffer(o<<2),T=new jsfeat.matrix_t(v,S,y,w.data),A=new jsfeat.matrix_t(o,1,jsfeat.U8_t|jsfeat.C1_t,b.data),P=0,E=0,I=C.f32,_=1e9,x=0,D=0;if(i.eps=.45,f=i.update_iters(i.eps,f),o==u){if(a.run(n,r,T,o)<=0)return jsfeat.cache.put_buffer(w),jsfeat.cache.put_buffer(b),jsfeat.cache.put_buffer(C),!1;if(T.copy_to(s),l)for(;--o>=0;)l.data[o]=1;return jsfeat.cache.put_buffer(w),jsfeat.cache.put_buffer(b),jsfeat.cache.put_buffer(C),!0}for(;h<f;++h){if(g=e(a,n,r,u,o,p,m),!g){if(0==h)return jsfeat.cache.put_buffer(w),jsfeat.cache.put_buffer(b),jsfeat.cache.put_buffer(C),!1;break}E=a.run(p,m,T,u),E<=0||(a.error(n,r,T,I,o),D=jsfeat.math.median(I,0,o-1),D<_&&(_=D,T.copy_to(s),d=!0))}return d&&(x=2.5*1.4826*(1+5/(o-u))*Math.sqrt(_),x=Math.max(x,.001),P=t(a,s,n,r,o,x,I,A.data),l&&A.copy_to(l),d=P>=u),jsfeat.cache.put_buffer(w),jsfeat.cache.put_buffer(b),jsfeat.cache.put_buffer(C),d}}}();e.ransac_params_t=i,e.motion_model=t,e.motion_estimator=a}(jsfeat),function(e){var t=function(){var e=function(e,t,i,a){for(var n=0,r=e.channel,o=e.cols,s=e.rows,l=e.data,c=t.data,u=o/i,f=s/a,h=u*f*65536|0,d=0,p=0,m=0,g=0,v=0,S=0,y=0,w=0,b=0,C=0,T=0,A=0,P=0,E=0,I=0,_=0,x=jsfeat.cache.get_buffer(i*r<<2),D=jsfeat.cache.get_buffer(i*r<<2),M=jsfeat.cache.get_buffer(2*o*3<<2),L=x.i32,R=D.i32,O=M.i32;d<i;d++){for(b=d*u,C=b+u,v=b+1-1e-6|0,S=0|C,v=Math.min(v,o-1),S=Math.min(S,o-1),v>b&&(O[w++]=d*r|0,O[w++]=(v-1)*r|0,O[w++]=256*(v-b)|0,n++),m=v;m<S;m++)n++,O[w++]=d*r|0,O[w++]=m*r|0,O[w++]=256;C-S>.001&&(n++,O[w++]=d*r|0,O[w++]=S*r|0,O[w++]=256*(C-S)|0)}for(d=0;d<i*r;d++)L[d]=R[d]=0;for(p=0,g=0;g<s;g++){for(T=o*g,w=0;w<n;w++)for(P=O[3*w],v=O[3*w+1],E=O[3*w+2],y=0;y<r;y++)L[P+y]+=l[T+v+y]*E;if((p+1)*f<=g+1||g==s-1){if(I=256*Math.max(g+1-(p+1)*f,0)|0,_=256-I,A=i*p,I<=0)for(d=0;d<i*r;d++)c[A+d]=Math.min(Math.max((R[d]+256*L[d])/h,0),255),R[d]=L[d]=0;else for(d=0;d<i*r;d++)c[A+d]=Math.min(Math.max((R[d]+L[d]*_)/h,0),255),R[d]=L[d]*I,L[d]=0;p++}else for(d=0;d<i*r;d++)R[d]+=256*L[d],L[d]=0}jsfeat.cache.put_buffer(D),jsfeat.cache.put_buffer(x),jsfeat.cache.put_buffer(M)},t=function(e,t,i,a){for(var n=0,r=e.channel,o=e.cols,s=e.rows,l=e.data,c=t.data,u=o/i,f=s/a,h=1/(u*f),d=0,p=0,m=0,g=0,v=0,S=0,y=0,w=0,b=0,C=0,T=0,A=0,P=0,E=0,I=0,_=0,x=jsfeat.cache.get_buffer(i*r<<2),D=jsfeat.cache.get_buffer(i*r<<2),M=jsfeat.cache.get_buffer(2*o*3<<2),L=x.f32,R=D.f32,O=M.f32;d<i;d++){for(b=d*u,C=b+u,v=b+1-1e-6|0,S=0|C,v=Math.min(v,o-1),S=Math.min(S,o-1),v>b&&(n++,O[w++]=(v-1)*r|0,O[w++]=d*r|0,O[w++]=(v-b)*h),m=v;m<S;m++)n++,O[w++]=m*r|0,O[w++]=d*r|0,O[w++]=h;C-S>.001&&(n++,O[w++]=S*r|0,O[w++]=d*r|0,O[w++]=(C-S)*h)}for(d=0;d<i*r;d++)L[d]=R[d]=0;for(p=0,g=0;g<s;g++){for(T=o*g,w=0;w<n;w++)for(v=0|O[3*w],P=0|O[3*w+1],E=O[3*w+2],y=0;y<r;y++)L[P+y]+=l[T+v+y]*E;if((p+1)*f<=g+1||g==s-1){if(I=Math.max(g+1-(p+1)*f,0),_=1-I,A=i*p,Math.abs(I)<.001)for(d=0;d<i*r;d++)c[A+d]=R[d]+L[d],R[d]=L[d]=0;else for(d=0;d<i*r;d++)c[A+d]=R[d]+L[d]*_,R[d]=L[d]*I,L[d]=0;p++}else for(d=0;d<i*r;d++)R[d]+=L[d],L[d]=0}jsfeat.cache.put_buffer(D),jsfeat.cache.put_buffer(x),jsfeat.cache.put_buffer(M)},i=function(e,t,i,a,n,r,o,s){for(var l=0,c=0,u=0,f=0,h=0,d=0,p=0,m=0,g=0,v=r[0],S=0,y=a<<1,w=3*a,b=a<<2;l<n;++l){for(d=t[f],c=0;c<s;++c)e[c]=d;for(c=0;c<=a-2;c+=2)e[c+s]=t[f+c],e[c+s+1]=t[f+c+1];for(;c<a;++c)e[c+s]=t[f+c];for(d=t[f+a-1],c=a;c<s+a;++c)e[c+s]=d;for(c=0;c<=a-4;c+=4){for(d=e[c]*v,p=e[c+1]*v,m=e[c+2]*v,g=e[c+3]*v,u=1;u<o;++u)S=r[u],d+=e[u+c]*S,p+=e[u+c+1]*S,m+=e[u+c+2]*S,g+=e[u+c+3]*S;i[h+c]=Math.min(d>>8,255),i[h+c+1]=Math.min(p>>8,255),i[h+c+2]=Math.min(m>>8,255),i[h+c+3]=Math.min(g>>8,255)}for(;c<a;++c){for(d=e[c]*v,u=1;u<o;++u)d+=e[u+c]*r[u];i[h+c]=Math.min(d>>8,255)}f+=a,h+=a}for(l=0;l<a;++l){for(d=i[l],c=0;c<s;++c)e[c]=d;for(u=l,c=0;c<=n-2;c+=2,u+=y)e[c+s]=i[u],e[c+s+1]=i[u+a];for(;c<n;++c,u+=a)e[c+s]=i[u];for(d=i[(n-1)*a+l],c=n;c<s+n;++c)e[c+s]=d;for(h=l,c=0;c<=n-4;c+=4,h+=b){for(d=e[c]*v,p=e[c+1]*v,m=e[c+2]*v,g=e[c+3]*v,u=1;u<o;++u)S=r[u],d+=e[u+c]*S,p+=e[u+c+1]*S,m+=e[u+c+2]*S,g+=e[u+c+3]*S;i[h]=Math.min(d>>8,255),i[h+a]=Math.min(p>>8,255),i[h+y]=Math.min(m>>8,255),i[h+w]=Math.min(g>>8,255)}for(;c<n;++c,h+=a){for(d=e[c]*v,u=1;u<o;++u)d+=e[u+c]*r[u];i[h]=Math.min(d>>8,255)}}},a=function(e,t,i,a,n,r,o,s){for(var l=0,c=0,u=0,f=0,h=0,d=0,p=0,m=0,g=0,v=r[0],S=0,y=a<<1,w=3*a,b=a<<2;l<n;++l){for(d=t[f],c=0;c<s;++c)e[c]=d;for(c=0;c<=a-2;c+=2)e[c+s]=t[f+c],e[c+s+1]=t[f+c+1];for(;c<a;++c)e[c+s]=t[f+c];for(d=t[f+a-1],c=a;c<s+a;++c)e[c+s]=d;for(c=0;c<=a-4;c+=4){for(d=e[c]*v,p=e[c+1]*v,m=e[c+2]*v,g=e[c+3]*v,u=1;u<o;++u)S=r[u],d+=e[u+c]*S,p+=e[u+c+1]*S,m+=e[u+c+2]*S,g+=e[u+c+3]*S;i[h+c]=d,i[h+c+1]=p,i[h+c+2]=m,i[h+c+3]=g}for(;c<a;++c){for(d=e[c]*v,u=1;u<o;++u)d+=e[u+c]*r[u];i[h+c]=d}f+=a,h+=a}for(l=0;l<a;++l){for(d=i[l],c=0;c<s;++c)e[c]=d;for(u=l,c=0;c<=n-2;c+=2,u+=y)e[c+s]=i[u],e[c+s+1]=i[u+a];for(;c<n;++c,u+=a)e[c+s]=i[u];for(d=i[(n-1)*a+l],c=n;c<s+n;++c)e[c+s]=d;for(h=l,c=0;c<=n-4;c+=4,h+=b){for(d=e[c]*v,p=e[c+1]*v,m=e[c+2]*v,g=e[c+3]*v,u=1;u<o;++u)S=r[u],d+=e[u+c]*S,p+=e[u+c+1]*S,m+=e[u+c+2]*S,g+=e[u+c+3]*S;i[h]=d,i[h+a]=p,i[h+y]=m,i[h+w]=g}for(;c<n;++c,h+=a){for(d=e[c]*v,u=1;u<o;++u)d+=e[u+c]*r[u];i[h]=d}}};return{grayscale:function(e,t,i,a,n){"undefined"==typeof n&&(n=jsfeat.COLOR_RGBA2GRAY);var r=0,o=0,s=0,l=0,c=0,u=0,f=4899,h=9617,d=1868,p=4;n!=jsfeat.COLOR_BGRA2GRAY&&n!=jsfeat.COLOR_BGR2GRAY||(f=1868,d=4899),n!=jsfeat.COLOR_RGB2GRAY&&n!=jsfeat.COLOR_BGR2GRAY||(p=3);var m=p<<1,g=3*p|0;a.resize(t,i,1);var v=a.data;for(o=0;o<i;++o,l+=t,s+=t*p){for(r=0,c=s,u=l;r<=t-4;r+=4,c+=p<<2,u+=4)v[u]=e[c]*f+e[c+1]*h+e[c+2]*d+8192>>14,v[u+1]=e[c+p]*f+e[c+p+1]*h+e[c+p+2]*d+8192>>14,v[u+2]=e[c+m]*f+e[c+m+1]*h+e[c+m+2]*d+8192>>14,v[u+3]=e[c+g]*f+e[c+g+1]*h+e[c+g+2]*d+8192>>14;for(;r<t;++r,++u,c+=p)v[u]=e[c]*f+e[c+1]*h+e[c+2]*d+8192>>14}},resample:function(i,a,n,r){var o=i.rows,s=i.cols;o>r&&s>n&&(a.resize(n,r,i.channel),i.type&jsfeat.U8_t&&a.type&jsfeat.U8_t&&o*s/(r*n)<256?e(i,a,n,r):t(i,a,n,r))},box_blur_gray:function(e,t,i,a){"undefined"==typeof a&&(a=0);var n=e.cols,r=e.rows,o=r<<1,s=n<<1,l=0,c=0,u=0,f=0,h=(i<<1)+1|0,d=i+1|0,p=d+1|0,m=a&jsfeat.BOX_BLUR_NOSCALE?1:1/(h*h),g=jsfeat.cache.get_buffer(n*r<<2),v=0,S=0,y=0,w=0,b=0,C=g.i32,T=e.data,A=0;for(t.resize(n,r,e.channel),u=0;u<r;++u){for(S=u,v=d*T[y],l=y+1|0,f=y+i|0;l<=f;++l)v+=T[l];for(w=y+d|0,b=y,A=T[b],c=0;c<i;++c,S+=r)C[S]=v,v+=T[w]-A,w++;for(;c<n-p;c+=2,S+=o)C[S]=v,v+=T[w]-T[b],C[S+r]=v,v+=T[w+1]-T[b+1],w+=2,b+=2;for(;c<n-d;++c,S+=r)C[S]=v,v+=T[w]-T[b],w++,b++;for(A=T[w-1];c<n;++c,S+=r)C[S]=v,v+=A-T[b],b++;y+=n}if(y=0,T=t.data,1==m)for(u=0;u<n;++u){for(S=u,v=d*C[y],l=y+1|0,f=y+i|0;l<=f;++l)v+=C[l];for(w=y+d,b=y,A=C[b],c=0;c<i;++c,S+=n)T[S]=v,v+=C[w]-A,w++;for(;c<r-p;c+=2,S+=s)T[S]=v,v+=C[w]-C[b],T[S+n]=v,v+=C[w+1]-C[b+1],w+=2,b+=2;for(;c<r-d;++c,S+=n)T[S]=v,v+=C[w]-C[b],w++,b++;for(A=C[w-1];c<r;++c,S+=n)T[S]=v,v+=A-C[b],b++;y+=r}else for(u=0;u<n;++u){for(S=u,v=d*C[y],l=y+1|0,f=y+i|0;l<=f;++l)v+=C[l];for(w=y+d,b=y,A=C[b],c=0;c<i;++c,S+=n)T[S]=v*m,v+=C[w]-A,w++;for(;c<r-p;c+=2,S+=s)T[S]=v*m,v+=C[w]-C[b],T[S+n]=v*m,v+=C[w+1]-C[b+1],w+=2,b+=2;for(;c<r-d;++c,S+=n)T[S]=v*m,v+=C[w]-C[b],w++,b++;for(A=C[w-1];c<r;++c,S+=n)T[S]=v*m,v+=A-C[b],b++;y+=r}jsfeat.cache.put_buffer(g)},gaussian_blur:function(e,t,n,r){"undefined"==typeof r&&(r=0),"undefined"==typeof n&&(n=0),n=0==n?2*Math.max(1,4*r+1-1e-8)+1|0:n;var o=n>>1,s=e.cols,l=e.rows,c=e.type,u=c&jsfeat.U8_t;t.resize(s,l,e.channel);var f,h,d=e.data,p=t.data,m=n+Math.max(l,s)|0,g=jsfeat.cache.get_buffer(m<<2),v=jsfeat.cache.get_buffer(n<<2);u?(f=g.i32,h=v.i32):c&jsfeat.S32_t?(f=g.i32,h=v.f32):(f=g.f32,h=v.f32),jsfeat.math.get_gaussian_kernel(n,r,h,c),u?i(f,d,p,s,l,h,n,o):a(f,d,p,s,l,h,n,o),jsfeat.cache.put_buffer(g),jsfeat.cache.put_buffer(v)},pyrdown:function(e,t,i,a){"undefined"==typeof i&&(i=0),"undefined"==typeof a&&(a=0);var n=e.cols,r=e.rows,o=n>>1,s=r>>1,l=o-(i<<1),c=s-(a<<1),u=0,f=0,h=i+a*n,d=0,p=0,m=0;t.resize(o,s,e.channel);var g=e.data,v=t.data;for(f=0;f<c;++f){for(d=h,m=p,u=0;u<=l-2;u+=2,m+=2,d+=4)v[m]=g[d]+g[d+1]+g[d+n]+g[d+n+1]+2>>2,v[m+1]=g[d+2]+g[d+3]+g[d+n+2]+g[d+n+3]+2>>2;for(;u<l;++u,++m,d+=2)v[m]=g[d]+g[d+1]+g[d+n]+g[d+n+1]+2>>2;h+=n<<1,p+=o}},scharr_derivatives:function(e,t){var i,a,n,r,o,s,l,c,u=e.cols,f=e.rows,h=u<<1,d=0,p=0,m=0,g=0,v=0,S=0,y=0;t.resize(u,f,2);var w=e.data,b=t.data,C=jsfeat.cache.get_buffer(u+2<<2),T=jsfeat.cache.get_buffer(u+2<<2);for(e.type&jsfeat.U8_t||e.type&jsfeat.S32_t?(l=C.i32,c=T.i32):(l=C.f32,c=T.f32);p<f;++p,v+=u){for(g=(p>0?p-1:1)*u|0,S=(p<f-1?p+1:f-2)*u|0,y=p*h|0,d=0,m=1;d<=u-2;d+=2,
m+=2)i=w[g+d],a=w[S+d],l[m]=3*(i+a)+10*w[v+d],c[m]=a-i,i=w[g+d+1],a=w[S+d+1],l[m+1]=3*(i+a)+10*w[v+d+1],c[m+1]=a-i;for(;d<u;++d,++m)i=w[g+d],a=w[S+d],l[m]=3*(i+a)+10*w[v+d],c[m]=a-i;for(d=u+1|0,l[0]=l[1],l[d]=l[u],c[0]=c[1],c[d]=c[u],d=0;d<=u-4;d+=4)i=c[d+2],a=c[d+1],n=c[d+3],r=c[d+4],o=l[d+2],s=l[d+3],b[y++]=o-l[d],b[y++]=3*(i+c[d])+10*a,b[y++]=s-l[d+1],b[y++]=3*(n+a)+10*i,b[y++]=l[d+4]-o,b[y++]=3*(r+i)+10*n,b[y++]=l[d+5]-s,b[y++]=3*(c[d+5]+n)+10*r;for(;d<u;++d)b[y++]=l[d+2]-l[d],b[y++]=3*(c[d+2]+c[d])+10*c[d+1]}jsfeat.cache.put_buffer(C),jsfeat.cache.put_buffer(T)},sobel_derivatives:function(e,t){var i,a,n,r,o,s,l,c,u=e.cols,f=e.rows,h=u<<1,d=0,p=0,m=0,g=0,v=0,S=0,y=0;t.resize(u,f,2);var w=e.data,b=t.data,C=jsfeat.cache.get_buffer(u+2<<2),T=jsfeat.cache.get_buffer(u+2<<2);for(e.type&jsfeat.U8_t||e.type&jsfeat.S32_t?(l=C.i32,c=T.i32):(l=C.f32,c=T.f32);p<f;++p,v+=u){for(g=(p>0?p-1:1)*u|0,S=(p<f-1?p+1:f-2)*u|0,y=p*h|0,d=0,m=1;d<=u-2;d+=2,m+=2)i=w[g+d],a=w[S+d],l[m]=i+a+2*w[v+d],c[m]=a-i,i=w[g+d+1],a=w[S+d+1],l[m+1]=i+a+2*w[v+d+1],c[m+1]=a-i;for(;d<u;++d,++m)i=w[g+d],a=w[S+d],l[m]=i+a+2*w[v+d],c[m]=a-i;for(d=u+1|0,l[0]=l[1],l[d]=l[u],c[0]=c[1],c[d]=c[u],d=0;d<=u-4;d+=4)i=c[d+2],a=c[d+1],n=c[d+3],r=c[d+4],o=l[d+2],s=l[d+3],b[y++]=o-l[d],b[y++]=i+c[d]+2*a,b[y++]=s-l[d+1],b[y++]=n+a+2*i,b[y++]=l[d+4]-o,b[y++]=r+i+2*n,b[y++]=l[d+5]-s,b[y++]=c[d+5]+n+2*r;for(;d<u;++d)b[y++]=l[d+2]-l[d],b[y++]=c[d+2]+c[d]+2*c[d+1]}jsfeat.cache.put_buffer(C),jsfeat.cache.put_buffer(T)},compute_integral_image:function(e,t,i,a){var n=0|e.cols,r=0|e.rows,o=e.data,s=n+1|0,l=0,c=0,u=0,f=0,h=0,d=0,p=0,m=0;if(t&&i){for(;h<s;++h)t[h]=0,i[h]=0;for(u=s+1|0,f=1,h=0,m=0;h<r;++h,++u,++f){for(l=c=0,d=0;d<=n-2;d+=2,m+=2,u+=2,f+=2)p=o[m],l+=p,c+=p*p,t[u]=t[f]+l,i[u]=i[f]+c,p=o[m+1],l+=p,c+=p*p,t[u+1]=t[f+1]+l,i[u+1]=i[f+1]+c;for(;d<n;++d,++m,++u,++f)p=o[m],l+=p,c+=p*p,t[u]=t[f]+l,i[u]=i[f]+c}}else if(t){for(;h<s;++h)t[h]=0;for(u=s+1|0,f=1,h=0,m=0;h<r;++h,++u,++f){for(l=0,d=0;d<=n-2;d+=2,m+=2,u+=2,f+=2)l+=o[m],t[u]=t[f]+l,l+=o[m+1],t[u+1]=t[f+1]+l;for(;d<n;++d,++m,++u,++f)l+=o[m],t[u]=t[f]+l}}else if(i){for(;h<s;++h)i[h]=0;for(u=s+1|0,f=1,h=0,m=0;h<r;++h,++u,++f){for(c=0,d=0;d<=n-2;d+=2,m+=2,u+=2,f+=2)p=o[m],c+=p*p,i[u]=i[f]+c,p=o[m+1],c+=p*p,i[u+1]=i[f+1]+c;for(;d<n;++d,++m,++u,++f)p=o[m],c+=p*p,i[u]=i[f]+c}}if(a){for(h=0;h<s;++h)a[h]=0;for(u=s+1|0,f=0,h=0,m=0;h<r;++h,++u,++f){for(d=0;d<=n-2;d+=2,m+=2,u+=2,f+=2)a[u]=o[m]+a[f],a[u+1]=o[m+1]+a[f+1];for(;d<n;++d,++m,++u,++f)a[u]=o[m]+a[f]}for(u=s+n|0,f=n,h=0;h<r;++h,u+=s,f+=s)a[u]+=a[f];for(d=n-1;d>0;--d)for(u=d+r*s,f=u-s,h=r;h>0;--h,u-=s,f-=s)a[u]+=a[f]+a[f+1]}},equalize_histogram:function(e,t){var i=e.cols,a=e.rows,n=e.data;t.resize(i,a,e.channel);var r,o,s=t.data,l=i*a,c=0,u=0,f=jsfeat.cache.get_buffer(1024);for(r=f.i32;c<256;++c)r[c]=0;for(c=0;c<l;++c)++r[n[c]];for(u=r[0],c=1;c<256;++c)u=r[c]+=u;for(o=255/l,c=0;c<l;++c)s[c]=r[n[c]]*o+.5|0;jsfeat.cache.put_buffer(f)},canny:function(e,t,i,a){var n=e.cols,r=e.rows;e.data;t.resize(n,r,e.channel);var o=t.data,s=0,l=0,c=0,u=n<<1,f=0,h=0,d=0,p=0,m=0,g=0,v=0,S=0,y=jsfeat.cache.get_buffer(r*u<<2),w=jsfeat.cache.get_buffer(3*(n+2)<<2),b=jsfeat.cache.get_buffer((r+2)*(n+2)<<2),C=jsfeat.cache.get_buffer(r*n<<2),T=w.i32,A=b.i32,P=C.i32,E=y.i32,I=new jsfeat.matrix_t(n,r,jsfeat.S32C2_t,y.data),_=1,x=n+2+1|0,D=2*(n+2)+1|0,M=n+2|0,L=M+1|0,R=0;for(this.sobel_derivatives(e,I),i>a&&(s=i,i=a,a=s),s=3*(n+2)|0;--s>=0;)T[s]=0;for(s=(r+2)*(n+2)|0;--s>=0;)A[s]=0;for(;l<n;++l,c+=2)p=E[c],m=E[c+1],T[x+l]=(p^p>>31)-(p>>31)+((m^m>>31)-(m>>31));for(s=1;s<=r;++s,c+=u){if(s==r)for(l=D+n;--l>=D;)T[l]=0;else for(l=0;l<n;l++)p=E[c+(l<<1)],m=E[c+(l<<1)+1],T[D+l]=(p^p>>31)-(p>>31)+((m^m>>31)-(m>>31));for(f=c-u|0,A[L-1]=0,h=0,l=0;l<n;++l,f+=2){if(d=T[x+l],d>i)if(p=E[f],m=E[f+1],g=p^m,p=(p^p>>31)-(p>>31)|0,m=(m^m>>31)-(m>>31)|0,v=13573*p,S=v+(p+p<<15),m<<=15,m<v){if(d>T[x+l-1]&&d>=T[x+l+1]){d>a&&!h&&2!=A[L+l-M]?(A[L+l]=2,h=1,P[R++]=L+l):A[L+l]=1;continue}}else if(m>S){if(d>T[_+l]&&d>=T[D+l]){d>a&&!h&&2!=A[L+l-M]?(A[L+l]=2,h=1,P[R++]=L+l):A[L+l]=1;continue}}else if(g=g<0?-1:1,d>T[_+l-g]&&d>T[D+l+g]){d>a&&!h&&2!=A[L+l-M]?(A[L+l]=2,h=1,P[R++]=L+l):A[L+l]=1;continue}A[L+l]=0,h=0}A[L+n]=0,L+=M,l=_,_=x,x=D,D=l}for(l=L-M-1,s=0;s<M;++s,++l)A[l]=0;for(;R>0;)L=P[--R],L-=M+1,1==A[L]&&(A[L]=2,P[R++]=L),L+=1,1==A[L]&&(A[L]=2,P[R++]=L),L+=1,1==A[L]&&(A[L]=2,P[R++]=L),L+=M,1==A[L]&&(A[L]=2,P[R++]=L),L-=2,1==A[L]&&(A[L]=2,P[R++]=L),L+=M,1==A[L]&&(A[L]=2,P[R++]=L),L+=1,1==A[L]&&(A[L]=2,P[R++]=L),L+=1,1==A[L]&&(A[L]=2,P[R++]=L);for(L=M+1,_=0,s=0;s<r;++s,L+=M)for(l=0;l<n;++l)o[_++]=255*(2==A[L+l]);jsfeat.cache.put_buffer(y),jsfeat.cache.put_buffer(w),jsfeat.cache.put_buffer(b),jsfeat.cache.put_buffer(C)},warp_perspective:function(e,t,i,a){"undefined"==typeof a&&(a=0);for(var n=0|e.cols,r=0|e.rows,o=0|t.cols,s=0|t.rows,l=e.data,c=t.data,u=0,f=0,h=0,d=0,p=0,m=0,g=0,v=0,S=0,y=0,w=0,b=0,C=0,T=0,A=0,P=i.data,E=P[0],I=P[1],_=P[2],x=P[3],D=P[4],M=P[5],L=P[6],R=P[7],O=P[8],k=0;f<s;++f)for(v=I*f+_,S=D*f+M,y=R*f+O,u=0;u<o;++u,++k,v+=E,S+=x,y+=L)w=1/y,m=v*w,g=S*w,d=0|m,p=0|g,m>0&&g>0&&d<n-1&&p<r-1?(b=Math.max(m-d,0),C=Math.max(g-p,0),h=n*p+d|0,T=l[h]+b*(l[h+1]-l[h]),A=l[h+n]+b*(l[h+n+1]-l[h+n]),c[k]=T+C*(A-T)):c[k]=a},warp_affine:function(e,t,i,a){"undefined"==typeof a&&(a=0);for(var n=e.cols,r=e.rows,o=t.cols,s=t.rows,l=e.data,c=t.data,u=0,f=0,h=0,d=0,p=0,m=0,g=0,v=0,S=0,y=0,w=0,b=i.data,C=b[0],T=b[1],A=b[2],P=b[3],E=b[4],I=b[5],_=0;f<s;++f)for(m=T*f+A,g=E*f+I,u=0;u<o;++u,++_,m+=C,g+=P)d=0|m,p=0|g,d>=0&&p>=0&&d<n-1&&p<r-1?(v=m-d,S=g-p,h=n*p+d,y=l[h]+v*(l[h+1]-l[h]),w=l[h+n]+v*(l[h+n+1]-l[h+n]),c[_]=y+S*(w-y)):c[_]=a},skindetector:function(e,t){for(var i,a,n,r,o=e.width*e.height;o--;)r=4*o,i=e.data[r],a=e.data[r+1],n=e.data[r+2],i>95&&a>40&&n>20&&i>a&&i>n&&i-Math.min(a,n)>15&&Math.abs(i-a)>15?t[o]=255:t[o]=0}}}();e.imgproc=t}(jsfeat),function(e){var t=function(){var e=new Int32Array([0,3,1,3,2,2,3,1,3,0,3,-1,2,-2,1,-3,0,-3,-1,-3,-2,-2,-3,-1,-3,0,-3,1,-2,2,-1,3]),t=new Uint8Array(512),i=new Int32Array(25),a=new Int32Array(25),n=function(t,i,a){for(var n=0,r=e;n<a;++n)t[n]=r[n<<1]+r[(n<<1)+1]*i;for(;n<25;++n)t[n]=t[n-a]},r=function(e,t,i,a,n){for(var r=25,o=0,s=e[t],l=n,c=0,u=0,f=0;o<r;++o)a[o]=s-e[t+i[o]];for(o=0;o<16;o+=2)c=Math.min(a[o+1],a[o+2]),c=Math.min(c,a[o+3]),c<=l||(c=Math.min(c,a[o+4]),c=Math.min(c,a[o+5]),c=Math.min(c,a[o+6]),c=Math.min(c,a[o+7]),c=Math.min(c,a[o+8]),l=Math.max(l,Math.min(c,a[o])),l=Math.max(l,Math.min(c,a[o+9])));for(u=-l,o=0;o<16;o+=2)f=Math.max(a[o+1],a[o+2]),f=Math.max(f,a[o+3]),f=Math.max(f,a[o+4]),f=Math.max(f,a[o+5]),f>=u||(f=Math.max(f,a[o+6]),f=Math.max(f,a[o+7]),f=Math.max(f,a[o+8]),u=Math.min(u,Math.max(f,a[o])),u=Math.min(u,Math.max(f,a[o+9])));return-u-1},o=20;return{set_threshold:function(e){o=Math.min(Math.max(e,0),255);for(var i=-255;i<=255;++i)t[i+255]=i<-o?1:i>o?2:0;return o},detect:function(e,s,l){"undefined"==typeof l&&(l=3);var c,u=8,f=25,h=e.data,d=e.cols,p=e.rows,m=0,g=0,v=0,S=0,y=0,w=0,b=jsfeat.cache.get_buffer(3*d),C=jsfeat.cache.get_buffer(3*(d+1)<<2),T=b.u8,A=C.i32,P=i,E=a,I=Math.max(3,l),_=Math.min(p-2,p-l),x=Math.max(3,l),D=Math.min(d-3,d-l),M=0,L=0,R=r,O=t,k=o,G=0,F=0,U=0,j=0,N=0,B=0,H=0,V=0,W=0,z=0,K=0,X=0;n(P,d,16);var q=P[0],Y=P[1],Z=P[2],J=P[3],Q=P[4],$=P[5],ee=P[6],te=P[7],ie=P[8],ae=P[9],ne=P[10],re=P[11],oe=P[12],se=P[13],le=P[14],ce=P[15];for(m=0;m<3*d;++m)T[m]=0;for(m=I;m<_;++m){for(H=m*d+x|0,w=(m-3)%3,B=w*d|0,N=w*(d+1)|0,g=0;g<d;++g)T[B+g]=0;if(j=0,m<_-1)for(g=x;g<D;++g,++H)if(G=h[H],F=-G+255,U=O[F+h[H+q]]|O[F+h[H+ie]],0!=U&&(U&=O[F+h[H+Z]]|O[F+h[H+ne]],U&=O[F+h[H+Q]]|O[F+h[H+oe]],U&=O[F+h[H+ee]]|O[F+h[H+le]],0!=U)){if(U&=O[F+h[H+Y]]|O[F+h[H+ae]],U&=O[F+h[H+J]]|O[F+h[H+re]],U&=O[F+h[H+$]]|O[F+h[H+se]],U&=O[F+h[H+te]]|O[F+h[H+ce]],1&U)for(S=G-k,M=0,v=0;v<f;++v)if(y=h[H+P[v]],y<S){if(++M,M>u){++j,A[N+j]=g,T[B+g]=R(h,H,P,E,k);break}}else M=0;if(2&U)for(S=G+k,M=0,v=0;v<f;++v)if(y=h[H+P[v]],y>S){if(++M,M>u){++j,A[N+j]=g,T[B+g]=R(h,H,P,E,k);break}}else M=0}if(A[N+d]=j,m!=I)for(w=(m-4+3)%3,V=w*d|0,N=w*(d+1)|0,w=(m-5+3)%3,W=w*d|0,j=A[N+d],v=0;v<j;++v)g=A[N+v],z=g+1|0,K=g-1|0,X=T[V+g],X>T[V+z]&&X>T[V+K]&&X>T[W+K]&&X>T[W+g]&&X>T[W+z]&&X>T[B+K]&&X>T[B+g]&&X>T[B+z]&&(c=s[L],c.x=g,c.y=m-1,c.score=X,L++)}return jsfeat.cache.put_buffer(b),jsfeat.cache.put_buffer(C),L}}}();e.fast_corners=t,t.set_threshold(20)}(jsfeat),function(e){var t=function(){var e=function(e,t,i,a,n,r,o,s,l,c){var u=0,f=0,h=s*i+o|0,d=h;for(u=s;u<c;++u,h+=i,d=h)for(f=o;f<l;++f,++d)t[d]=-4*e[d]+e[d+n]+e[d-n]+e[d+r]+e[d-r]},t=function(e,t,i,a,n,r,o){var s=-2*e[t]+e[t+a]+e[t-a],l=-2*e[t]+e[t+n]+e[t-n],c=e[t+r]+e[t-r]-e[t+o]-e[t-o],u=0|Math.sqrt((s-l)*(s-l)+4*c*c);return Math.min(Math.abs(i-u),Math.abs(-(i+u)))};return{laplacian_threshold:30,min_eigen_value_threshold:25,detect:function(i,a,n){"undefined"==typeof n&&(n=5);var r,o=0,s=0,l=i.cols,c=i.rows,u=i.data,f=5,h=5*l|0,d=3+3*l|0,p=3-3*l|0,m=jsfeat.cache.get_buffer(l*c<<2),g=m.i32,v=0,S=0,y=0,w=0,b=0,C=this.laplacian_threshold,T=this.min_eigen_value_threshold,A=0|Math.max(5,n),P=0|Math.max(3,n),E=0|Math.min(l-5,l-n),I=0|Math.min(c-3,c-n);for(o=l*c;--o>=0;)g[o]=0;for(e(u,g,l,c,f,h,A,P,E,I),S=P*l+A|0,s=P;s<I;++s,S+=l)for(o=A,y=S;o<E;++o,++y)v=g[y],(v<-C&&v<g[y-1]&&v<g[y+1]&&v<g[y-l]&&v<g[y+l]&&v<g[y-l-1]&&v<g[y+l-1]&&v<g[y-l+1]&&v<g[y+l+1]||v>C&&v>g[y-1]&&v>g[y+1]&&v>g[y-l]&&v>g[y+l]&&v>g[y-l-1]&&v>g[y+l-1]&&v>g[y-l+1]&&v>g[y+l+1])&&(w=t(u,y,v,f,h,d,p),w>T&&(r=a[b],r.x=o,r.y=s,r.score=w,++b,++o,++y));return jsfeat.cache.put_buffer(m),b}}}();e.yape06=t}(jsfeat),function(e){var t=function(){var e=function(e,t,i){var a,n,r=0;for(a=i,n=0;n<a;n++,r++)a=Math.sqrt(i*i-n*n)+.5|0,t[r]=a+e*n;for(a--;a<n&&a>=0;a--,r++)n=Math.sqrt(i*i-a*a)+.5|0,t[r]=a+e*n;for(;-a<n;a--,r++)n=Math.sqrt(i*i-a*a)+.5|0,t[r]=a+e*n;for(n--;n>=0;n--,r++)a=-Math.sqrt(i*i-n*n)-.5|0,t[r]=a+e*n;for(;n>a;n--,r++)a=-Math.sqrt(i*i-n*n)-.5|0,t[r]=a+e*n;for(a++;a<=0;a++,r++)n=-Math.sqrt(i*i-a*a)-.5|0,t[r]=a+e*n;for(;a<-n;a++,r++)n=-Math.sqrt(i*i-a*a)-.5|0,t[r]=a+e*n;for(n++;n<0;n++,r++)a=Math.sqrt(i*i-n*n)+.5|0,t[r]=a+e*n;return t[r]=t[0],t[r+1]=t[1],r},t=function(e,t,i){var a=0;return 0!=e[t+1]&&a++,0!=e[t-1]&&a++,0!=e[t+i]&&a++,0!=e[t+i+1]&&a++,0!=e[t+i-1]&&a++,0!=e[t-i]&&a++,0!=e[t-i+1]&&a++,0!=e[t-i-1]&&a++,a},i=function(e,t,i,a,n){var r,o;if(i>0)for(t-=a*n,o=-n;o<=n;++o){for(r=-n;r<=n;++r)if(e[t+r]>i)return!1;t+=a}else for(t-=a*n,o=-n;o<=n;++o){for(r=-n;r<=n;++r)if(e[t+r]<i)return!1;t+=a}return!0},a=function(e,t,i,a,n,r,o,s){var l=0,c=0,u=o-1|0,f=0,h=0,d=0,p=0,m=0;if(f=e[t+r[c]],f<=n)if(f>=a)if(h=e[t+r[u]],h<=n){if(h>=a)return void(i[t]=0);if(u++,d=e[t+r[u]],d>n)if(u++,p=e[t+r[u]],p>n)m=3;else{if(!(p<a))return void(i[t]=0);m=6}else if(u++,p=e[t+r[u]],p>n)m=7;else{if(!(p<a))return void(i[t]=0);m=2}}else if(u++,d=e[t+r[u]],d>n)if(u++,p=e[t+r[u]],p>n)m=3;else{if(!(p<a))return void(i[t]=0);m=6}else{if(!(d<a))return void(i[t]=0);if(u++,p=e[t+r[u]],p>n)m=7;else{if(!(p<a))return void(i[t]=0);m=2}}else{if(h=e[t+r[u]],h>n)return void(i[t]=0);if(u++,d=e[t+r[u]],d>n)return void(i[t]=0);if(u++,p=e[t+r[u]],p>n)return void(i[t]=0);m=1}else{if(h=e[t+r[u]],h<a)return void(i[t]=0);if(u++,d=e[t+r[u]],d<a)return void(i[t]=0);if(u++,p=e[t+r[u]],p<a)return void(i[t]=0);m=0}for(c=1;c<=o;c++)switch(f=e[t+r[c]],m){case 0:if(f>n){if(d=p,u++,p=e[t+r[u]],p<a)return void(i[t]=0);l-=f+d,m=0;break}if(f<a){if(d>n)return void(i[t]=0);if(p>n)return void(i[t]=0);if(d=p,u++,p=e[t+r[u]],p>n)return void(i[t]=0);l-=f+d,m=8;break}if(d<=n)return void(i[t]=0);if(p<=n)return void(i[t]=0);if(d=p,u++,p=e[t+r[u]],p>n){l-=f+d,m=3;break}if(p<a){l-=f+d,m=6;break}return void(i[t]=0);case 1:if(f<a){if(d=p,u++,p=e[t+r[u]],p>n)return void(i[t]=0);l-=f+d,m=1;break}if(f>n){if(d<a)return void(i[t]=0);if(p<a)return void(i[t]=0);if(d=p,u++,p=e[t+r[u]],p<a)return void(i[t]=0);l-=f+d,m=9;break}if(d>=a)return void(i[t]=0);if(p>=a)return void(i[t]=0);if(d=p,u++,p=e[t+r[u]],p<a){l-=f+d,m=2;break}if(p>n){l-=f+d,m=7;break}return void(i[t]=0);case 2:if(f>n)return void(i[t]=0);if(d=p,u++,p=e[t+r[u]],f<a){if(p>n)return void(i[t]=0);l-=f+d,m=4;break}if(p>n){l-=f+d,m=7;break}if(p<a){l-=f+d,m=2;break}return void(i[t]=0);case 3:if(f<a)return void(i[t]=0);if(d=p,u++,p=e[t+r[u]],f>n){if(p<a)return void(i[t]=0);l-=f+d,m=5;break}if(p>n){l-=f+d,m=3;break}if(p<a){l-=f+d,m=6;break}return void(i[t]=0);case 4:if(f>n)return void(i[t]=0);if(f<a){if(d=p,u++,p=e[t+r[u]],p>n)return void(i[t]=0);l-=f+d,m=1;break}if(p>=a)return void(i[t]=0);if(d=p,u++,p=e[t+r[u]],p<a){l-=f+d,m=2;break}if(p>n){l-=f+d,m=7;break}return void(i[t]=0);case 5:if(f<a)return void(i[t]=0);if(f>n){if(d=p,u++,p=e[t+r[u]],p<a)return void(i[t]=0);l-=f+d,m=0;break}if(p<=n)return void(i[t]=0);if(d=p,u++,p=e[t+r[u]],p>n){l-=f+d,m=3;break}if(p<a){l-=f+d,m=6;break}return void(i[t]=0);case 7:if(f>n)return void(i[t]=0);if(f<a)return void(i[t]=0);if(d=p,u++,p=e[t+r[u]],p>n){l-=f+d,m=3;break}if(p<a){l-=f+d,m=6;break}return void(i[t]=0);case 6:if(f>n)return void(i[t]=0);if(f<a)return void(i[t]=0);if(d=p,u++,p=e[t+r[u]],p<a){l-=f+d,m=2;break}if(p>n){l-=f+d,m=7;break}return void(i[t]=0);case 8:if(f>n){if(p<a)return void(i[t]=0);if(d=p,u++,p=e[t+r[u]],p<a)return void(i[t]=0);l-=f+d,m=9;break}if(f<a){if(d=p,u++,p=e[t+r[u]],p>n)return void(i[t]=0);l-=f+d,m=1;break}return void(i[t]=0);case 9:if(f<a){if(p>n)return void(i[t]=0);if(d=p,u++,p=e[t+r[u]],p>n)return void(i[t]=0);l-=f+d,m=8;break}if(f>n){if(d=p,u++,p=e[t+r[u]],p<a)return void(i[t]=0);l-=f+d,m=0;break}return void(i[t]=0)}i[t]=l+s*e[t]},n=function(){function t(t,i,a){this.dirs=new Int32Array(1024),this.dirs_count=0|e(t,this.dirs,a),this.scores=new Int32Array(t*i),this.radius=0|a}return t}();return{level_tables:[],tau:7,init:function(e,t,i,a){"undefined"==typeof a&&(a=1);var r;for(i=Math.min(i,7),i=Math.max(i,3),r=0;r<a;++r)this.level_tables[r]=new n(e>>r,t>>r,i)},detect:function(e,n,r){"undefined"==typeof r&&(r=4);var o,s=this.level_tables[0],l=0|s.radius,c=l-1|0,u=s.dirs,f=0|s.dirs_count,h=f>>1,d=e.data,p=0|e.cols,m=0|e.rows,g=p>>1,v=s.scores,S=0,y=0,w=0,b=0,C=0,T=0,A=0,P=0,E=0|this.tau,I=0,_=0|Math.max(l+1,r),x=0|Math.max(l+1,r),D=0|Math.min(p-l-2,p-r),M=0|Math.min(m-l-2,m-r);for(w=x*p+_|0,y=x;y<M;++y,w+=p)for(S=_,b=w;S<D;++S,++b)C=d[b]+E,T=d[b]-E,T<d[b+l]&&d[b+l]<C&&T<d[b-l]&&d[b-l]<C?v[b]=0:a(d,b,v,T,C,u,h,f);for(w=x*p+_|0,y=x;y<M;++y,w+=p)for(S=_,b=w;S<D;++S,++b)P=v[b],A=Math.abs(P),A<5?(++S,++b):t(v,b,p)>=3&&i(v,b,P,g,l)&&(o=n[I],o.x=S,o.y=y,o.score=A,++I,S+=c,b+=c);return I}}}();e.yape=t}(jsfeat),function(e){var t=function(){var e=new Int32Array([8,-3,9,5,4,2,7,-12,-11,9,-8,2,7,-12,12,-13,2,-13,2,12,1,-7,1,6,-2,-10,-2,-4,-13,-13,-11,-8,-13,-3,-12,-9,10,4,11,9,-13,-8,-8,-9,-11,7,-9,12,7,7,12,6,-4,-5,-3,0,-13,2,-12,-3,-9,0,-7,5,12,-6,12,-1,-3,6,-2,12,-6,-13,-4,-8,11,-13,12,-8,4,7,5,1,5,-3,10,-3,3,-7,6,12,-8,-7,-6,-2,-2,11,-1,-10,-13,12,-8,10,-7,3,-5,-3,-4,2,-3,7,-10,-12,-6,11,5,-12,6,-7,5,-6,7,-1,1,0,4,-5,9,11,11,-13,4,7,4,12,2,-1,4,4,-4,-12,-2,7,-8,-5,-7,-10,4,11,9,12,0,-8,1,-13,-13,-2,-8,2,-3,-2,-2,3,-6,9,-4,-9,8,12,10,7,0,9,1,3,7,-5,11,-10,-13,-6,-11,0,10,7,12,1,-6,-3,-6,12,10,-9,12,-4,-13,8,-8,-12,-13,0,-8,-4,3,3,7,8,5,7,10,-7,-1,7,1,-12,3,-10,5,6,2,-4,3,-10,-13,0,-13,5,-13,-7,-12,12,-13,3,-11,8,-7,12,-4,7,6,-10,12,8,-9,-1,-7,-6,-2,-5,0,12,-12,5,-7,5,3,-10,8,-13,-7,-7,-4,5,-3,-2,-1,-7,2,9,5,-11,-11,-13,-5,-13,-1,6,0,-1,5,-3,5,2,-4,-13,-4,12,-9,-6,-9,6,-12,-10,-8,-4,10,2,12,-3,7,12,12,12,-7,-13,-6,5,-4,9,-3,4,7,-1,12,2,-7,6,-5,1,-13,11,-12,5,-3,7,-2,-6,7,-8,12,-7,-13,-7,-11,-12,1,-3,12,12,2,-6,3,0,-4,3,-2,-13,-1,-13,1,9,7,1,8,-6,1,-1,3,12,9,1,12,6,-1,-9,-1,3,-13,-13,-10,5,7,7,10,12,12,-5,12,9,6,3,7,11,5,-13,6,10,2,-12,2,3,3,8,4,-6,2,6,12,-13,9,-12,10,3,-8,4,-7,9,-11,12,-4,-6,1,12,2,-8,6,-9,7,-4,2,3,3,-2,6,3,11,0,3,-3,8,-8,7,8,9,3,-11,-5,-6,-4,-10,11,-5,10,-5,-8,-3,12,-10,5,-9,0,8,-1,12,-6,4,-6,6,-11,-10,12,-8,7,4,-2,6,7,-2,0,-2,12,-5,-8,-5,2,7,-6,10,12,-9,-13,-8,-8,-5,-13,-5,-2,8,-8,9,-13,-9,-11,-9,0,1,-8,1,-2,7,-4,9,1,-2,1,-1,-4,11,-6,12,-11,-12,-9,-6,4,3,7,7,12,5,5,10,8,0,-4,2,8,-9,12,-5,-13,0,7,2,12,-1,2,1,7,5,11,7,-9,3,5,6,-8,-13,-4,-8,9,-5,9,-3,-3,-4,-7,-3,-12,6,5,8,0,-7,6,-6,12,-13,6,-5,-2,1,-10,3,10,4,1,8,-4,-2,-2,2,-13,2,-12,12,12,-2,-13,0,-6,4,1,9,3,-6,-10,-3,-5,-3,-13,-1,1,7,5,12,-11,4,-2,5,-7,-13,9,-9,-5,7,1,8,6,7,-8,7,6,-7,-4,-7,1,-8,11,-7,-8,-13,6,-12,-8,2,4,3,9,10,-5,12,3,-6,-5,-6,7,8,-3,9,-8,2,-12,2,8,-11,-2,-10,3,-12,-13,-7,-9,-11,0,-10,-5,5,-3,11,8,-2,-13,-1,12,-1,-8,0,9,-13,-11,-12,-5,-10,-2,-10,11,-3,9,-2,-13,2,-3,3,2,-9,-13,-4,0,-4,6,-3,-10,-4,12,-2,-7,-6,-11,-4,9,6,-3,6,11,-13,11,-5,5,11,11,12,6,7,-5,12,-2,-1,12,0,7,-4,-8,-3,-2,-7,1,-6,7,-13,-12,-8,-13,-7,-2,-6,-8,-8,5,-6,-9,-5,-1,-4,5,-13,7,-8,10,1,5,5,-13,1,0,10,-13,9,12,10,-1,5,-8,10,-9,-1,11,1,-13,-9,-3,-6,2,-1,-10,1,12,-13,1,-8,-10,8,-11,10,-6,2,-13,3,-6,7,-13,12,-9,-10,-10,-5,-7,-10,-8,-8,-13,4,-6,8,5,3,12,8,-13,-4,2,-3,-3,5,-13,10,-12,4,-13,5,-1,-9,9,-4,3,0,3,3,-9,-12,1,-6,1,3,2,4,-8,-10,-10,-10,9,8,-13,12,12,-8,-12,-6,-5,2,2,3,7,10,6,11,-8,6,8,8,-12,-7,10,-6,5,-3,-9,-3,9,-1,-13,-1,5,-3,-7,-3,4,-8,-2,-8,3,4,2,12,12,2,-5,3,11,6,-9,11,-13,3,-1,7,12,11,-1,12,4,-3,0,-3,6,4,-11,4,12,2,-4,2,1,-10,-6,-8,1,-13,7,-11,1,-13,12,-11,-13,6,0,11,-13,0,-1,1,4,-13,3,-9,-2,-9,8,-6,-3,-13,-6,-8,-2,5,-9,8,10,2,7,3,-9,-1,-6,-1,-1,9,5,11,-2,11,-3,12,-8,3,0,3,5,-1,4,0,10,3,-6,4,5,-13,0,-10,5,5,8,12,11,8,9,9,-6,7,-4,8,-12,-10,4,-10,9,7,3,12,4,9,-7,10,-2,7,0,12,-2,-1,-6,0,-11]),t=new jsfeat.matrix_t(3,3,jsfeat.F32_t|jsfeat.C1_t),i=new jsfeat.matrix_t(32,32,jsfeat.U8_t|jsfeat.C1_t),a=function(e,i,a,n,r,o){var s=Math.cos(a),l=Math.sin(a);t.data[0]=s,t.data[1]=-l,t.data[2]=(-s+l)*o*.5+n,t.data[3]=l,t.data[4]=s,t.data[5]=(-l-s)*o*.5+r,jsfeat.imgproc.warp_affine(e,i,t,128)};return{describe:function(t,n,r,o){var s=32,l=0,c=0,u=0,f=0,h=0,d=0,p=0,m=0,g=(t.data,t.cols,t.rows,i.data),v=528,S=0;o.type&jsfeat.U8_t?o.resize(s,r,1):(o.type=jsfeat.U8_t,o.cols=s,o.rows=r,o.channel=1,o.allocate());var y=o.data,w=0;for(l=0;l<r;++l){for(u=n[l].x,f=n[l].y,h=n[l].angle,a(t,i,h,u,f,32),S=0,c=0;c<s;++c)d=g[v+32*e[S+1]+e[S]],S+=2,p=g[v+32*e[S+1]+e[S]],S+=2,m=d<p|0,d=g[v+32*e[S+1]+e[S]],S+=2,p=g[v+32*e[S+1]+e[S]],S+=2,m|=(d<p)<<1,d=g[v+32*e[S+1]+e[S]],S+=2,p=g[v+32*e[S+1]+e[S]],S+=2,m|=(d<p)<<2,d=g[v+32*e[S+1]+e[S]],S+=2,p=g[v+32*e[S+1]+e[S]],S+=2,m|=(d<p)<<3,d=g[v+32*e[S+1]+e[S]],S+=2,p=g[v+32*e[S+1]+e[S]],S+=2,m|=(d<p)<<4,d=g[v+32*e[S+1]+e[S]],S+=2,p=g[v+32*e[S+1]+e[S]],S+=2,m|=(d<p)<<5,d=g[v+32*e[S+1]+e[S]],S+=2,p=g[v+32*e[S+1]+e[S]],S+=2,m|=(d<p)<<6,d=g[v+32*e[S+1]+e[S]],S+=2,p=g[v+32*e[S+1]+e[S]],S+=2,m|=(d<p)<<7,y[w+c]=m;w+=s}}}}();e.orb=t}(jsfeat),function(e){var t=function(){var e=jsfeat.imgproc.scharr_derivatives;return{track:function(t,i,a,n,r,o,s,l,c,u){"undefined"==typeof s&&(s=30),"undefined"==typeof l&&(l=new Uint8Array(r)),"undefined"==typeof c&&(c=.01),"undefined"==typeof u&&(u=1e-4);var f=.5*(o-1),h=o*o|0,d=h<<1,p=t.data,m=i.data,g=p[0].data,v=m[0].data,S=p[0].cols,y=p[0].rows,w=0,b=0,C=jsfeat.cache.get_buffer(h<<2),T=jsfeat.cache.get_buffer(d<<2),A=jsfeat.cache.get_buffer(y*(S<<1)<<2),P=new jsfeat.matrix_t(S,y,jsfeat.S32C2_t,A.data),E=C.i32,I=T.i32,_=A.i32,x=0,D=0,M=0,L=0,R=0,O=0,k=0,G=0,F=0,U=0,j=0,N=0,B=0,H=0,V=0,W=0,z=0,K=0,X=0,q=0,Y=0,Z=0,J=0,Q=0,$=0,ee=0,te=0,ie=0,ae=0,ne=0,re=0,oe=0,se=0,le=14,ce=14,ue=ce-5,fe=1<<ue-1,he=1<<le,de=1<<ce-1,pe=1/(1<<20),me=0,ge=0,ve=0,Se=0,ye=0,we=0,be=0,Ce=0,Te=0,Ae=0,Pe=0,Ee=0,Ie=1.1920929e-7;for(c*=c;q<r;++q)l[q]=1;var _e=t.levels-1|0;for(Q=_e;Q>=0;--Q)for(k=1/(1<<Q),w=S>>Q,b=y>>Q,x=w<<1,g=p[Q].data,v=m[Q].data,ie=w-o|0,ae=b-o|0,e(p[Q],P),$=0;$<r;++$)if(q=$<<1,Y=q+1,G=a[q]*k,F=a[Y]*k,Q==_e?(U=G,j=F):(U=2*n[q],j=2*n[Y]),n[q]=U,n[Y]=j,G-=f,F-=f,W=0|G,z=0|F,Z=W<=te|W>=ie|z<=te|z>=ae,0==Z){for(ne=G-W,re=F-z,me=(1-ne)*(1-re)*he+.5|0,ge=ne*(1-re)*he+.5|0,ve=(1-ne)*re*he+.5|0,Se=he-me-ge-ve,Ce=0,Te=0,Ae=0,J=0;J<o;++J)for(D=(J+z)*w+W|0,M=D<<1,L=J*o|0,R=L<<1,Z=0;Z<o;++Z,++D,++L,M+=2)ye=g[D]*me+g[D+1]*ge+g[D+w]*ve+g[D+w+1]*Se,ye=ye+fe>>ue,we=_[M]*me+_[M+2]*ge+_[M+x]*ve+_[M+x+2]*Se,we=we+de>>ce,be=_[M+1]*me+_[M+3]*ge+_[M+x+1]*ve+_[M+x+3]*Se,be=be+de>>ce,E[L]=ye,I[R++]=we,I[R++]=be,Ce+=we*we,Te+=we*be,Ae+=be*be;if(Ce*=pe,Te*=pe,Ae*=pe,Pe=Ce*Ae-Te*Te,Ee=(Ae+Ce-Math.sqrt((Ce-Ae)*(Ce-Ae)+4*Te*Te))/d,Ee<u||Pe<Ie)0==Q&&(l[$]=0);else for(Pe=1/Pe,U-=f,j-=f,N=0,B=0,ee=0;ee<s;++ee){if(K=0|U,X=0|j,Z=K<=te|K>=ie|X<=te|X>=ae,0!=Z){0==Q&&(l[$]=0);break}for(ne=U-K,re=j-X,me=(1-ne)*(1-re)*he+.5|0,ge=ne*(1-re)*he+.5|0,ve=(1-ne)*re*he+.5|0,Se=he-me-ge-ve,oe=0,se=0,J=0;J<o;++J)for(O=(J+X)*w+K|0,L=J*o|0,R=L<<1,Z=0;Z<o;++Z,++O,++L)ye=v[O]*me+v[O+1]*ge+v[O+w]*ve+v[O+w+1]*Se,ye=ye+fe>>ue,ye-=E[L],oe+=ye*I[R++],se+=ye*I[R++];if(oe*=pe,se*=pe,H=(Te*se-Ae*oe)*Pe,V=(Te*oe-Ce*se)*Pe,U+=H,j+=V,n[q]=U+f,n[Y]=j+f,H*H+V*V<=c)break;if(ee>0&&Math.abs(H+N)<.01&&Math.abs(V+B)<.01){n[q]-=.5*H,n[Y]-=.5*V;break}N=H,B=V}}else 0==Q&&(l[$]=0);jsfeat.cache.put_buffer(C),jsfeat.cache.put_buffer(T),jsfeat.cache.put_buffer(A)}}}();e.optical_flow_lk=t}(jsfeat),function(e){var t=function(){var e=function(e,t){var i=.25*e.width+.5|0;return t.x<=e.x+i&&t.x>=e.x-i&&t.y<=e.y+i&&t.y>=e.y-i&&t.width<=1.5*e.width+.5|0&&1.5*t.width+.5|0>=e.width};return{edges_density:.07,detect_single_scale:function(e,t,i,a,n,r,o,s){var l,c,u,f,h,d,p,m,g,v,S,y,w,b,C,T,A,P,E,I,_,x,D,M,L,R,O=s.size[0]*o|0,k=s.size[1]*o|0,G=.5*o+1.5|0,F=G,U=n-O|0,j=r-k|0,N=n+1|0,B=1/(O*k),H=!0,V=0,W=O,z=k*N,K=z+O,X=O*k*255*this.edges_density|0,q=[];for(h=0;h<j;h+=F)for(V=h*N,f=0;f<U;f+=G,V+=G)if(p=e[V]-e[V+W]-e[V+z]+e[V+K],a&&(d=a[V]-a[V+W]-a[V+z]+a[V+K],d<X||p<20))f+=G,V+=G;else{for(p*=B,m=(t[V]-t[V+W]-t[V+z]+t[V+K])*B-p*p,g=m>0?Math.sqrt(m):1,v=s.complexClassifiers,b=v.length,H=!0,l=0;l<b;++l){for(S=v[l],A=S.threshold,y=S.simpleClassifiers,C=y.length,P=0,c=0;c<C;++c){if(w=y[c],E=0,_=w.features,T=_.length,1===w.tilted)for(u=0;u<T;++u)I=_[u],x=~~(f+I[0]*o)+~~(h+I[1]*o)*N,L=~~(I[2]*o),R=~~(I[3]*o),D=L*N,M=R*N,E+=(i[x]-i[x+L+D]-i[x-R+M]+i[x+L-R+D+M])*I[4];else for(u=0;u<T;++u)I=_[u],x=~~(f+I[0]*o)+~~(h+I[1]*o)*N,L=~~(I[2]*o),R=~~(I[3]*o),M=R*N,E+=(e[x]-e[x+L]-e[x+M]+e[x+M+L])*I[4];P+=E*B<w.threshold*g?w.left_val:w.right_val}if(P<A){H=!1;break}}H&&(q.push({x:f,y:h,width:O,height:k,neighbor:1,confidence:P}),f+=G,V+=G)}return q},detect_multi_scale:function(e,t,i,a,n,r,o,s,l){"undefined"==typeof s&&(s=1.2),"undefined"==typeof l&&(l=1);for(var c=o.size[0],u=o.size[1],f=[];l*c<n&&l*u<r;)f=f.concat(this.detect_single_scale(e,t,i,a,n,r,l,o)),l*=s;return f},group_rectangles:function(t,i){"undefined"==typeof i&&(i=1);var a,n,r=t.length,o=[];for(a=0;a<r;++a)o[a]={parent:-1,element:t[a],rank:0};for(a=0;a<r;++a)if(o[a].element){for(var s=a;o[s].parent!=-1;)s=o[s].parent;for(n=0;n<r;++n)if(a!=n&&o[n].element&&e(o[a].element,o[n].element)){for(var l=n;o[l].parent!=-1;)l=o[l].parent;if(l!=s){o[s].rank>o[l].rank?o[l].parent=s:(o[s].parent=l,o[s].rank==o[l].rank&&o[l].rank++,s=l);for(var c,u=n;o[u].parent!=-1;)c=u,u=o[u].parent,o[c].parent=s;for(u=a;o[u].parent!=-1;)c=u,u=o[u].parent,o[c].parent=s}}}var f=[],h=0;for(a=0;a<r;a++){n=-1;var d=a;if(o[d].element){for(;o[d].parent!=-1;)d=o[d].parent;o[d].rank>=0&&(o[d].rank=~h++),n=~o[d].rank}f[a]=n}var p=[];for(a=0;a<h+1;++a)p[a]={neighbors:0,x:0,y:0,width:0,height:0,confidence:0};for(a=0;a<r;++a){var m=t[a],g=f[a];0==p[g].neighbors&&(p[g].confidence=m.confidence),++p[g].neighbors,p[g].x+=m.x,p[g].y+=m.y,p[g].width+=m.width,p[g].height+=m.height,p[g].confidence=Math.max(p[g].confidence,m.confidence)}var v=[];for(a=0;a<h;++a)r=p[a].neighbors,r>=i&&v.push({x:(2*p[a].x+r)/(2*r),y:(2*p[a].y+r)/(2*r),width:(2*p[a].width+r)/(2*r),height:(2*p[a].height+r)/(2*r),neighbors:p[a].neighbors,confidence:p[a].confidence});var S=[];for(r=v.length,a=0;a<r;++a){var m=v[a],y=!0;for(n=0;n<r;++n){var w=v[n],b=.25*w.width+.5|0;if(a!=n&&m.x>=w.x-b&&m.y>=w.y-b&&m.x+m.width<=w.x+w.width+b&&m.y+m.height<=w.y+w.height+b&&(w.neighbors>Math.max(3,m.neighbors)||m.neighbors<3)){y=!1;break}}y&&S.push(m)}return S}}}();e.haar=t}(jsfeat),function(e){var t=function(){var e=function(e,t){var i=.25*e.width+.5|0;return t.x<=e.x+i&&t.x>=e.x-i&&t.y<=e.y+i&&t.y>=e.y-i&&t.width<=1.5*e.width+.5|0&&1.5*t.width+.5|0>=e.width},t=new jsfeat.pyramid_t(1);return{interval:4,scale:1.1486,next:5,scale_to:1,prepare_cascade:function(e){for(var t=e.stage_classifier.length,i=0;i<t;i++)for(var a=e.stage_classifier[i].feature,n=e.stage_classifier[i].count,r=e.stage_classifier[i]._feature=new Array(n),o=0;o<n;o++)r[o]={size:a[o].size,px:new Array(a[o].size),pz:new Array(a[o].size),nx:new Array(a[o].size),nz:new Array(a[o].size)}},build_pyramid:function(e,i,a,n){"undefined"==typeof n&&(n=4);var r=e.cols,o=e.rows,s=0,l=0,c=0,u=!1,f=e,h=e,d=jsfeat.U8_t|jsfeat.C1_t;this.interval=n,this.scale=Math.pow(2,1/(this.interval+1)),this.next=this.interval+1|0,this.scale_to=Math.log(Math.min(r/i,o/a))/Math.log(this.scale)|0;var p=4*(this.scale_to+2*this.next)|0;for(t.levels!=p&&(t.levels=p,t.data=new Array(p),u=!0,t.data[0]=e),s=1;s<=this.interval;++s)l=r/Math.pow(this.scale,s)|0,c=o/Math.pow(this.scale,s)|0,f=t.data[s<<2],(u||l!=f.cols||c!=f.rows)&&(t.data[s<<2]=new jsfeat.matrix_t(l,c,d),f=t.data[s<<2]),jsfeat.imgproc.resample(e,f,l,c);for(s=this.next;s<this.scale_to+2*this.next;++s)h=t.data[(s<<2)-(this.next<<2)],f=t.data[s<<2],l=h.cols>>1,c=h.rows>>1,(u||l!=f.cols||c!=f.rows)&&(t.data[s<<2]=new jsfeat.matrix_t(l,c,d),f=t.data[s<<2]),jsfeat.imgproc.pyrdown(h,f);for(s=2*this.next;s<this.scale_to+2*this.next;++s)h=t.data[(s<<2)-(this.next<<2)],l=h.cols>>1,c=h.rows>>1,f=t.data[(s<<2)+1],(u||l!=f.cols||c!=f.rows)&&(t.data[(s<<2)+1]=new jsfeat.matrix_t(l,c,d),f=t.data[(s<<2)+1]),jsfeat.imgproc.pyrdown(h,f,1,0),f=t.data[(s<<2)+2],(u||l!=f.cols||c!=f.rows)&&(t.data[(s<<2)+2]=new jsfeat.matrix_t(l,c,d),f=t.data[(s<<2)+2]),jsfeat.imgproc.pyrdown(h,f,0,1),f=t.data[(s<<2)+3],(u||l!=f.cols||c!=f.rows)&&(t.data[(s<<2)+3]=new jsfeat.matrix_t(l,c,d),f=t.data[(s<<2)+3]),jsfeat.imgproc.pyrdown(h,f,1,1);return t},detect:function(e,t){var i,a,n,r,o,s=(this.interval,this.scale),l=this.next,c=this.scale_to,u=0,f=0,h=0,d=0,p=0,m=0,g=0,v=0,S=0,y=0,w=0,b=0,C=0,T=0,A=0,P=0,E=0,I=0,_=!0,x=!0,D=1,M=1,L=[0,1,0,1],R=[0,0,1,1],O=[],k=e.data,G=1,F=2,U=4,j=[],N=[0,0,0],B=[0,0,0],H=[0,0,0];for(u=0;u<c;u++){for(A=u<<2,P=k[A+(l<<3)].cols-(t.width>>2),E=k[A+(l<<3)].rows-(t.height>>2),B[0]=k[A].cols*G,B[1]=k[A+(l<<2)].cols*G,B[2]=k[A+(l<<3)].cols*G,H[0]=k[A].cols*U-P*U,H[1]=k[A+(l<<2)].cols*F-P*F,H[2]=k[A+(l<<3)].cols*G-P*G,v=t.stage_classifier.length,f=0;f<v;f++)for(n=t.stage_classifier[f].feature,a=t.stage_classifier[f]._feature,S=t.stage_classifier[f].count,h=0;h<S;h++)for(r=a[h],o=n[h],y=0|o.size,g=0;g<y;g++)r.px[g]=o.px[g]*G+o.py[g]*B[o.pz[g]],r.pz[g]=o.pz[g],r.nx[g]=o.nx[g]*G+o.ny[g]*B[o.nz[g]],r.nz[g]=o.nz[g];for(j[0]=k[A].data,j[1]=k[A+(l<<2)].data,g=0;g<4;g++)for(j[2]=k[A+(l<<3)+g].data,N[0]=L[g]*F+R[g]*(k[A].cols*F),N[1]=L[g]*G+R[g]*(k[A+(l<<2)].cols*G),N[2]=0,m=0;m<E;m++){for(p=0;p<P;p++){for(I=0,_=!0,v=t.stage_classifier.length,f=0;f<v;f++){for(I=0,i=t.stage_classifier[f].alpha,a=t.stage_classifier[f]._feature,S=t.stage_classifier[f].count,h=0;h<S;h++)if(r=a[h],b=j[r.pz[0]][N[r.pz[0]]+r.px[0]],C=j[r.nz[0]][N[r.nz[0]]+r.nx[0]],b<=C)I+=i[h<<1];else{for(x=!0,y=r.size,T=1;T<y;T++){if(r.pz[T]>=0&&(w=j[r.pz[T]][N[r.pz[T]]+r.px[T]],w<b)){if(w<=C){x=!1;break}b=w}if(r.nz[T]>=0&&(d=j[r.nz[T]][N[r.nz[T]]+r.nx[T]],d>C)){if(b<=d){x=!1;break}C=d}}I+=x?i[(h<<1)+1]:i[h<<1]}if(I<t.stage_classifier[f].threshold){_=!1;break}}_&&(O.push({x:(4*p+2*L[g])*D,y:(4*m+2*R[g])*M,width:t.width*D,height:t.height*M,neighbor:1,confidence:I}),++p,N[0]+=U,N[1]+=F,N[2]+=G),N[0]+=U,N[1]+=F,N[2]+=G}N[0]+=H[0],N[1]+=H[1],N[2]+=H[2]}D*=s,M*=s}return O},group_rectangles:function(t,i){"undefined"==typeof i&&(i=1);var a,n,r=t.length,o=[];for(a=0;a<r;++a)o[a]={parent:-1,element:t[a],rank:0};for(a=0;a<r;++a)if(o[a].element){for(var s=a;o[s].parent!=-1;)s=o[s].parent;for(n=0;n<r;++n)if(a!=n&&o[n].element&&e(o[a].element,o[n].element)){for(var l=n;o[l].parent!=-1;)l=o[l].parent;if(l!=s){o[s].rank>o[l].rank?o[l].parent=s:(o[s].parent=l,o[s].rank==o[l].rank&&o[l].rank++,s=l);for(var c,u=n;o[u].parent!=-1;)c=u,u=o[u].parent,o[c].parent=s;for(u=a;o[u].parent!=-1;)c=u,u=o[u].parent,o[c].parent=s}}}var f=[],h=0;for(a=0;a<r;a++){n=-1;var d=a;if(o[d].element){for(;o[d].parent!=-1;)d=o[d].parent;o[d].rank>=0&&(o[d].rank=~h++),n=~o[d].rank}f[a]=n}var p=[];for(a=0;a<h+1;++a)p[a]={neighbors:0,x:0,y:0,width:0,height:0,confidence:0};for(a=0;a<r;++a){var m=t[a],g=f[a];0==p[g].neighbors&&(p[g].confidence=m.confidence),++p[g].neighbors,p[g].x+=m.x,p[g].y+=m.y,p[g].width+=m.width,p[g].height+=m.height,p[g].confidence=Math.max(p[g].confidence,m.confidence)}var v=[];for(a=0;a<h;++a)r=p[a].neighbors,r>=i&&v.push({x:(2*p[a].x+r)/(2*r),y:(2*p[a].y+r)/(2*r),width:(2*p[a].width+r)/(2*r),height:(2*p[a].height+r)/(2*r),neighbors:p[a].neighbors,confidence:p[a].confidence});var S=[];for(r=v.length,a=0;a<r;++a){var m=v[a],y=!0;for(n=0;n<r;++n){var w=v[n],b=.25*w.width+.5|0;if(a!=n&&m.x>=w.x-b&&m.y>=w.y-b&&m.x+m.width<=w.x+w.width+b&&m.y+m.height<=w.y+w.height+b&&(w.neighbors>Math.max(3,m.neighbors)||m.neighbors<3)){y=!1;break}}y&&S.push(m)}return S}}}();e.bbf=t}(jsfeat),function(e){"undefined"==typeof module||"undefined"==typeof module.exports?window.jsfeat=e:module.exports=e}(jsfeat),/*
The MIT License (MIT)

Copyright (c) 2014, 2015 hMatoba(https://github.com/hMatoba)

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
function(){"use strict";function e(e){return JSON.parse(JSON.stringify(e))}function t(e){for(var t=f(e);"\xff\xe0"<=t[1].slice(0,2)&&t[1].slice(0,2)<="\xff\xef";)t=[t[0]].concat(t.slice(2));return t.join("")}function i(e){return l(">"+u("B",e.length),e)}function a(e){return l(">"+u("H",e.length),e)}function n(e){return l(">"+u("L",e.length),e)}function r(e,t,r){var o,s,c,f,h="",d="";if("Byte"==t)o=e.length,o<=4?d=i(e)+u("\0",4-o):(d=l(">L",[r]),h=i(e));else if("Short"==t)o=e.length,o<=2?d=a(e)+u("\0\0",2-o):(d=l(">L",[r]),h=a(e));else if("Long"==t)o=e.length,o<=1?d=n(e):(d=l(">L",[r]),h=n(e));else if("Ascii"==t)s=e+"\0",o=s.length,o>4?(d=l(">L",[r]),h=s):d=s+u("\0",4-o);else if("Rational"==t){if("number"==typeof e[0])o=1,c=e[0],f=e[1],s=l(">L",[c])+l(">L",[f]);else{o=e.length,s="";for(var p=0;p<o;p++)c=e[p][0],f=e[p][1],s+=l(">L",[c])+l(">L",[f])}d=l(">L",[r]),h=s}else if("SRational"==t){if("number"==typeof e[0])o=1,c=e[0],f=e[1],s=l(">l",[c])+l(">l",[f]);else{o=e.length,s="";for(var p=0;p<o;p++)c=e[p][0],f=e[p][1],s+=l(">l",[c])+l(">l",[f])}d=l(">L",[r]),h=s}else"Undefined"==t&&(o=e.length,o>4?(d=l(">L",[r]),h=e):d=e+u("\0",4-o));var m=l(">L",[o]);return[m,d,h]}function o(e,t,i){var a,n=8,o=Object.keys(e).length,s=l(">H",[o]);a=["0th","1st"].indexOf(t)>-1?2+12*o+4:2+12*o;var c,u="",f="";for(var c in e)if("string"==typeof c&&(c=parseInt(c)),!("0th"==t&&[34665,34853].indexOf(c)>-1||"Exif"==t&&40965==c||"1st"==t&&[513,514].indexOf(c)>-1)){var h=e[c],d=l(">H",[c]),p=S[t][c].type,m=l(">H",[v[p]]);"number"==typeof h&&(h=[h]);var g=n+a+i+f.length,y=r(h,p,g),w=y[0],b=y[1],C=y[2];u+=d+m+w+b,f+=C}return[s+u,f]}function s(e){var t,i;if("\xff\xd8"==e.slice(0,2))t=f(e),i=h(t),i?this.tiftag=i.slice(10):this.tiftag=null;else if(["II","MM"].indexOf(e.slice(0,2))>-1)this.tiftag=e;else{if("Exif"!=e.slice(0,4))throw"Given file is neither JPEG nor TIFF.";this.tiftag=e.slice(6)}}function l(e,t){if(!(t instanceof Array))throw"'pack' error. Got invalid type argument.";if(e.length-1!=t.length)throw"'pack' error. "+(e.length-1)+" marks, "+t.length+" elements.";var i;if("<"==e[0])i=!0;else{if(">"!=e[0])throw"";i=!1}for(var a="",n=1,r=null,o=null,s=null;o=e[n];){if("b"==o.toLowerCase()){if(r=t[n-1],"b"==o&&r<0&&(r+=256),r>255||r<0)throw"'pack' error.";s=String.fromCharCode(r)}else if("H"==o){if(r=t[n-1],r>65535||r<0)throw"'pack' error.";s=String.fromCharCode(Math.floor(r%65536/256))+String.fromCharCode(r%256),i&&(s=s.split("").reverse().join(""))}else{if("l"!=o.toLowerCase())throw"'pack' error.";if(r=t[n-1],"l"==o&&r<0&&(r+=4294967296),r>4294967295||r<0)throw"'pack' error.";s=String.fromCharCode(Math.floor(r/16777216))+String.fromCharCode(Math.floor(r%16777216/65536))+String.fromCharCode(Math.floor(r%65536/256))+String.fromCharCode(r%256),i&&(s=s.split("").reverse().join(""))}a+=s,n+=1}return a}function c(e,t){if("string"!=typeof t)throw"'unpack' error. Got invalid type argument.";for(var i=0,a=1;a<e.length;a++)if("b"==e[a].toLowerCase())i+=1;else if("h"==e[a].toLowerCase())i+=2;else{if("l"!=e[a].toLowerCase())throw"'unpack' error. Got invalid mark.";i+=4}if(i!=t.length)throw"'unpack' error. Mismatch between symbol and string length. "+i+":"+t.length;var n;if("<"==e[0])n=!0;else{if(">"!=e[0])throw"'unpack' error.";n=!1}for(var r=[],o=0,s=1,l=null,c=null,u=null,f="";c=e[s];){if("b"==c.toLowerCase())u=1,f=t.slice(o,o+u),l=f.charCodeAt(0),"b"==c&&l>=128&&(l-=256);else if("H"==c)u=2,f=t.slice(o,o+u),n&&(f=f.split("").reverse().join("")),l=256*f.charCodeAt(0)+f.charCodeAt(1);else{if("l"!=c.toLowerCase())throw"'unpack' error. "+c;u=4,f=t.slice(o,o+u),n&&(f=f.split("").reverse().join("")),l=16777216*f.charCodeAt(0)+65536*f.charCodeAt(1)+256*f.charCodeAt(2)+f.charCodeAt(3),"l"==c&&l>=2147483648&&(l-=4294967296)}r.push(l),o+=u,s+=1}return r}function u(e,t){for(var i="",a=0;a<t;a++)i+=e;return i}function f(e){if("\xff\xd8"!=e.slice(0,2))throw"Given data isn't JPEG.";for(var t=2,i=["\xff\xd8"];;){if("\xff\xda"==e.slice(t,t+2)){i.push(e.slice(t));break}var a=c(">H",e.slice(t+2,t+4))[0],n=t+a+2;if(i.push(e.slice(t,n)),t=n,t>=e.length)throw"Wrong JPEG data."}return i}function h(e){for(var t,i=0;i<e.length;i++)if(t=e[i],"\xff\xe1"==t.slice(0,2))return t;return null}function d(e,t){return"\xff\xe0"==e[1].slice(0,2)&&"\xff\xe1"==e[2].slice(0,2)?t?(e[2]=t,e=["\xff\xd8",t].concat(e.slice(2))):e=null==t?e.slice(0,2).concat(e.slice(3)):e.slice(0).concat(e.slice(2)):"\xff\xe0"==e[1].slice(0,2)?t&&(e[1]=t):"\xff\xe1"==e[1].slice(0,2)?t?e[1]=t:null==t&&(e=e.slice(0).concat(e.slice(2))):t&&(e=[e[0],t].concat(e.slice(1))),e.join("")}var p={};if(p.remove=function(e){var t=!1;if("\xff\xd8"==e.slice(0,2));else{if("data:image/jpeg;base64,"!=e.slice(0,23))throw"Given data is not jpeg.";e=g(e.split(",")[1]),t=!0}var i=f(e);if("\xff\xe1"==i[1].slice(0,2))i=[i[0]].concat(i.slice(2));else{if("\xff\xe1"!=i[2].slice(0,2))throw"Exif not found.";i=i.slice(0,2).concat(i.slice(3))}var a=i.join("");return t&&(a="data:image/jpeg;base64,"+m(a)),a},p.insert=function(e,t){var i=!1;if("Exif\0\0"!=e.slice(0,6))throw"Given data is not exif.";if("\xff\xd8"==t.slice(0,2));else{if("data:image/jpeg;base64,"!=t.slice(0,23))throw"Given data is not jpeg.";t=g(t.split(",")[1]),i=!0}var a="\xff\xe1"+l(">H",[e.length+2])+e,n=f(t),r=d(n,a);return i&&(r="data:image/jpeg;base64,"+m(r)),r},p.load=function(e){var t;if("string"!=typeof e)throw"'load' gots invalid type argument.";if("\xff\xd8"==e.slice(0,2))t=e;else if("data:image/jpeg;base64,"==e.slice(0,23))t=g(e.split(",")[1]);else{if("Exif"!=e.slice(0,4))throw"'load' gots invalid file data.";t=e.slice(6)}var i={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},a=new s(t);if(null===a.tiftag)return i;"II"==a.tiftag.slice(0,2)?a.endian_mark="<":a.endian_mark=">";var n=c(a.endian_mark+"L",a.tiftag.slice(4,8))[0];i["0th"]=a.get_ifd(n,"0th");var r=i["0th"].first_ifd_pointer;if(delete i["0th"].first_ifd_pointer,34665 in i["0th"]&&(n=i["0th"][34665],i.Exif=a.get_ifd(n,"Exif")),34853 in i["0th"]&&(n=i["0th"][34853],i.GPS=a.get_ifd(n,"GPS")),40965 in i.Exif&&(n=i.Exif[40965],i.Interop=a.get_ifd(n,"Interop")),"\0\0\0\0"!=r&&(n=c(a.endian_mark+"L",r)[0],i["1st"]=a.get_ifd(n,"1st"),513 in i["1st"]&&514 in i["1st"])){var o=i["1st"][513]+i["1st"][514],l=a.tiftag.slice(i["1st"][513],o);i.thumbnail=l}return i},p.dump=function(i){var a,n,r,s,c,u=8,f=e(i),h="Exif\0\0MM\0*\0\0\0\b",d=!1,p=!1,m=!1,g=!1;a="0th"in f?f["0th"]:{},("Exif"in f&&Object.keys(f.Exif).length||"Interop"in f&&Object.keys(f.Interop).length)&&(a[34665]=1,d=!0,n=f.Exif,"Interop"in f&&Object.keys(f.Interop).length&&(n[40965]=1,m=!0,r=f.Interop)),"GPS"in f&&Object.keys(f.GPS).length&&(a[34853]=1,p=!0,s=f.GPS),"1st"in f&&"thumbnail"in f&&null!=f.thumbnail&&(g=!0,f["1st"][513]=1,f["1st"][514]=1,c=f["1st"]);var S,y,w,b,C,T=o(a,"0th",0),A=T[0].length+12*d+12*p+4+T[1].length,P="",E=0,I="",_=0,x="",D=0,M="";if(d&&(S=o(n,"Exif",A),E=S[0].length+12*m+S[1].length),p&&(y=o(s,"GPS",A+E),I=y.join(""),_=I.length),m){var L=A+E+_;w=o(r,"Interop",L),x=w.join(""),D=x.length}if(g){var L=A+E+_+D;if(b=o(c,"1st",L),C=t(f.thumbnail),C.length>64e3)throw"Given thumbnail is too large. max 64kB"}var R="",O="",k="",G="\0\0\0\0";if(d){var F=u+A,U=l(">L",[F]),j=34665,N=l(">H",[j]),B=l(">H",[v.Long]),H=l(">L",[1]);R=N+B+H+U}if(p){var F=u+A+E,U=l(">L",[F]),j=34853,N=l(">H",[j]),B=l(">H",[v.Long]),H=l(">L",[1]);O=N+B+H+U}if(m){var F=u+A+E+_,U=l(">L",[F]),j=40965,N=l(">H",[j]),B=l(">H",[v.Long]),H=l(">L",[1]);k=N+B+H+U}if(g){var F=u+A+E+_+D;G=l(">L",[F]);var V=F+b[0].length+24+4+b[1].length,W="\x02\x01\0\x04\0\0\0\x01"+l(">L",[V]),z="\x02\x02\0\x04\0\0\0\x01"+l(">L",[C.length]);M=b[0]+W+z+"\0\0\0\0"+b[1]+C}var K=T[0]+R+O+G+T[1];return d&&(P=S[0]+k+S[1]),h+K+P+I+x+M},s.prototype={get_ifd:function(e,t){var i,a={},n=c(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],r=e+2;i=["0th","1st"].indexOf(t)>-1?"Image":t;for(var o=0;o<n;o++){e=r+12*o;var s=c(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],l=c(this.endian_mark+"H",this.tiftag.slice(e+2,e+4))[0],u=c(this.endian_mark+"L",this.tiftag.slice(e+4,e+8))[0],f=this.tiftag.slice(e+8,e+12),h=[l,u,f];s in S[i]&&(a[s]=this.convert_value(h))}return"0th"==t&&(e=r+12*n,a.first_ifd_pointer=this.tiftag.slice(e,e+4)),a},convert_value:function(e){var t,i=null,a=e[0],n=e[1],r=e[2];if(1==a)n>4?(t=c(this.endian_mark+"L",r)[0],i=c(this.endian_mark+u("B",n),this.tiftag.slice(t,t+n))):i=c(this.endian_mark+u("B",n),r.slice(0,n));else if(2==a)n>4?(t=c(this.endian_mark+"L",r)[0],i=this.tiftag.slice(t,t+n-1)):i=r.slice(0,n-1);else if(3==a)n>2?(t=c(this.endian_mark+"L",r)[0],i=c(this.endian_mark+u("H",n),this.tiftag.slice(t,t+2*n))):i=c(this.endian_mark+u("H",n),r.slice(0,2*n));else if(4==a)n>1?(t=c(this.endian_mark+"L",r)[0],i=c(this.endian_mark+u("L",n),this.tiftag.slice(t,t+4*n))):i=c(this.endian_mark+u("L",n),r);else if(5==a)if(t=c(this.endian_mark+"L",r)[0],n>1){i=[];for(var o=0;o<n;o++)i.push([c(this.endian_mark+"L",this.tiftag.slice(t+8*o,t+4+8*o))[0],c(this.endian_mark+"L",this.tiftag.slice(t+4+8*o,t+8+8*o))[0]])}else i=[c(this.endian_mark+"L",this.tiftag.slice(t,t+4))[0],c(this.endian_mark+"L",this.tiftag.slice(t+4,t+8))[0]];else if(7==a)n>4?(t=c(this.endian_mark+"L",r)[0],i=this.tiftag.slice(t,t+n)):i=r.slice(0,n);else{if(10!=a)throw"Exif might be wrong. Got incorrect value type to decode. type:"+a;if(t=c(this.endian_mark+"L",r)[0],n>1){i=[];for(var o=0;o<n;o++)i.push([c(this.endian_mark+"l",this.tiftag.slice(t+8*o,t+4+8*o))[0],c(this.endian_mark+"l",this.tiftag.slice(t+4+8*o,t+8+8*o))[0]])}else i=[c(this.endian_mark+"l",this.tiftag.slice(t,t+4))[0],c(this.endian_mark+"l",this.tiftag.slice(t+4,t+8))[0]]}return i instanceof Array&&1==i.length?i[0]:i}},"undefined"==typeof m)var m=function(e){for(var t,i,a,n,r,o,s,l="",c=0,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";c<e.length;)t=e.charCodeAt(c++),i=e.charCodeAt(c++),a=e.charCodeAt(c++),n=t>>2,r=(3&t)<<4|i>>4,o=(15&i)<<2|a>>6,s=63&a,isNaN(i)?o=s=64:isNaN(a)&&(s=64),l=l+u.charAt(n)+u.charAt(r)+u.charAt(o)+u.charAt(s);return l};if("undefined"==typeof g)var g=function(e){var t,i,a,n,r,o,s,l="",c=0,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)n=u.indexOf(e.charAt(c++)),r=u.indexOf(e.charAt(c++)),o=u.indexOf(e.charAt(c++)),s=u.indexOf(e.charAt(c++)),t=n<<2|r>>4,i=(15&r)<<4|o>>2,a=(3&o)<<6|s,l+=String.fromCharCode(t),64!=o&&(l+=String.fromCharCode(i)),64!=s&&(l+=String.fromCharCode(a));return l};var v={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},S={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};S["0th"]=S.Image,S["1st"]=S.Image,p.TAGS=S,p.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},p.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},p.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},p.InteropIFD={InteroperabilityIndex:1},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports.piexif=p):window.piexif=p}();var KfxWebSDK=KfxWebSDK||{version:"3.5.0.4.0.691",/**
     * @memberof KfxWebSDK
     * @readonly
     * @property {Number} MOBILE_ID Type of USA driver license
     * @property {Number} CHECK_DEPOSIT Type of deposit checks
     * @property {Number} BILL_PAY Type of pay bills
     * @property {Number} PASSPORT Type of international passports
     */
document:{MOBILE_ID:0,CHECK_DEPOSIT:1,BILL_PAY:2,PASSPORT:3},ERROR_CODE_STATE:0,ERROR_CODE_VALIDATION:1,ERROR_CODE_RUNTIME:2,ERROR_CODE_MEDIA:3,ERROR_CODE_CAPTURE:4,ERROR_CODE_PROCESS:5,ERROR_CODE_SELFIECAPTURE:6},Module;!function(){var e=e||{};!function(){for(var t,i="KfxWebSDK.js",a="KfxWebSDKInternal.js",n=document.getElementsByTagName("script"),r=0;r<n.length;r++){if(t=n[r].src,t.indexOf(a)>-1){e.rootPath=t.replace(a,"")+"../";break}if(t.indexOf(i)>-1){e.rootPath=t.replace(i,"");break}}}(),e.Color=function(){"use strict";function e(e){return null!==e.match(r)}function t(e){return null!==e.match(o)}function i(e){return null!==e.match(s)}function a(e){return l.indexOf(e)>=0}function n(n){return e(n)||t(n)||i(n)||a(n)}var r=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,o=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,s=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,l=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"];return{isColor:n,isHexColor:e,isRgbaColor:t,isHslaColor:i,isCss3Color:a}}(),function(){"use strict";function t(e,t){this.code=e,this.name="InternalError",this.message=t||"",this.stack=(new Error).stack}function i(e){t.call(this,KfxWebSDK.ERROR_CODE_VALIDATION,e),this.name="ValidationError"}function a(e){t.call(this,KfxWebSDK.ERROR_CODE_STATE,e),this.name="StateError"}function n(e){t.call(this,KfxWebSDK.ERROR_CODE_MEDIA,e),this.name="UserMediaError"}function r(e){t.call(this,KfxWebSDK.ERROR_CODE_CAPTURE,e),this.name="CaptureError"}function o(e){t.call(this,KfxWebSDK.ERROR_CODE_PROCESS,e),this.name="ProcessError"}function s(e){t.call(this,KfxWebSDK.ERROR_CODE_SELFIECAPTURE,e),this.name="SelfieCaptureError"}function l(e,i){var a={message:i.message,code:i instanceof t?i.code:KfxWebSDK.ERROR_CODE_RUNTIME,toString:function(){return i.message}};a.code===KfxWebSDK.ERROR_CODE_RUNTIME&&(a.stack=i.stack),e(a)}t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,i.prototype=Object.create(t.prototype),i.prototype.constructor=i,a.prototype=Object.create(t.prototype),a.prototype.constructor=a,n.prototype=Object.create(t.prototype),n.prototype.constructor=n,r.prototype=Object.create(t.prototype),r.prototype.constructor=r,o.prototype=Object.create(t.prototype),o.prototype.constructor=o,s.prototype=Object.create(t.prototype),s.prototype.constructor=s,e.InternalError=t,e.ValidationError=i,e.StateError=a,e.UserMediaError=n,e.CaptureError=r,e.ProcessError=o,e.SelfieCaptureError=s,e.report=l}(),e.EXIF=function(){"use strict";function e(e,t,i,a,n){switch(n){case 5:case 6:case 7:case 8:e.width=a,e.height=i;break;default:e.width=i,e.height=a}switch(n){case 2:t.translate(i,0),t.scale(-1,1);break;case 3:t.translate(i,a),t.rotate(Math.PI);break;case 4:t.translate(0,a),t.scale(1,-1);break;case 5:t.rotate(.5*Math.PI),t.scale(1,-1);break;case 6:t.rotate(.5*Math.PI),t.translate(0,-a);break;case 7:t.rotate(.5*Math.PI),t.translate(i,-a),t.scale(-1,1);break;case 8:t.rotate(-.5*Math.PI),t.translate(-i,0)}}return{transformCoordinate:e}}(),function(){"use strict";e.Math={},e.Math.isNaN=function(e){return void 0===Number.isNaN?isNaN(e):Number.isNaN(e)},e.Math.isFinite=function(e){return void 0===Number.isNaN?isFinite(e):Number.isFinite(e)},e.Math.getXY=function(e,t){var i=Math.floor(e/t);return[e-i*t,i]},e.Math.getIx=function(e,t,i){return t*i+e},e.Math.getLongToShortAspectRatio=function(e){return 0===e?0:e>=1?e:1/e}}(),e.Type=function(){"use strict";function t(e){return"string"==typeof e}function i(e){return t(e)&&e.length>0}function a(e){return"boolean"==typeof e}function n(e){return"number"==typeof e}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function o(e){return"[object Object]"===Object.prototype.toString.call(e)}function s(e){return"function"==typeof e}function l(e){for(var t in u)if(u.hasOwnProperty(t)&&u[t](e))return t}function c(t,i){return e.Utils.isSet(t)&&t.toString().indexOf(i)>=0}var u={string:t,number:n,array:r,object:o,"boolean":a,"function":s};return{getType:l,checkInstance:c,isString:t,isNotEmptyString:i,isNumber:n,isArray:r,isObject:o,isBoolean:a,isFunction:s}}(),e.Utils=function(){"use strict";function t(t,a){if("[object Object]"!==Object.prototype.toString.call(t))throw new e.ValidationError("Options argument is not an key - value object instance");for(var n in t){var r=a[n];if(t.hasOwnProperty(n)&&void 0!==r&&void 0!==r.type){var o=t[n],s=typeof o;if(g(o)||void 0===r["default"]||null===r["default"]||(t[n]=r["default"]),!g(o))throw new e.ValidationError("Option "+n+" is not set");var l=r.type;if("string"==typeof l&&l!==s)throw new e.ValidationError("Option "+n+" is not a "+l+" type");if("object"==typeof l&&l.indexOf(s)<0)throw new e.ValidationError("Option "+n+" is not one of the following types "+l);if("object"===s&&r.color===!0){var c=o.toString();if(c.indexOf("CanvasPattern")<0&&c.indexOf("CanvasGradient")<0)throw new e.ValidationError("Option "+n+" value "+o+" is not a gradient or pattern object")}if("string"===s&&r.color===!0&&!e.Color.isColor(o))throw new e.ValidationError("Option "+n+" value "+o+" is not a valid color representation");if(("string"===s||"number"===s)&&Array.isArray(r.options)&&r.options.indexOf(o)<0)throw new e.ValidationError("Option "+n+" value "+o+" is not one of the following: "+r.options);if("string"===s&&"[object Object]"===Object.prototype.toString.call(r.html)){var u=document.getElementById(o);if(!u)throw new e.ValidationError("Option "+n+" value "+o+" no html element with such id found");if("string"==typeof r.html.tag&&u.tagName.toLowerCase()!==r.html.tag)throw new e.ValidationError("Option "+n+" value "+o+" is not a "+r.html.tag+" element");if(r.html.hasChild===!1&&u.childElementCount>0)throw new e.ValidationError("Option "+n+" value "+o+" html element with this id is not empty, it has "+u.childElementCount+" child elements")}if("number"===s){if(e.Math.isNaN(o))throw new e.ValidationError("Option "+n+" value "+o+" is not a number");if(!e.Math.isFinite(o))throw new e.ValidationError("Option "+n+" value "+o+" is a non-finite number");var f=void 0===r.min?void 0:r.min.value,h=void 0===r.max?void 0:r.max.value,d=void 0===r.min?void 0:r.min.include,p=void 0===r.max?void 0:r.max.include;i(n,o,f,d,h,p)}}}for(var n in a){var r=a[n],o=t[n];if(a.hasOwnProperty(n))if(g(o)||void 0===r["default"]||null===r["default"]){if(!g(o)&&r.mandatory===!0)throw new e.ValidationError("Mandatory option "+n+" is not set")}else t[n]=r["default"]}}function i(t,i,a,n,r,o){if(void 0!==a||void 0!==r){var s="Option "+t+" value "+i+" must be";if(void 0!==a&&void 0!==r?s+=" in the range "+a+(n?" <= ":" < ")+"value"+(o?" <= ":" < ")+r:void 0!==a&&void 0===r?s+=(n?" >= ":" > ")+a:void 0===a&&void 0!==r&&(s+=(o?" <= ":" < ")+r),void 0!==a)if(n){if(i<a)throw new e.ValidationError(s)}else if(i<=a)throw new e.ValidationError(s);if(void 0!==r)if(o){if(i>r)throw new e.ValidationError(s)}else if(i>=r)throw new e.ValidationError(s)}}function a(e){var t={};for(var i in e)e.hasOwnProperty(i)&&("object"==typeof e[i]?t[i]=a(e[i]):t[i]=e[i]);return t}function n(e,t,i){if(void 0!==t)for(var a in e)if(e.hasOwnProperty(a))if("object"!=typeof e[a]){if(void 0===t[a]?e[a]=void 0===e[a]?i[a]:e[a]:e[a]=t[a],void 0===e[a])throw new Error("Parameter "+a+" is not defined")}else n(e[a],t[a],i[a])}function r(e,t){for(var i in e)if(e.hasOwnProperty(i)&&(e[i]=t[i],void 0===e[i]))throw new Error("Parameter "+i+" is not defined")}function o(e,t){if(void 0===e||0===Object.keys(e).length)throw new Error("Callbacks are not defined");if(void 0===t){for(var i in e)if(e.hasOwnProperty(i)&&"function"!=typeof e[i])throw new Error("Callback "+i+" is not defined")}else for(var a=0;a<t.length;a++)if("function"!=typeof e[t[a]])throw new Error("Callback "+t[a]+" is not defined")}function s(t,i){return e.Type.isNotEmptyString(i)&&Object.prototype.toString.call(t).indexOf(i)>=0}function l(t,i,a){if(void 0===i||null===i)throw new e.ValidationError("Argument "+t+" is undefined or null");if(!s(i,a))throw new e.ValidationError("Argument "+t+" is not a "+a+" instance")}function c(t,i){if(l(t,i,"ImageData"),i.width<=0||i.height<=0)throw new e.ValidationError("Argument "+t+" is image data with invalid dimensions, width and height must be > 0")}function u(t,i){if(l(t,i,"HTMLImageElement"),i.width<=0||i.height<=0)throw new e.ValidationError("Argument "+t+" is html image element with invalid dimensions, width and height must be > 0")}function f(e){return null!==e&&"undefined"!=typeof e&&0!=e.length}function h(e,t){d(e,"kfx-hidden",!t)}function d(e,t,i){if("undefined"==typeof i)return void e.classList.toggle(t);var a=i?"add":"remove";e.classList[a](t)}function p(e,t){var i=document.createElement(e);return i.className=t,i}function m(e){for(var t=0;t<e.length;++t){var i=e[t];i()}}function g(e){return void 0!==e&&null!==e}function v(t){return e.rootPath+"Images/"+t}function S(t){return e.rootPath+"Models/"+t}function y(t){return e.rootPath+"Libs/"+t}function w(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}function b(){var e=null;e=new Date;var t=e.getUTCFullYear(),i=e.getUTCMonth()+1;1==i.length&&(i="0"+i);var a=e.getUTCDate();return 1==a.length&&(a="0"+a),t+"-"+i+"-"+a+" "+e.getUTCHours()+":"+e.getUTCMinutes()+":"+e.getUTCSeconds()+"."+e.getUTCMilliseconds()}function C(){var e=new Date,t=e.toTimeString();return t=t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")"))}function T(){var e=navigator.appVersion,t=e.substring(e.indexOf("(")+1,e.indexOf(")"));return t}function A(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function P(e){try{JSON.parse(e)}catch(t){return!1}return!0}function E(){var e=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;return e}function I(e,t,i,a){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(t){if(4===n.readyState)if(200===n.status)try{var r=new Uint8Array(n.response);cv.FS_createDataFile("/",e,r,!0,!1,!1),i()}catch(o){a()}else a();else a()},n.send()}function _(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}function x(){var e={options:[],header:[navigator.platform,navigator.userAgent,navigator.appVersion,navigator.vendor,window.opera],dataos:[{name:"Windows Phone",value:"Windows Phone",version:"OS"},{name:"Windows",value:"Win",version:"NT"},{name:"iPhone",value:"iPhone",version:"OS"},{name:"iPad",value:"iPad",version:"OS"},{name:"Kindle",value:"Silk",version:"Silk"},{name:"Android",value:"Android",version:"Android"},{name:"PlayBook",value:"PlayBook",version:"OS"},{name:"BlackBerry",value:"BlackBerry",version:"/"},{name:"Macintosh",value:"Mac",version:"OS X"},{name:"Linux",value:"Linux",version:"rv"},{name:"Palm",value:"Palm",version:"PalmOS"}],databrowser:[{name:"Chrome",value:"Chrome",version:"Chrome"},{name:"Firefox",value:"Firefox",version:"Firefox"},{name:"Safari",value:"Safari",version:"Version"},{name:"Internet Explorer",value:"MSIE",version:"MSIE"},{name:"Opera",value:"Opera",version:"Opera"},{name:"BlackBerry",value:"CLDC",version:"CLDC"},{name:"Mozilla",value:"Mozilla",version:"Mozilla"}],init:function(){var e=this.header.join(" "),t=this.matchItem(e,this.dataos),i=this.matchItem(e,this.databrowser);return{os:t,browser:i}},matchItem:function(e,t){var i,a,n,r,o,s=0,l=0;for(s=0;s<t.length;s+=1)if(i=new RegExp(t[s].value,"i"),n=i.test(e)){if(a=new RegExp(t[s].version+"[- /:;]([\\d._]+)","i"),r=e.match(a),o="",r&&r[1]&&(r=r[1]),r)for(r=r.split(/[._]+/),l=0;l<r.length;l+=1)o+=0===l?r[l]+".":r[l];else o="0";return{name:t[s].name,version:parseFloat(o)}}return{name:"unknown",version:0}}},t=e.init();return t}return{toggleElement:h,toggleClass:d,createElement:p,getOptions:a,setOptions:n,resetOptions:r,isSet:g,isClassInstance:s,verifyArgument:l,verifyCallbacks:o,verifyImageData:c,verifyHtmlImageElement:u,validateOptions:t,verifyString:f,notifyListeners:m,getImageUrl:v,getModelsUrl:S,getLibsUrl:y,removeAllChildren:w,getDeviceModel:T,getCurrentDateTime:b,getTimeZone:C,guid:A,isJSONValid:P,isIOSDevice:E,createFileFromUrl:I,isMobileOrTablet:_,getDeviceDetails:x}}(),e.Visibility=function(){"use strict";var e,t,i,a={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(e in a)if(e in document){t=a[e];break}var n=function(e){e&&(i=e,document.addEventListener(t,i))},r=function(){return!document[e]},o=function(){i&&document.removeEventListener(t,i)};return{addListener:n,removeListener:o,status:r}}(),e.ImageUtils=function(){"use strict";function e(e,t){var i=document.createElement("canvas");return i.width=e,i.height=t,i}function t(t,i){var a=e(t,i);return a.getContext("2d").getImageData(0,0,t,i)}function i(t){var i=e(t.width,t.height);return i.getContext("2d").putImageData(t,0,0),i}function a(t,i,a){var n=Math.sqrt(t*i/a),r=1/n,o=Math.floor(t/n),s=Math.floor(i/n),l=e(o,s),c=l.getContext("2d");return c.scale(r,r),{scaleFactor:n,context:c,width:o,height:s}}function n(e,t){var n=e.width,r=e.height,o={},s=a(n,r,t);o.scaleFactor=s.scaleFactor;var l=s.context,c=i(e);return l.drawImage(c,0,0,n,r),o.imageData=l.getImageData(0,0,s.width,s.height),o}function r(e){var t=e.mean;return o(e,Math.max(0,Math.floor(.15*t)),Math.min(255,Math.floor(.87*t)))}function o(e,t,i){jsfeat.imgproc.canny(e,e,t,i);for(var a=e.cols*e.rows,n=new Array(a),r=0;r<a;r++)n[r]=e.data[r];return n}function s(e,t){var i=new jsfeat.matrix_t(e.width,e.height,jsfeat.U8C1_t),a=new jsfeat.matrix_t(e.width,e.height,jsfeat.U8C1_t),n=new jsfeat.matrix_t(e.width,e.height,jsfeat.U8C1_t),r=e.data,o=r.length,s=e.width,l=e.height;i.resize(s,l,1),a.resize(s,l,1),n.resize(s,l,1);for(var c=i.data,u=a.data,f=n.data,h=[],d=0,p=0,m=0,g=s*l,v=0,S=0;v<o;v+=4,S++)c[S]=r[v],d+=c[S],u[S]=r[v+1],p+=u[S],f[S]=r[v+2],m+=f[S],h[S]=0;return jsfeat.imgproc.gaussian_blur(i,i,t),jsfeat.imgproc.gaussian_blur(a,a,t),jsfeat.imgproc.gaussian_blur(n,n,t),i.mean=Math.round(d/g),a.mean=Math.round(p/g),n.mean=Math.round(m/g),[i,a,n,h]}function l(e,t,i){for(var a=Number.MAX_VALUE,n=-a,r=Number.MAX_VALUE,o=-r,s=0;s<i;s++)for(var l=0;l<t;l++)e[s*t+l]>0&&(a=Math.min(a,l),n=Math.max(n,l),r=Math.min(r,s),o=Math.max(o,s));return[[a,r],[n,o]]}function c(e,t,i,a){var n=void 0===a?0:a,r=Math.ceil(Math.max(0,i[0][0]-n)),o=Math.ceil(Math.max(0,i[0][1]-n)),s=Math.floor(Math.min(e,i[1][0]+n)),l=Math.floor(Math.min(t,i[1][1]+n));return[r,o,s-r,l-o]}function u(e,t,i){if(e*t<i)throw new Error("Image size "+e+" * "+t+" is less than required "+i)}return{adaptiveCanny:r,getRgbWithBlur:s,getScalingData:a,scaleToPixelSize:n,createEmptyCanvas:e,convertImageDataToCanvas:i,createEmptyImageData:t,getROICropData:c,getBound:l,checkMinSize:u}}(),function(){"use strict";e.LineUtils={},e.LineUtils.getDivineAngle=function(t,i,a){var n=e.LineUtils.getLinesAngle(i,t),r=e.LineUtils.getLinesAngle(a,t);return Math.min(Math.abs(n-r),Math.abs(180-n-r))},e.LineUtils.getParallelLineByPoint=function(t,i){return i.checkPoint(t)?i:new e.LinePolar(t[0]*i.cos+t[1]*i.sin,i.angle)},e.LineUtils.getPointsOnLineByLengthFromAnotherPoint=function(e,t,i){var a=t[0],n=t[1];if(e.isHorizontal)return[[a-i,n],[a+i,n]];if(e.isVertical)return[[a,n-i],[a,n+i]];var r=e.k,o=e.b,s=o-n,l=r*r+1,c=2*(s*r-a),u=s*s+a*a-i*i,f=Math.sqrt(c*c-4*l*u),h=(-c+f)/(2*l),d=r*h+o,p=(-c-f)/(2*l),m=r*p+o;return[[h,d],[p,m]]},e.LineUtils.getLinesDistance=function(e,t){var i;return i=e.north&&t.south||t.north&&e.south?Math.abs(t.rho)+Math.abs(e.rho):Math.abs(Math.abs(t.rho)-Math.abs(e.rho))},e.LineUtils.getLinePolarByPoints=function(t,i){if(i[0]===t[0])return new e.LinePolar(t[0],0);if(i[1]===t[1])return new e.LinePolar(t[1],Math.PI/2);var a=(i[1]-t[1])/(i[0]-t[0]),n=Math.atan(a)+Math.PI/2,r=i[1]-a*i[0],o=r*Math.sin(n);return new e.LinePolar(o,n)},e.LineUtils.getLinesAngle=function(e,t){var i=Math.abs(e.t-t.t);return Math.min(i,180-i)},e.LineUtils.getLinesByAngle=function(e,t,i){for(var a,n=[],r=0;r<e.length;r++)a=Math.abs(e[r].t-t),Math.min(a,180-a)<=i&&n.push(e[r]);return n}}(),function(){"use strict";e.PointUtils={};var t=function(e,t){var i=e[0]-t[0],a=e[1]-t[1];return i*i+a*a},i=function(e,i){return Math.sqrt(t(e,i))};e.PointUtils.getDistance=i,e.PointUtils.getSquareDistance=t,e.PointUtils.getBound=function(e){for(var t,i,a,n=Number.MAX_VALUE,r=-n,o=Number.MAX_VALUE,s=-o,l=0;l<e.length;l++)t=e[l],i=t[0],a=t[1],n=Math.min(n,i),r=Math.max(r,i),o=Math.min(o,a),s=Math.max(s,a);return[[n,o],[r,s]]},e.PointUtils.roundToPoint=function(e,i){for(var a,n,r=Math.floor(e[0]),o=Math.ceil(e[0]),s=Math.floor(e[1]),l=Math.ceil(e[1]),c=[[r,s],[r,l],[o,s],[o,l]],u=0,f=Number.MAX_VALUE;u<c.length;u++)n=t(c[u],i),f>n&&(a=c[u],f=n);return a},e.PointUtils.getOutOfSpaceLength=function(e,t,i){var a=e[0],n=e[1];return Math.max(a<0?-a:a>t?a-t:0,n<0?-n:n>i?n-i:0)},e.PointUtils.scale=function(e,t){return void 0===t&&(t=1),[t*e[0],t*e[1]]},e.PointUtils.scaleAll=function(t,i){for(var a=[],n=e.PointUtils.scale,r=0;r<t.length;r++)a.push(n(t[r],i));return a},e.PointUtils.equals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e.PointUtils.approximatePointToLineDistance=function(e,t,i){return(t[0]-e[0])*(i[1]-e[1])-(t[1]-e[1])*(i[0]-e[0])},e.PointUtils.subtract=function(e,t){var a=i(e,t);return[(e[0]-t[0])/a,(e[1]-t[1])/a]},e.PointUtils.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]}}(),function(){"use strict";function t(){this.shutterSound=document.createElement("audio"),this.shutterSound.src=e.rootPath+"Resources/shutter.mp3",this.shutterSound.onloadeddata=function(){i=!0};var t=this,a=function(){i||t.shutterSound.load(),window.removeEventListener("keydown",a),window.removeEventListener("mousedown",a),window.removeEventListener("touchstart",a)};window.addEventListener("keydown",a),window.addEventListener("mousedown",a),window.addEventListener("touchstart",a)}var i=!1;t.prototype.playShutterSound=function(){i||this.shutterSound.load(),this.shutterSound.play()},t.prototype.pauseShutterSound=function(){this.shutterSound.pause()},e.AutoLoadAudio=t}(),e.Resources=function(){"use strict";function t(e,t){o?r.enumerateDevices().then(i.bind(arguments))["catch"](t):n?MediaStreamTrack.getSources(a.bind(arguments)):t()}function i(e){for(var t,i,a,n=0,r=0,o=0;o<e.length;o++)if(a=e[o],"videoinput"===a.kind){if(n++,t=a.deviceId,void 0===a.label||0===a.label.length){r++;continue}(a.label.toLowerCase().indexOf("back")>=0||a.label.toLowerCase().indexOf("rear")>=0)&&(i=a.deviceId)}var s=void 0===i?t:i;this[0](s,n>0&&n===r)}function a(e){for(var t,i,a,n=0;n<e.length;n++)a=e[n],"video"===a.kind&&(t=a.id,"environment"===a.facing&&(i=a.id));var r=void 0===i?t:i;this[0](r,!1)}var n,r=navigator.mediaDevices,o=void 0!==r&&e.Type.isFunction(r.enumerateDevices);try{n=e.Type.isFunction(MediaStreamTrack.getSources)}catch(s){n=!1}return{load:t}}(),function(){"use strict";function t(e){this.stream=e,this.firefoxStreamTimeout=null}function i(e,t){var i=this,a=i.stream.currentTime;i.firefoxStreamTimeout=setTimeout(function(){(a===i.stream.currentTime?t:e)(),i.firefoxStreamTimeout=null},100)}var a="Camera has been disabled because of security policies";t.prototype.configure=function(e,t,n){try{e.srcObject=this.stream}catch(r){e.src=compatibility.URL.createObjectURL(this.stream)}var o=this,s=o.stream;e.onloadedmetadata=function(r){if(null!=o.stream){if(s.active===!1)return void n(a);if(void 0===s.active&&void 0!==s.currentTime){var l=function(){t(e.videoWidth,e.videoHeight)},c=function(){n(a)};return void i(l,c).call(o)}t()}}},t.prototype.destroy=function(){if(this.stream)for(var e=this.stream.getVideoTracks(),t=0;t<e.length;t++)e[t].stop();this.firefoxStreamTimeout&&clearTimeout(this.firefoxStreamTimeout),this.stream=null,this.firefoxStreamTimeout=null},e.Stream=t}(),function(){function t(e){this.video=e,this.stream=null}function i(){var e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return e?parseInt(e[2],10):61}function a(){return window.navigator.userAgent.indexOf("Windows")!=-1}function n(t,s){if(l>=o.length)return void s(d);var c=o[l],f={video:{mandatory:{minWidth:c.width,minHeight:c.height}},audio:!1};if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&i()>60&&!a()){f={video:{width:{min:c.width,ideal:c.width},height:{min:c.height,ideal:c.height},facingMode:{exact:"environment"}},audio:!1};var h=e.Utils.isIOSDevice();h===!0&&(f.video.width=c.width,f.video.height=c.height)}else void 0===r||u?(r&&(f.video.optional=[{sourceId:r}]),f.video.facingMode={exact:"environment"}):f.video.optional=[{sourceId:r}];var p=this,m=function(i){p.stream=new e.Stream(i),p.stream.configure(p.video,t,s)},g=function(e){l++,n.call(p,t,s)};try{compatibility.getUserMedia(f,m,g)}catch(v){g()}}var r,o=[{width:1920,height:1080}],s=[{width:640,height:480}],l=0,c=0,u=!1,f=!1,h=!1,d="Camera can not be configured for FHD resolution",p="Camera can not be configured for 640x480 resolution";t.prototype.configure=function(t,i){if(f)return void i(d);var a=this;h?n.call(a,t,i):e.Resources.load(function(e,o){r=e,u=o,h=!0,n.call(a,t,i)},function(){f=!0,h=!0})},t.prototype.configureForSelfie=function(t,i){if(c>=s.length)return void i(p);var a=s[c],n={video:{facingMode:{exact:"user"},width:a.width,height:a.height},audio:!1},r=this,o=function(a){r.stream=new e.Stream(a),r.stream.configure(r.video,t,i)},l=function(e){c++,r.configureForSelfie(t,i)};try{compatibility.getUserMedia(n,o,l)}catch(u){l(u)}},t.prototype.destroy=function(){null!==this.stream&&this.stream.destroy(),this.stream=null,this.video.pause(),this.video.src="",this.video=null},e.UserMediaManager=t}(),function(){"use strict";function t(e){removeEventListener("deviceorientation",t,!1),a=e&&null!==e.alpha}function i(){function e(e){if(e=Math.abs(e),e>90&&(e=180-e),e<0||e>90)throw new Error("LevelSensor: wrong angle calculations");return e}function t(t){for(var i=e(t.beta),a=e(t.gamma),n=Math.max(i,a),r=0;r<s.length;++r){var o=s[r];o({angle:n,beta:t.beta,gamma:t.gamma})}}function i(){addEventListener("deviceorientation",t,!1)}function n(){removeEventListener("deviceorientation",t,!1)}function r(e){s.indexOf(e)===-1&&(s.push(e),a?1===s.length&&i():e(null))}function o(e){var t=s.indexOf(e);t!==-1&&(s.splice(t,1),0===s.length&&n())}var s=[];this.addListener=r,this.removeListener=o}var a=null;addEventListener("deviceorientation",t,!1),e.LevelSensor=i}(),e.AppStats=function(){"use strict";function s(){this.SessionKey=null,this.EnvironmentID="",this.DismissalTime="",this.InstanceID="",this.InstanceType=null,this.CreationTime=null}function l(){function e(){this.Environments=[],this.SessionEvents=[],this.Images=[],this.Instances=[],this.CaptureEvents=[],this.FieldChangeEvents=[],this.ImageProcessorEvents=[]}this.AppStatisticsVersion="",this.AppStatisticsTables=new e}function c(){this.Type="",this.SessionKey="test",this.EnvironmentID="",this.DocumentID=null,this.Category="",this.Response="",this.EventTime="",this.ID=""}function u(){this.OSVersion="",this.Carrier="",this.Model="",this.SDKVersion="",this.OSName="HTML5",this.TimeZone="",this.Memory="",this.Language="",this.Manufacturer="",this.ID="",this.DeviceID=""}function S(e){if(d&&d.length>0)for(var t=0;t<d.length;t++)e.AppStatisticsTables.Environments.push(d[t])}function w(e){if(p&&p.length>0)for(var t=0;t<p.length;t++)e.AppStatisticsTables.SessionEvents.push(p[t])}function C(e){if(y&&y.length>0)for(var t=0;t<y.length;t++)e.AppStatisticsTables.Images.push(y[t])}function A(e){if(m&&m.length>0)for(var t=0;t<m.length;t++)e.AppStatisticsTables.Instances.push(m[t])}function P(e){if(v&&v.length>0)for(var t=0;t<v.length;t++)e.AppStatisticsTables.CaptureEvents.push(v[t])}function I(e){if(g&&g.length>0)for(var t=0;t<g.length;t++)e.AppStatisticsTables.FieldChangeEvents.push(g[t])}function _(e){if(b&&b.length>0)for(var t=0;t<b.length;t++)e.AppStatisticsTables.ImageProcessorEvents.push(b[t])}var D=null,M=function(e,t){d&&d.length>0&&(d=[]),d.push(O()),x=E.APP_STATS_INITIALIZED,"function"==typeof e&&e(x)},L=function(n,r,o){var s=new c;s.Type=n,s.SessionKey=t,s.EnvironmentID=a,o?s.DocumentID=o:s.DocumentID="",s.Category=i,s.Response=r,s.EventTime=e.Utils.getCurrentDateTime(),s.ID=e.Utils.guid(),"BeginSession"===n&&(f=s.ID),p.push(s)},R=function(e,t){var i=new l;i.AppStatisticsVersion=KfxWebSDK.version,S(i),w(i),C(i),A(i),P(i),I(i),_(i),"function"==typeof e&&(x=E.APP_STATS_INITIALIZED,e(i),G())},O=function(){return D=new u,D.OSVersion="",D.Carrier="",D.Model=e.Utils.getDeviceModel(),D.SDKVersion=KfxWebSDK.version,D.OSName="HTML5",D.TimeZone=e.Utils.getTimeZone(),D.Memory="",D.Language=navigator.language,D.Manufacturer="",D.ID=e.Utils.guid(),D.DeviceID="",a=D.ID,D},k=function(i){if(h){var l=new s;t?l.SessionKey=t:l.SessionKey="",l.EnvironmentID=a,l.DismissalTime="",l.InstanceID=e.Utils.guid(),i&&(l.InstanceType=i,i===T.CAPTURE?n=l.InstanceID:i===T.PROCESS?o=l.InstanceID:i===T.SELFIE_CAPTURE&&(r=l.InstanceID)),l.CreationTime=e.Utils.getCurrentDateTime(),m.push(l)}},G=function(){p&&p.length>0&&(p=[]),m&&m.length>0&&(m=[]),d&&d.length>0&&(d=[]),f="",e.CaptureEventAppStats.cleanUpData(),e.LogisticsEventAppStats.cleanUpData(),e.SelfieCaptureEventAppStats.cleanUpData(),e.ProcessEventAppStats.cleanUpData()};return{initAppStats:M,logSessionEvent:L,exportAppStats:R,prepareEnvironment:O,prepareInstance:k,cleanUpData:G}}();var t,i,a,n,r,o,s,l,c,u,f,h=!1,d=[],p=[],m=[],g=[],v=[],S=[],y=[],w=[],b=[],C={BITONAL:"Process Bitonal",AUTOCROP:"Process AutoCrop",SETDPI:"Process SetDPI",SCALE:"Process Scale"},T={CAPTURE:"Image Capture",PROCESS:"Image Processor",SELFIE_CAPTURE:"Selfie Capture"},A={ADVANCE_CAPTURE:"Web Capture",CAPTURE_FALLBACK:"CaptureFallback",FORCE_TAKE_PICTURE:"Force Take Picture"},P={ADVANCE_CAPTURE:"Selfie Capture",SELFIE_FALLBACK:"SelfieFallback",FORCE_TAKE_SELFIE:"Force Take Selfie"};e.CaptureEventAppStats=function(){"use strict";function i(){this.EventType=null,this.SessionKey=null,this.ImageID=null,this.Value="",this.EventTime="",this.InstanceID="",this.ID=""}function r(){this.SessionKey="",this.EnvironmentID="",this.StoragePath="",this.DocumentID=null,this.FileSize="",this.Source=null,this.ID="",this.CreationTime=null}function o(){y&&y.length>0&&(y=[]),v&&v.length>0&&(v=[])}var s=function(a,r,o){if(h){var s=new i;a&&(s.EventType=a),t?s.SessionKey=t:s.SessionKey="",r?s.ImageID=r:s.ImageID="",o?s.Value=o:s.Value="",s.EventTime=e.Utils.getCurrentDateTime(),s.InstanceID=n,s.ID=e.Utils.guid(),v&&v.push(s)}},l=function(i,n,o,s){if(h){var l=new r;t?l.SessionKey=t:l.SessionKey="",a?l.EnvironmentID=a:l.EnvironmentID="",o?l.StoragePath=o:l.StoragePath="",l.DocumentID="",s?l.FileSize=s:l.FileSize="",n?l.Source=n:l.Source="",i?l.ID=i:l.ID="",l.CreationTime=e.Utils.getCurrentDateTime(),y&&y.push(l)}},c=function(t,i,a){h&&(t===e.Hints.FILL_AREA?s("FILL_AREA",i,1):t===e.Hints.ZOOM_IN?s("ZOOM_IN",i,1):t===e.Hints.ZOOM_OUT?s("ZOOM_OUT",i,1):t===e.Hints.CENTER?s("CENTER",i,1):t===e.Hints.ROTATE?s("ROTATE",i,1):t===e.Hints.HOLD_LEVEL?s("HOLD_LEVEL",i,1):t===e.Hints.HOLD_STEADY?s("HOLD_STEADY",i,1):t===e.Hints.CAPTURE_OK&&s("CAPTURE_OK",i,1))};return{logCaptureGuidanceEvents:c,logAppStats:s,logImageObject:l,cleanUpData:o}}(),e.LogisticsEventAppStats=function(){"use strict";function t(){this.IsValid="",this.ErrorDescription="",this.FormattingFailed=null,this.SessionEventID="",this.DocumentID="",this.FieldName="",this.EventTime="",this.ID="",this.OriginalValue="",this.Confidence=null,this.ChangedValue=""}function i(){g&&g.length>0&&(g=[])}var a=function(i){if(h&&(e.Utils.validateOptions(i,{IsValid:{type:"number",mandatory:!0,min:{value:0,include:!0},max:{value:1,include:!0}},ErrorDescription:{type:"string",mandatory:!1},DocumentID:{type:"string",mandatory:!0},FieldName:{type:"string",mandatory:!0},OriginalValue:{type:"string",mandatory:!0},Confidence:{type:"number",mandatory:!0,min:{value:0,include:!0},max:{value:100,include:!0}},ChangedValue:{type:"string",mandatory:!0}}),i)){var a=new t;a.IsValid=i.IsValid,i.ErrorDescription?a.ErrorDescription=i.ErrorDescription:a.ErrorDescription="",a.FormattingFailed="",f?a.SessionEventID=f:a.SessionEventID="",i.DocumentID?a.DocumentID=i.DocumentID:a.DocumentID="",i.FieldName?a.FieldName=i.FieldName:a.FieldName="",a.EventTime=e.Utils.getCurrentDateTime(),a.ID=e.Utils.guid(),i.OriginalValue?a.OriginalValue=i.OriginalValue:a.OriginalValue="",
a.Confidence=i.Confidence,i.ChangedValue?a.ChangedValue=i.ChangedValue:a.ChangedValue="",g&&g.push(a)}};return{logAppStats:a,cleanUpData:i}}(),e.ProcessEventAppStats=function(){"use strict";function i(){this.StartTime=null,this.ProcessingProfile="",this.SessionKey=null,this.StopTime=null,this.ResultCode="",this.ProcessedImageID="",this.InstanceID="",this.ID="",this.SourceImageID=""}function a(){b&&b.length>0&&(b=[])}var n=function(t){h&&(e.AppStats.prepareInstance(T.PROCESS),t===C.BITONAL?s=e.Utils.getCurrentDateTime():t===C.AUTOCROP?l=e.Utils.getCurrentDateTime():t===C.SETDPI?c=e.Utils.getCurrentDateTime():t===C.SCALE&&(u=e.Utils.getCurrentDateTime()))},r=function(a){if(h&&(e.CaptureEventAppStats.logImageObject("","Image",""),a)){var n=new i;a.ProcessingProfile===C.BITONAL?n.StartTime=s:a.ProcessingProfile===C.AUTOCROP?n.StartTime=l:a.ProcessingProfile===C.SETDPI?n.StartTime=c:a.ProcessingProfile===C.SCALE&&(n.StartTime=u),a.ProcessingProfile?n.ProcessingProfile=a.ProcessingProfile:n.ProcessingProfile="",t?n.SessionKey=t:n.SessionKey="",n.StopTime=e.Utils.getCurrentDateTime(),a.ResultCode?n.ResultCode=a.ResultCode:n.ResultCode="",a.ProcessedImageID?n.ProcessedImageID=a.ProcessedImageID:n.ProcessedImageID="",n.InstanceID=o,a.SourceImageID?n.SourceImageID=a.SourceImageID:n.SourceImageID="",n.ID=e.Utils.guid(),b&&b.push(n)}};return{ImageProcessorEventJSON:i,logProcessStartTime:n,logAppStats:r,cleanUpData:a}}(),e.SelfieCaptureEventAppStats=function(){"use strict";function i(){this.EventType=null,this.SessionKey=null,this.ImageID=null,this.Value="",this.EventTime="",this.InstanceID="",this.ID=""}function n(){this.SessionKey="",this.EnvironmentID="",this.StoragePath="",this.DocumentID=null,this.FileSize="",this.Source=null,this.ID="",this.CreationTime=null}function o(){w&&w.length>0&&(w=[]),S&&S.length>0&&(S=[])}var s=function(a,n,o){if(h){var s=new i;a&&(s.EventType=a),t?s.SessionKey=t:s.SessionKey="",n?s.ImageID=n:s.ImageID="",o?s.Value=o:s.Value="",s.EventTime=e.Utils.getCurrentDateTime(),s.InstanceID=r,s.ID=e.Utils.guid(),v&&S.push(s)}},l=function(i,r,o,s){if(h){var l=new n;t?l.SessionKey=t:l.SessionKey="",a?l.EnvironmentID=a:l.EnvironmentID="",o?l.StoragePath=o:l.StoragePath="",l.DocumentID="",s?l.FileSize=s:l.FileSize="",r?l.Source=r:l.Source="",i?l.ID=i:l.ID="",l.CreationTime=e.Utils.getCurrentDateTime(),w&&w.push(l)}},c=function(t,i,a){h&&(t===e.Hints.CENTER_FACE?s("CENTER_FACE",i,1):t===e.Hints.BLINK_NOW?s("BLINK_NOW",i,1):t===e.Hints.HOLD_STEADY?s("HOLD_STEADY",i,1):t===e.Hints.CAPTURE_OK&&s("CAPTURE_OK",i,1))};return{logSelfieCaptureGuidanceEvents:c,logAppStats:s,logImageObject:l,cleanUpData:o}}(),function(){function t(){this.state=r}var i="STATE_CREATED",a="STATE_STARTED",n="STATE_STOPPED",r="STATE_DESTROYED",o={create:[r],setOptions:[i,n],forceTakePicture:[a],forceTakeSelfie:[a],choosePictureAsBase64:[i,n],takePicture:[i,n],takeSelfie:[i,n],stopCapture:[a],destroy:[i,n]};t.prototype.setCreatedState=function(){this.state=i},t.prototype.setStartedState=function(){this.state=a},t.prototype.setStoppedState=function(){this.state=n},t.prototype.setDestroyedState=function(){this.state=r},t.prototype.checkAction=function(t){if(o[t].indexOf(this.state)<0)throw new e.StateError("Call "+t+" is not allowed in state "+this.state)},e.StateManager=t}(),function(){"use strict";function t(e){this._image=e}function i(){}function a(){this._alphaExtractor=new i}function n(e){this._image=e,this._alphaExtractor=new i,this._sizeCalculator=new r(e)}function r(e){this._image=e,this._alphaExtractor=new i,this._width=null,this._height=null}function o(e){this._blob=e,this._subsamplingDetector=new a}var s=window.URL||window.webkitURL;t.prototype.draw=function(e,t,i){e.drawImage(this._image,0,0,t,i)},t.prototype.naturalWidth=function(){return this._image.naturalWidth},t.prototype.naturalHeight=function(){return this._image.naturalHeight},i.prototype.extract=function(e,t,i,a,n){var r=document.createElement("canvas");r.width=a,r.height=n;var o=r.getContext("2d");o.drawImage(e,-t,-i);for(var s=o.getImageData(0,0,r.width,r.height),l=s.data,c=new Uint8ClampedArray(a*n),u=3,f=0;u<l.length;u+=4,f+=1)c[f]=l[u];return o.clearRect(0,0,r.width,r.height),o=null,r=null,c},a.prototype.isSubsampled=function(e,t){if(!this._isIos())return!1;if("image/jpeg"!==t)return!1;var i=this._alphaExtractor,a=e.naturalWidth,n=e.naturalHeight;if(a*n<=1048576)return!1;var r=i.extract(e,a-1,n-1,1,1);return 0===r[0]},a.prototype._isIos=function(){return window.navigator&&window.navigator.platform&&/iP(hone|od|ad)/.test(window.navigator.platform)},n.prototype.hasData=function(){var e=this._alphaExtractor.extract(this._image,0,0,1,1);return e[0]>0},n.prototype.width=function(){return this._sizeCalculator.width()},n.prototype.height=function(){return this._sizeCalculator.height()},n.prototype.scale=function(){var e=this.width()/this._image.naturalWidth,t=this.height()/this._image.naturalHeight;return Math.min(e,t)},n.prototype.naturalWidth=function(){return this._image.naturalWidth*this.scale()},n.prototype.naturalHeight=function(){return this._image.naturalHeight*this.scale()},n.prototype.draw=function(e){e.drawImage(this._image,0,0,this.width(),this.height(),0,0,this.naturalWidth(),this.naturalHeight())},r.prototype.width=function(){if(null===this._width){var e=this._alpha(0,0,this._image.width,1);this._width=this._size(e)}return this._width},r.prototype.height=function(){if(null===this._height){var e=this._alpha(0,0,1,this._image.height);this._height=this._size(e)}return this._height},r.prototype._size=function(e){for(var t=e.length-1;t>=0;t-=1)if(0!==e[t])return t+1;return 0},r.prototype._alpha=function(e,t,i,a){return this._alphaExtractor.extract(this._image,e,t,i,a)},o.prototype._urlUsingFileReader=function(e,t){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.onerror=function(e){t(e.target.error)},i.readAsDataURL(this._blob)},o.prototype._url=function(e,t){return s?e(s.createObjectURL(this._blob)):this._urlUsingFileReader(e,t)},o.prototype._revokeUrl=function(e){s&&s.revokeObjectURL(e)},o.prototype._exifData=function(e,t){var i=this._blob;EXIF.getData(i,function(){var t=i.exifdata;e(t)})},o.prototype._image=function(e,t){function i(i){var n=new Image;n.onload=function(){a._revokeUrl(i),e(n)},n.enerror=function(){var e=new Error("Unable to load image");t(e)},n.src=i}var a=this;this._url(i,t)},o.prototype.imageData=function(i,a){function r(a,r){var l=s.isSubsampled(a,o.type);a=l?new n(a):new t(a);var c=document.createElement("canvas"),u=c.getContext("2d"),f=a.naturalWidth(),h=a.naturalHeight();if(a.naturalWidth()>1920){var d=a.naturalWidth()/a.naturalHeight();f=1920,h=f/d}e.EXIF.transformCoordinate(c,u,f,h,r),a.draw(u,f,h);var p=u.getImageData(0,0,c.width,c.height);return u.clearRect(0,0,c.width,c.height),u=null,c=null,i(p)}var o=this._blob,s=this._subsamplingDetector,l=this;l._exifData(function(e){var t=e.Orientation;l._image(function(e){r(e,t)},a)},a)},e.BlobConverter=o}(),e.CaptureFallback=function(){"use strict";function t(t,i,a){(l||"STATE_STOPPED"===c.state)&&n(),c.checkAction("create"),o=document.createElement("input"),o.setAttribute("accept","image/*"),"camera"===t.preference&&o.setAttribute("capture",t.preference),o.setAttribute("type","file"),s=new e.FileInputCapture(o),c.setCreatedState(),i()}function i(e,t){function i(){r(),e.apply(this,arguments)}function a(){r(),t.apply(this,arguments)}l&&r(),c.checkAction("takePicture"),l=!0,s.start(i,a),c.setStartedState(),o.click()}function a(e,t){l&&r(),c.checkAction("choosePictureAsBase64"),s.setBase64Format(),i(e,t)}function n(){l&&r(),c.checkAction("destroy"),null!==s&&(s=null),o=null,c.setDestroyedState()}function r(){c.checkAction("stopCapture"),s.stop(),l=!1,c.setStoppedState()}var o=null,s=null,l=!1,c=new e.StateManager;return{configure:t,choosePicture:i,choosePictureAsBase64:a,destroy:n}}(),function(){"use strict";function t(){var t=e.Utils.createElement("div","kfx-layout kfx-capture"),n=new i;t.appendChild(n.element);var r=new a;t.appendChild(r.element),this.element=t,this.videoView=n,this.canvas=n.canvas,this.video=n.video,this.toolbarView=r}function i(){var e=document.createElement("div");e.className="kfx-content";var t=document.createElement("div"),i=document.createElement("video");i.setAttribute("playsinline",!0),t.appendChild(i);var a=document.createElement("canvas");t.appendChild(a),e.appendChild(t),this.element=e,this.canvas=a,this.video=i}function a(){function t(e){var t=i("button","kfx-button "+e),a=i("div","kfx-icon");return t.appendChild(a),t}var i=e.Utils.createElement,a=i("div","kfx-toolbar kfx-invisible"),n=t("kfx-force-capture");a.appendChild(n);var r=t("kfx-gallery");a.appendChild(r);var o=i("input","kfx-hidden");o.type="file",o.accept="image/*",r.addEventListener("click",function(){var e=new MouseEvent("click",{});o.dispatchEvent(e)}),a.appendChild(o),this.element=a,this.forceCaptureButton=n,this.forceCaptureTimeoutId=null,this.galleryButton=r,this.galleryInput=o}t.prototype.resize=function(){this.videoView.resize()},t.prototype.stop=function(e){this.stopToolbar()},t.prototype.startToolbar=function(e){this.toolbarView.start(e)},t.prototype.stopToolbar=function(e){this.toolbarView.stop()},t.prototype.enableToolbar=function(){this.toolbarView.enable()},t.prototype.disableToolbar=function(){this.toolbarView.disable()},i.prototype.resize=function(){var e=this.element.clientWidth,t=this.element.clientHeight;if(0!==e&&0!==t){var i=this.video.videoWidth,a=this.video.videoHeight;if(0===i||0===a)return this.canvas.width=e,this.canvas.height=t,this.video.width=e,void(this.video.height=t);var n=e/i,r=t/a,o=Math.min(n,r),s=i*o|0,l=a*o|0;this.canvas.width===s&&this.canvas.height===l||(this.canvas.width=s,this.canvas.height=l,this.video.width=s,this.video.height=l)}},a.prototype.start=function(t){this.setUpForceCapture(t.forceCapture),e.Utils.toggleElement(this.galleryButton,t.gallery),this.enable()},a.prototype.stop=function(e){this.disable(),clearTimeout(this.forceCaptureTimeoutId),this.forceCaptureTimeoutId=null},a.prototype.enable=function(){e.Utils.toggleClass(this.element,"kfx-invisible",!1)},a.prototype.disable=function(){e.Utils.toggleClass(this.element,"kfx-invisible",!0)},a.prototype.setUpForceCapture=function(e){var t=this.enableForceCaptureButton.bind(this),i="number"==typeof e&&e,a=e===!0||0===i;t(a),i&&(this.forceCaptureTimeoutId=setTimeout(t,1e3*i))},a.prototype.enableForceCaptureButton=function(t){t="undefined"==typeof t||t,e.Utils.toggleElement(this.forceCaptureButton,t)},e.CaptureView=t}(),function(){"use strict";function t(e){function t(e){(!e||e.angle>i)&&(s=!1,n())}function a(){s=!0,o.addListener(t)}function n(){s=!1,o.removeListener(t)}function r(){return s}var o=e,s=!1;this.start=a,this.stop=n,this.isNeeded=r}var i=45;e.ContinuousCaptureReset=t}(),function(){"use strict";function t(t){function i(){f||(f=!0,e.Utils.notifyListeners(c))}function a(){f&&(f=!1,e.Utils.notifyListeners(u))}function n(e){c.push(e)}function r(e){u.push(e)}function o(){t.addEventListener("click",i),t.addEventListener("change",a),document.body.addEventListener("focus",a,!0),f=!1}function s(){t.removeEventListener("click",i),t.removeEventListener("change",a),document.body.removeEventListener("focus",a,!0)}function l(){f=!1}var c=[],u=[],f=!1;this.onOpen=n,this.onClose=r,this.start=o,this.stop=s,this.resetIsOpen=l}function i(i){function a(e){var t=e.target,i=t.files;i.length&&(n(i[0]),t.value="")}function n(t){if(0===t.size)return void alert("Image chosen is not valid");if(p){var i=new FileReader;i.onload=function(e){var t=e.target.result,i=t.replace(/^data:image\/(jpeg|png|jpg);base64,/,"");return f(i)},i.readAsDataURL(t)}else new e.BlobConverter(t).imageData(function(t){t.id=e.Utils.guid(),e.CaptureEventAppStats.logImageObject(t.id,"Image","",t.data.length),e.CaptureEventAppStats.logAppStats("Image Captured",t.id,1),f(t)},h)}function r(e,t){f=e,h=t,i.addEventListener("change",a),d.start()}function o(){f=null,h=null,i.removeEventListener("change",a),d.stop()}function s(e){d.onOpen(e)}function l(e){d.onClose(e)}function c(){p=!0}function u(){d.resetIsOpen()}var f=null,h=null,d=new t(i),p=!1;if("input"!==i.tagName.toLowerCase())throw new Error("Wrong element. Expected input, got "+i.tagName);this.start=r,this.stop=o,this.setBase64Format=c,this.onDialogOpen=s,this.onDialogClose=l,this.resetOpenState=u}e.FileInputCapture=i}(),function(){"use strict";function t(){}t.prototype.start=function(){},t.prototype.stop=function(){},t.prototype.isNeeded=function(){return!1},e.NoOpContinuousCaptureReset=t}(),e.SelfieCapture=function(){"use strict";function t(t,i){var a=K("lbpcascade_frontalface.xml"),n=K("haarcascade_eye.xml");e.Utils.createFileFromUrl("lbpcascade_face.xml",a,function(){e.Utils.createFileFromUrl("haarcascade_eye.xml",n,function(){$=!0,L=new cv.CascadeClassifier,O=new cv.CascadeClassifier,L.load("lbpcascade_face.xml"),O.load("haarcascade_eye.xml"),t()},function(){$=!1,i(new e.SelfieCaptureError("There was an issue while loading models. Please try again."))})},function(){$=!1,i(new e.SelfieCaptureError("There was an issue while loading models. Please try again."))})}function i(){Q.resize();var t=Q.canvas.width,i=Q.canvas.height;D===t&&M===i||(D=t,M=i,_=new e.SelfieFrame(D,M,q),z=new e.BlinkDetector(_),z.classifier=L,z.eyeCascade=O,N.configure(_,z,q,function(){}))}function a(t){if(x=void 0,q.enableAutoCapture===!1){var i=Object.create(q);i.framePadding=q.framePadding+15,_=new e.SelfieFrame(D,M,void 0===V?q:i)}else _=new e.SelfieFrame(D,M,q);z=new e.BlinkDetector(_),z.classifier=L,z.eyeCascade=O;var a=function(){if(t){var i=function(){I=void 0,k()},a=function(t){e.report(G,new e.UserMediaError(t))};oe=new e.UserMediaManager(b),oe.configureForSelfie(i,a)}};N.configure(_,z,q,a)}function n(){if(I=compatibility.requestAnimationFrame(n),b.readyState===b.HAVE_ENOUGH_DATA&&void 0===j){if(i(),T.clearRect(0,0,C.width,C.height),ne)return T.drawImage(b,0,0,D,M),r(),void w();if(!U){if(ae.isNeeded())return void r();"none"===b.style.display&&(b.style.display="block");try{var t=z.findFaceRectangle(b);if(e.SelfieGuidance.processRectangle(t[0]),o(),q.showEdges){A.width!==C.width&&(A.width=C.width,A.height=C.height,E.translate(A.width,0),E.scale(-1,1)),E.clearRect(0,0,A.width,A.height);for(var a=0;a<t.length;a++){var s=t[a];E.beginPath(),E.strokeStyle=q.edgesColor,E.lineWidth=q.edgesWidth,E.moveTo(s[0][0],s[0][1]);for(var l=1;l<s.length;l++)E.lineTo(s[l][0],s[l][1]);E.closePath(),E.stroke()}T.drawImage(A,0,0,C.width,C.height)}}catch(c){N.resetBlinkDetection(!1),e.SelfieGuidance.processGuidance(e.SelfieHints.CENTER_FACE),o()}}}}function r(){_.draw(T,x,N.delay(),N.currentHint())}function o(){r(),N.draw(T,x,R)}function s(t,i){try{pe(t,i)}catch(a){e.report(i,a)}}function l(e,t){if(null===ie)q.enableAutoCapture===!1?t(V,W):t(e);else{var i=function(){if(q.enableAutoCapture===!1)if(ie.toolbarView.acceptButton.classList.contains("kfx-next")){var i=ie.canvas.getContext("2d");i.putImageData(W,0,0)}else t(V,W);else t(e)},n=function(){V=void 0,W=void 0,U=!1,N.resetBlinkDetection(!1),ae.stop(),q.enableAutoCapture===!1&&a(!1)};q.enableAutoCapture===!1?(ie.toolbarView.acceptButton.classList.add("kfx-next"),ie.review(V,i,n)):ie.review(e,i,n)}}function c(t){e.Utils.validateOptions(t,Z),void 0!==t.lookAndFeel&&e.Utils.validateOptions(t.lookAndFeel,Z)}function u(){return e.Utils.getOptions(q)}function f(){return e.Utils.getOptions(Y)}function h(t,i){c(t),void 0!==t.criteria&&e.SelfieGuidance.setOptions(t.criteria),e.Utils.setOptions(q,t,Y),a(i)}function d(e){e.enableAutoCapture===!1&&(Q.element.classList.add("kfx-disableac"),Q.element.removeChild(Q.toolbarView.element)),h(e,!1)}function p(){e.Utils.resetOptions(q,Y)}function m(){return te.checkAction("setOptions")}function g(){ne=!0,b.pause(),q.enableAutoCapture!==!0&&void 0!==q.enableAutoCapture||Q.disableToolbar()}function v(){ne=!1,b.play(),q.enableAutoCapture!==!0&&void 0!==q.enableAutoCapture||Q.enableToolbar()}function S(){if(ne)return void v()}function y(){q.enableAutoCapture===!1&&x===e.SelfieHints.BLINK_NOW&&(e.SelfieCaptureEventAppStats.logAppStats(P.FORCE_TAKE_SELFIE,"",1),s(B,H))}function w(){var e="Capture is Paused.",t="Tap to Continue.";try{T.save(),T.font=R.join(" "),T.fillStyle="white";var i=T.measureText(e),a=D-i.width>>1,n=M>>1;T.fillText(e,a,n),i=T.measureText(t),a=D-i.width>>1,T.fillText(t,a,n+24)}finally{T.restore()}}var b,C,T,A,E,I,_,x,D,M,L,R,O,k,G,F,U,j,N,B,H,V,W,z,K=e.Utils.getModelsUrl,X=e.Utils.getLibsUrl,q={frameAspectRatio:0,framePadding:10,frameThickness:10,frameColor:"#FF0000",outOfFrameColor:"#FFFFFF",outOfFrameTransparency:1,showEdges:!1,edgesColor:"#FFFF00",preview:!1,edgesWidth:4,guidanceSize:150,guidanceTransparency:.5,enableAutoCapture:!0,lookAndFeel:{forceCapture:10}},Y={frameAspectRatio:0,framePadding:10,frameThickness:10,frameColor:"#FF0000",outOfFrameColor:"#FFFFFF",outOfFrameTransparency:1,showEdges:!1,edgesColor:"#FFFF00",preview:!1,edgesWidth:4,guidanceSize:150,guidanceTransparency:.5,enableAutoCapture:!0,lookAndFeel:{forceCapture:10}},Z={frameAspectRatio:{type:"number",min:{value:0,include:!0}},framePadding:{type:"number",min:{value:0,include:!0},max:{value:49,include:!0}},frameThickness:{type:"number",min:{value:0,include:!0}},frameColor:{type:["string","object"],color:!0},outOfFrameColor:{type:["string","object"],color:!0},outOfFrameTransparency:{type:"number",min:{value:0,include:!0},max:{value:1,include:!0}},guidanceTransparency:{type:"number",min:{value:0,include:!0},max:{value:1,include:!0}},showEdges:{type:"boolean"},enableAutoCapture:{type:"boolean"},preview:{type:"boolean"},edgesColor:{type:["string","object"],color:!0},edgesWidth:{type:"number",min:{value:0,include:!1}},guidanceSize:{type:"number",min:{value:100,include:!0}},forceCapture:{type:["boolean","number"],min:{value:0,include:!0}}},J=null,Q=null,$=!1,ee=new e.AutoLoadAudio,te=new e.StateManager,ie=null,ae=null,ne=!1,re=!1,oe=null,se=function(t,i,a){try{if(!$)return void a(new e.SelfieCaptureError("Models were not loaded"));te.checkAction("create"),J=document.getElementById(t.containerId),Q=new e.SelfieCaptureView,J.appendChild(Q.element),Q.resize(),b=Q.video,D=b.width,M=b.height,C=Q.canvas,T=C.getContext("2d"),re=!1,ne=!1;var n=getComputedStyle(J);R=[n.getPropertyValue("font-size"),n.getPropertyValue("font-family")],A=document.createElement("canvas"),E=A.getContext("2d"),k=function(){te.setCreatedState(),i()},G=function(e){de(),a(e)},C.addEventListener("click",S),C.addEventListener("touchend",S),Q.element.addEventListener("click",y),Q.element.addEventListener("touchend",y),N=e.SelfieGuidance,ie=t.preview===!0?new KfxWebSDK.ReviewControl(t.containerId):null,h(t,!0),t.enableAutoCapture===!1&&(Q.element.classList.add("kfx-disableac"),Q.element.removeChild(Q.toolbarView.element)),e.Visibility.addListener(function(){e.Visibility.status()?re&&e.Utils.isIOSDevice()&&(T.clearRect(0,0,C.width,C.height),re=!1):e.Utils.isIOSDevice()&&te&&"STATE_STARTED"===te.state&&(re=!0,g())})}catch(r){de(),a(r)}},le=function(i,a,n){if(void 0!==n&&null!==n&&"boolean"!=typeof n)throw new Error("Parameter loadOpenCVAsWebAssembly is not boolean type");if($)return void i();void 0!==n&&null!==n||(n=!1);var r=X("OpenCV_JS/opencv.js");n&&(Module={wasmBinaryFile:X("OpenCV_WASM/opencv_js.wasm"),preRun:[function(){t(i,a)}]},r=X("OpenCV_WASM/opencv.js"));var o=document.getElementsByTagName("head")[0],s=document.createElement("script");s.onload=function(){n||t(i,a)},s.onerror=function(){a(new e.SelfieCaptureError("There was an issue while loading opencv. Please try again."))},s.type="text/javascript",s.src=r,o.appendChild(s)},ce=function(t,i){if(te.checkAction("takeSelfie"),U=!1,x=void 0,B=t,H=i,V=void 0,W=void 0,q.enableAutoCapture===!0||void 0===q.enableAutoCapture){var a=q.lookAndFeel;Q.startToolbar(a),F=function(){e.SelfieCaptureEventAppStats.logAppStats(P.FORCE_TAKE_SELFIE,"",1),s(t,i)},Q.toolbarView.forceCaptureButton.addEventListener("click",F)}ae=new e.NoOpContinuousCaptureReset,N.start(function(a){x=a,x===e.SelfieHints.CAPTURE_OK&&(s(t,i),U=!0)}),void 0===I&&(b.style.display="none",b.play(),I=compatibility.requestAnimationFrame(n)),te.setStartedState()},ue=function(e,t){te.checkAction("stopCapture"),fe(),te.setStoppedState(),e()},fe=function(){null!==ie&&ie.isActive&&ie.toolbarView.retakeButton.click(),Q&&(Q.stop(),Q.toolbarView.forceCaptureButton.removeEventListener("click",F)),x=void 0,V=void 0,W=void 0,ae&&ae.stop(),ae=null,void 0!==j&&clearTimeout(j),F=void 0,N&&N.stop(),I&&compatibility.cancelAnimationFrame(I),b&&b.pause(),I=void 0},he=function(e){e!==!0&&te.checkAction("destroy"),"STATE_DESTROYED"!==te.state&&(fe(),de(),te.setDestroyedState())},de=function(){z&&(z.dsContext.clearRect(0,0,z.width,z.height),z.dsContext=null),C.removeEventListener("click",S),C.removeEventListener("touchend",S),Q.element.removeEventListener("click",y),Q.element.removeEventListener("touchend",y),q.enableAutoCapture===!1&&(Q.element.classList.remove("kfx-disableac"),Q.element.appendChild(Q.toolbarView.element)),e.Visibility.removeListener(),T.clearRect(0,0,C.width,C.height),T=null,C=null,E.clearRect(0,0,A.width,A.height),E=null,A=null,Q&&(Q.canvas=null,Q.videoView.element=null,Q.videoView=null),Q=null,ie=null,_=null,e.Utils.removeAllChildren(J),J=null,oe&&oe.destroy(),oe=null,z=null,N&&N.clearCanvases(),N=null},pe=function(t,i){function n(){var e=b.videoWidth,t=b.videoHeight,i=document.createElement("canvas");i.width=e,i.height=t;var a=i.getContext("2d");a.drawImage(b,0,0);var n=[0,0,e,t],r=a.getImageData.apply(a,n);return a.clearRect(0,0,i.width,i.height),a=null,i=null,r}if(te.checkAction("forceTakeSelfie"),ne)throw new e.SelfieCaptureError("Selfie Capture is paused");if(b.readyState!==b.HAVE_ENOUGH_DATA)throw new e.SelfieCaptureError("Video is not ready, state = "+b.readyState);if(null!==ie&&ie.isActive)throw new e.StateError("Call forceTakeSelfie is not allowed during REVIEW");ee.playShutterSound();var r=n();j=setTimeout(function(){x=void 0,j=void 0,ee.pauseShutterSound(),N.clearGuidance(),r.id=e.Utils.guid(),e.SelfieCaptureEventAppStats.logImageObject(r.id,"Selfie Image","",r.data.length),e.SelfieCaptureEventAppStats.logAppStats("Selfie Image Captured",r.id,1),q.enableAutoCapture===!1?void 0===V?(V=r,a(!1)):(W=r,ae.start(),l(r,t)):(ae.start(),l(r,t))},1e3),x=e.SelfieHints.CAPTURE_OK,T.clearRect(0,0,C.width,C.height),o()};return{configure:se,start:ce,stop:ue,capture:pe,destroy:he,getOptions:u,getDefaultOptions:f,setOptions:d,resetOptions:p,checkSetOptionsAllowed:m,loadModels:le}}(),e.SelfieCaptureFallback=function(){"use strict";function t(t,i,n){(s||"STATE_STOPPED"===l.state)&&a(),l.checkAction("create"),r=document.createElement("input"),r.setAttribute("accept","image/*"),r.setAttribute("capture","user"),r.setAttribute("type","file"),o=new e.FileInputCapture(r),l.setCreatedState(),i()}function i(e,t){function i(){n(),e.apply(this,arguments)}function a(){n(),t.apply(this,arguments)}s&&n(),l.checkAction("takeSelfie"),s=!0,o.start(i,a),l.setStartedState(),r.click()}function a(){s&&n(),l.checkAction("destroy"),null!==o&&(o=null),r=null,l.setDestroyedState()}function n(){l.checkAction("stopCapture"),o.stop(),s=!1,l.setStoppedState()}var r=null,o=null,s=!1,l=new e.StateManager;return{configure:t,choosePicture:i,destroy:a}}(),function(){"use strict";function t(){var t=e.Utils.createElement("div","kfx-layout kfx-capture"),n=new i;t.appendChild(n.element);var r=new a;t.appendChild(r.element),this.element=t,this.videoView=n,this.canvas=n.canvas,this.video=n.video,this.toolbarView=r}function i(){var e=document.createElement("div");e.className="kfx-content";var t=document.createElement("div"),i=document.createElement("video");i.setAttribute("playsinline",!0),i.setAttribute("id","kfx-selfie-capture-video"),t.appendChild(i);var a=document.createElement("canvas");t.appendChild(a),e.appendChild(t),this.element=e,this.canvas=a,this.video=i}function a(){function t(e){var t=i("button","kfx-button "+e),a=i("div","kfx-icon");return t.appendChild(a),t}var i=e.Utils.createElement,a=i("div","kfx-toolbar kfx-invisible"),n=t("kfx-force-capture");a.appendChild(n),this.element=a,this.forceCaptureButton=n,this.forceCaptureTimeoutId=null}t.prototype.resize=function(){this.videoView.resize()},t.prototype.stop=function(e){this.stopToolbar()},t.prototype.startToolbar=function(e){this.toolbarView.start(e)},t.prototype.stopToolbar=function(e){this.toolbarView.stop()},t.prototype.enableToolbar=function(){this.toolbarView.enable()},t.prototype.disableToolbar=function(){this.toolbarView.disable()},i.prototype.resize=function(){var e=this.element.clientWidth,t=this.element.clientHeight;if(0!==e&&0!==t){var i=this.video.videoWidth,a=this.video.videoHeight;if(0===i||0===a)return this.canvas.width=e,this.canvas.height=t,this.video.width=e,void(this.video.height=t);var n=e/i,r=t/a,o=Math.min(n,r),s=i*o|0,l=a*o|0;this.canvas.width===s&&this.canvas.height===l||(this.canvas.width=s,this.canvas.height=l,this.video.width=s,this.video.height=l)}},a.prototype.start=function(e){this.setUpForceCapture(e.forceCapture),this.enable()},a.prototype.stop=function(e){this.disable(),clearTimeout(this.forceCaptureTimeoutId),this.forceCaptureTimeoutId=null},a.prototype.enable=function(){e.Utils.toggleClass(this.element,"kfx-invisible",!1)},a.prototype.disable=function(){e.Utils.toggleClass(this.element,"kfx-invisible",!0)},a.prototype.setUpForceCapture=function(e){var t=this.enableForceCaptureButton.bind(this),i="number"==typeof e&&e,a=e===!0||0===i;t(a),i&&(this.forceCaptureTimeoutId=setTimeout(t,1e3*i))},a.prototype.enableForceCaptureButton=function(t){t="undefined"==typeof t||t,e.Utils.toggleElement(this.forceCaptureButton,t)},e.SelfieCaptureView=t}(),e.WebCapture=function(){"use strict";function t(){V.resize();var t=V.canvas.width,i=V.canvas.height;_===t&&x===i||(_=t,x=i,E=new e.Frame(_,x,j),F=new e.EdgeDetector(E),G.configure(E,F.dsFactor,j,function(){}))}function i(t){I=void 0,E=new e.Frame(_,x,j),F=new e.EdgeDetector(E);var i=function(){if(t){var i=function(){P=void 0,D()},a=function(t){e.report(M,new e.UserMediaError(t))};$=new e.UserMediaManager(b),$.configure(i,a)}};G.configure(E,F.dsFactor,j,i)}function a(){if(P=compatibility.requestAnimationFrame(a),b.readyState===b.HAVE_ENOUGH_DATA&&void 0===k){if(t(),e.Utils.isIOSDevice()?T.clearRect(0,0,C.width,C.height):T.drawImage(b,0,0,_,x),Q)return T.drawImage(b,0,0,_,x),n(),void o();if(R||!O){if(J.isNeeded())return void n();if(K)return n(),void s();try{var i=F.findEdgesRectangle(e.Utils.isIOSDevice()?b:C);if(j.showEdges){T.beginPath(),T.strokeStyle=j.edgesColor,T.lineWidth=j.edgesWidth,T.moveTo(i[0][0],i[0][1]);for(var l=1;l<i.length;l++)T.lineTo(i[l][0],i[l][1]);T.closePath(),T.stroke()}e.Guidance.processRectangle(i)}catch(c){e.Guidance.processGuidance(e.Hints.FILL_AREA)}r()}}}function n(){E.draw(T,I)}function r(){n(),G.draw(T,I)}function o(){var e=getComputedStyle(H),t="Capture is Paused.",i="Tap to Continue.",a=[e.getPropertyValue("font-size"),e.getPropertyValue("font-family")].join(" ");try{T.save(),T.font=a,T.fillStyle="white";var n=T.measureText(t),r=_-n.width>>1,o=x>>1;T.fillText(t,r,o),n=T.measureText(i),r=_-n.width>>1,T.fillText(i,r,o+24)}finally{T.restore()}}function s(){if(K.isExpired())return void(K=null);K.setSize(E.width,E.height);try{T.save(),T.translate(E.mx,E.my),K.draw(T)}finally{T.restore()}}function l(){Q=!0,b.pause(),V.disableToolbar()}function c(){z.resetOpenState(),Q=!1,b.play(),V.enableToolbar()}function u(t,i){try{oe(t,i)}catch(a){e.report(i,a)}}function f(e,t){if(null===Y)t(e);else{var i=function(){t(e)},a=function(){O=!1,J.stop()};Y.review(e,i,a)}}function h(t){e.Utils.validateOptions(t,B),void 0!==t.lookAndFeel&&e.Utils.validateOptions(t.lookAndFeel,B)}function d(){return e.Utils.getOptions(j)}function p(){return e.Utils.getOptions(N)}function m(t,a){h(t),void 0!==t.criteria&&e.Guidance.setOptions(t.criteria),e.Utils.setOptions(j,t,N),i(a)}function g(e){m(e,!1)}function v(){e.Utils.resetOptions(j,N)}function S(){return Q?void c():void(K&&K.isShown()&&(K=null,y()))}function y(){V.startToolbar(j.lookAndFeel)}function w(){return q.checkAction("setOptions")}var b,C,T,P,E,I,_,x,D,M,L,R,O,k,G,F,U=e.Utils.getImageUrl,j={frameAspectRatio:.629,framePadding:5,frameCornerHeight:10,frameCornerWidth:60,frameCornerColor:"#00FF00",outOfFrameTransparency:.5,showEdges:!1,edgesColor:"#FFFF00",edgesWidth:4,guidanceSize:150,useTargetFrameCrop:!1,lookAndFeel:{documentSample:U("demo_dl_front.svg"),forceCapture:10,gallery:!0}},N={frameAspectRatio:.629,framePadding:5,frameCornerHeight:10,frameCornerWidth:60,frameCornerColor:"#00FF00",outOfFrameTransparency:.5,showEdges:!1,edgesColor:"#FFFF00",edgesWidth:4,guidanceSize:150,useTargetFrameCrop:!1,lookAndFeel:{documentSample:U("demo_dl_front.svg"),forceCapture:10,gallery:!0}},B={frameAspectRatio:{type:"number",min:{value:0,include:!0}},framePadding:{type:"number",min:{value:0,include:!0},max:{value:49,include:!0}},frameCornerHeight:{type:"number",min:{value:0,include:!1}},frameCornerWidth:{type:"number",min:{value:0,include:!1}},frameCornerColor:{type:["string","object"],color:!0},outOfFrameTransparency:{type:"number",min:{value:0,include:!0},max:{value:1,include:!0}},showEdges:{type:"boolean"},edgesColor:{type:["string","object"],color:!0},edgesWidth:{type:"number",min:{value:0,include:!1}},guidanceSize:{type:"number",min:{value:100,include:!0}},useTargetFrameCrop:{type:"boolean"},documentSample:{type:["boolean","string"]},forceCapture:{type:["boolean","number"],min:{value:0,include:!0}},gallery:{type:"boolean"}},H=null,V=null,W=!1,z=null,K=null,X=new e.AutoLoadAudio,q=new e.StateManager,Y=null,Z=new e.LevelSensor,J=null,Q=!1,$=null,ee=function(t,i,a){try{q.checkAction("create"),H=document.getElementById(t.containerId),V=new e.CaptureView,H.appendChild(V.element),V.resize(),b=V.video,_=b.width,x=b.height,C=V.canvas,T=C.getContext("2d"),T.fillStyle="rgb(0,255,0)",T.strokeStyle="rgb(0,255,0)",W=!1,D=function(){q.setCreatedState(),i()},M=function(e){re(),a(e)},C.addEventListener("click",S),C.addEventListener("touchend",S),z=new e.FileInputCapture(V.toolbarView.galleryInput),z.onDialogOpen(l),G=e.Guidance,Y=t.preview===!0?new KfxWebSDK.ReviewControl(t.containerId):null,m(t,!0),e.Visibility.addListener(function(){e.Visibility.status()?W&&e.Utils.isIOSDevice()&&(T.clearRect(0,0,C.width,C.height),W=!1):e.Utils.isIOSDevice()&&q&&"STATE_STARTED"===q.state&&(W=!0,l())})}catch(n){re(),a(n)}},te=function(t,i,n){q.checkAction("takePicture"),R=n,O=!1,Q=!1,z.start(t,i),I=void 0;var r=j.lookAndFeel;if(r.documentSample){var o=r.documentSample;o===!0&&(o=N.lookAndFeel.documentSample);var s=getComputedStyle(H),l=[s.getPropertyValue("font-size"),s.getPropertyValue("font-family")].join(" ");K=new e.DocumentSample(o,l,j.frameCornerHeight,6e3),K.setExpireHandler(y)}else K=null,y();J=R?new e.ContinuousCaptureReset(Z):new e.NoOpContinuousCaptureReset,L=function(){e.CaptureEventAppStats.logAppStats(A.FORCE_TAKE_PICTURE,"",1),u(t,i)},V.toolbarView.forceCaptureButton.addEventListener("click",L),G.start(function(a){I=a,I===e.Hints.CAPTURE_OK&&(u(t,i),O=!0)}),void 0===P&&(e.Utils.isIOSDevice()||(b.style.display="none"),b.play(),P=compatibility.requestAnimationFrame(a)),q.setStartedState()},ie=function(e,t){q.checkAction("stopCapture"),ae(),q.setStoppedState(),e()},ae=function(){null!==Y&&Y.isActive&&Y.toolbarView.retakeButton.click(),V&&(V.stop(),V.toolbarView.forceCaptureButton.removeEventListener("click",L)),z&&z.stop(),K=null,I=void 0,J&&J.stop(),J=null,void 0!==k&&clearTimeout(k),L=void 0,G&&G.stop(),P&&compatibility.cancelAnimationFrame(P),b&&b.pause(),P=void 0},ne=function(e){e!==!0&&q.checkAction("destroy"),"STATE_DESTROYED"!==q.state&&(ae(),re(),q.setDestroyedState())},re=function(){F&&(F.dsContext.clearRect(0,0,b.videoWidth,b.videoHeight),F.dsContext=null),F=null,T.clearRect(0,0,C.width,C.height),C.removeEventListener("click",S),C.removeEventListener("touchend",S),T=null,C=null,E=null,z=null,V&&(V.canvas=null,V.videoView.element=null,V.videoView=null),
V=null,K=null,Y=null,e.Visibility.removeListener(),e.Utils.removeAllChildren(H),H=null,$&&$.destroy(),$=null,G&&G.clearCanvases(),G=null},oe=function(t,i){function a(){var e=b.videoWidth,t=b.videoHeight,i=document.createElement("canvas");i.width=e,i.height=t;var a=i.getContext("2d");a.drawImage(b,0,0);var n=j.useTargetFrameCrop?E.getTargetFrameCropData(e,t):[0,0,e,t],r=a.getImageData.apply(a,n);return a.clearRect(0,0,i.width,i.height),a=null,i=null,r}if(q.checkAction("forceTakePicture"),Q)throw new e.CaptureError("Capture is paused");if(b.readyState!==b.HAVE_ENOUGH_DATA)throw new e.CaptureError("Video is not ready, state = "+b.readyState);if(null!==Y&&Y.isActive)throw new e.StateError("Call forceTakePicture is not allowed during REVIEW");X.playShutterSound(),e.Utils.isIOSDevice()||T.drawImage(b,0,0,_,x);var n=a();k=setTimeout(function(){I=void 0,k=void 0,X.pauseShutterSound(),G.clearGuidance(),n.id=e.Utils.guid(),e.CaptureEventAppStats.logImageObject(n.id,"Image","",n.data.length),e.CaptureEventAppStats.logAppStats("Image Captured",n.id,1),f(n,t),J.start()},1e3),I=e.Hints.CAPTURE_OK,e.Utils.isIOSDevice()&&T.clearRect(0,0,C.width,C.height),r()};return{configure:ee,start:te,stop:ie,capture:oe,destroy:ne,getOptions:d,getDefaultOptions:p,setOptions:g,resetOptions:v,checkSetOptionsAllowed:w}}(),function(){"use strict";function t(t){var i=e.GeneralSettings.getSettingsForRealTimeEdgeDetection();e.ImageUtils.checkMinSize(t.screenWidth,t.screenHeight,i.selfieDownscaleSize),this.width=t.screenWidth,this.height=t.screenHeight,this.dsFactor=Math.ceil(Math.sqrt(t.screenSquare/i.selfieDownscaleSize));var a=e.ImageUtils.getScalingData(this.width,this.height,i.selfieDownscaleSize);this.dsFactor=a.scaleFactor,this.dsContext=a.context,this.dsWidth=a.width,this.dsHeight=a.height,this.blinkDetectedListener=null,this.classifier=null,this.eyeCascade=null,this.state=0}t.prototype.findFaceRectangle=function(t){this.dsContext.drawImage(t,0,0,this.width,this.height);var i=this.dsContext.getImageData(0,0,this.dsWidth,this.dsHeight),a=cv.matFromImageData(i),n=new cv.Mat,r=cv.Mat.eye(2,2,cv.CV_32FC1),o=new cv.Point((-1),(-1));cv.filter2D(a,n,cv.CV_8U,r,o,0,cv.BORDER_DEFAULT);var s=new cv.Mat,l=new cv.RectVector,c=new cv.RectVector;cv.cvtColor(n,s,cv.COLOR_RGBA2GRAY,0),this.classifier.detectMultiScale(s,l,1.1,3,0,new cv.Size(0,0),new cv.Size(0,0));var u=[];0==l.size()&&(this.state=0);for(var f=0;f<l.size()&&1==l.size();++f){var h=s.roi(l.get(f)),d=new cv.Point(l.get(f).x,l.get(f).y),p=new cv.Point(l.get(f).x+l.get(f).width,l.get(f).y),m=new cv.Point(l.get(f).x+l.get(f).width,l.get(f).y+l.get(f).height),g=new cv.Point(l.get(f).x,l.get(f).y+l.get(f).height);if(u.push([[d.x,d.y],[p.x,p.y],[m.x,m.y],[g.x,g.y]]),this.blinkDetectedListener){this.eyeCascade.detectMultiScale(h,c);for(var v=0;v<c.size()&&c.size()<=2;++v){var S=new cv.Point(d.x+c.get(v).x,d.y+c.get(v).y),y=new cv.Point(d.x+c.get(v).x+c.get(v).width,d.y+c.get(v).y),w=new cv.Point(d.x+c.get(v).x+c.get(v).width,d.y+c.get(v).y+c.get(v).height),b=new cv.Point(d.x+c.get(v).x,d.y+c.get(v).y+c.get(v).height);u.push([[S.x,S.y],[y.x,y.y],[w.x,w.y],[b.x,b.y]])}switch(this.state){case 0:2==c.size()&&(this.state=1);break;case 1:0==c.size()&&(this.state=2);break;case 2:2==c.size()&&(this.state=0,this.blinkDetectedListener())}}h["delete"]()}a["delete"](),n["delete"](),s["delete"](),l["delete"](),c["delete"]();for(var C=0;C<u.length;C++)u[C]=e.PointUtils.scaleAll(u[C],this.dsFactor);return u},e.BlinkDetector=t}(),function(){"use strict";function t(t,i){var a=e.GeneralSettings.getSettings(i);e.ImageUtils.checkMinSize(t.width,t.height,a.downscaleSize),this.data=t,this.settings=a,this.scaleData=e.ImageUtils.scaleToPixelSize(this.data,this.settings.downscaleSize),this.type=i,this.lines=null,this.imageByteArray=null}t.prototype.getLines=function(){if(null!==this.lines)return this.lines;var t=this.scaleData.imageData,i=e.ImageUtils.getRgbWithBlur(t,this.settings.gaussianBlur),a=i[0],n=i[1],r=i[2],o=a.cols,s=a.rows,l=i[3],c=e.LineExtractor.process,u=e.ImageUtils.adaptiveCanny,f=u(a);return c(f,o,s,this.settings,l),f=u(n),c(f,o,s,this.settings,l),f=u(r),c(f,o,s,this.settings,l),this.had=e.Hough.getAccumulator(l,o,s),this.lines=e.Hough.getLinesStandard(l,o,s,this.settings.houghThreshold,this.settings.houghLinesMax,this.had),this.imageByteArray=l,this.lines},t.prototype.process=function(){var t=this.getLines(),i=this.scaleData.imageData,a=this.scaleData.scaleFactor,n=i.width,r=i.height,o=new e.TetragonFinder(this.imageByteArray,n,r,this.type,this.had),s=o.find(t);if(this.settings.boundingCrop){var l=void 0===s?e.ImageUtils.getBound(this.imageByteArray,n,r):e.PointUtils.getBound([s.p1,s.p2,s.p3,s.p4]);l=e.PointUtils.scaleAll(l,a);var c=this.settings.boundingPadding,u=e.ImageUtils.getROICropData(this.data.width,this.data.height,l,c),f=e.ImageUtils.convertImageDataToCanvas(this.data),h=f.getContext("2d");return h.getImageData.apply(h,u)}if(void 0===s)throw Error("No document sides found");var d,p=new e.TetragonAligner(n,r),m=p.process(s);return d=m.getPerspectiveFraction()<this.settings.perspectiveThreshold?e.Deskew.process(this.data,m.getRectangleInterpolation(a)):e.Perspective.transform(this.data,m,a,this.type)},e.CannyDetector=t}(),e.Deskew=function(){"use strict";function t(t,a){var n=(t.width,t.height,new e.Rectangle(a)),r=e.ImageUtils.convertImageDataToCanvas(t).getContext("2d"),o=Math.abs,s=-n.radians,l=o(180*s/Math.PI);if(l>i){var c=Math.ceil(n.getRadius()),u=n.mx-c,f=n.my-c,h=2*c,d=e.ImageUtils.createEmptyCanvas(h,h);d.getContext("2d").putImageData(t,-u,-f);var p=e.ImageUtils.createEmptyCanvas(h,h).getContext("2d");p.translate(c,c),p.rotate(s),p.translate(-c,-c),p.drawImage(d,0,0,h,h),r=p,n=n.rotate(s).shift(-u,-f)}var m=e.PointUtils.getBound(n.rectangle),g=e.ImageUtils.getROICropData(r.canvas.width,r.canvas.height,m,0);return r.getImageData.apply(r,g)}var i=.49;return{process:t}}(),function(){"use strict";function t(t){var i=e.GeneralSettings.getSettingsForRealTimeEdgeDetection();e.ImageUtils.checkMinSize(t.screenWidth,t.screenHeight,i.downscaleSize),this.width=t.screenWidth,this.height=t.screenHeight,this.contourRadius=i.contourRadius,this.gaussianBlurValue=i.gaussianBlurValue,this.sobelThreshold=i.sobelThreshold,this.dsFactor=Math.ceil(Math.sqrt(t.screenSquare/i.downscaleSize));var a=e.ImageUtils.getScalingData(this.width,this.height,i.downscaleSize);this.dsFactor=a.scaleFactor,this.dsContext=a.context,this.dsWidth=a.width,this.dsHeight=a.height,this.contourFinder=new e.ContourFinder(this.dsWidth,this.dsHeight,this.contourRadius),this.sobelManager=new e.Sobel(this.dsWidth,this.dsHeight,this.gaussianBlurValue,this.sobelThreshold,this.sobelMaxExpositionThreshold)}t.prototype.findEdgesRectangle=function(t){this.dsContext.drawImage(t,0,0,this.width,this.height);var i=this.dsContext.getImageData(0,0,this.dsWidth,this.dsHeight),a=this.sobelManager.process(i),n=this.contourFinder.find(a);if(void 0===n||n.length<3)throw new Error("Main contour either was not found or has less than 3 points");var r=e.ConvexHull.convexHull(n),o=e.RotatingCallipers.minBoundingRectangle(r);return o=e.PointUtils.scaleAll(o,this.dsFactor)},e.EdgeDetector=t}(),e.GeneralSettings=function(){"use strict";function t(t){return e.Utils.getOptions(n[t])}function i(){return e.Utils.getOptions(a)}var a={downscaleSize:12288,selfieDownscaleSize:3e4,contourRadius:7,gaussianBlurValue:4,sobelThreshold:90,sobelMaxExpositionThreshold:70,minSquareThreshold:.1,maxRatioDeviationThreshold:1.8,maxRatioThreshold:5,maxGuidanceThreshold:3,outOfScreenDownscaledPadding:2.9,targetFrameCropEvrsPadding:50},n={};return n[KfxWebSDK.document.MOBILE_ID]={aspectRatio:2.125/3.375,downscaleSize:12e4,perspectiveThreshold:1.00016,gaussianBlur:4,houghThreshold:11,houghLinesMax:84,minTetragonRank:126,minTetragonSideRank:39,maxDiagonalFraction:1.059,maxAvgAspectRatio:3.966,minAvgAspectRatio:2.283,maxAngleDeviation:18,minAngleDeviation:14,maxRightAngleDeviation:10,maxDivineAngleDeviation:4,minSquareFraction:.191,maxOutOfSpaceIndex:.018,maxSidesDistances:1.086,minSidesDistances:.364,erectLinearThreshold:15,inclinedLinearThreshold:25},n[KfxWebSDK.document.CHECK_DEPOSIT]={downscaleSize:12e4,perspectiveThreshold:1.00074,gaussianBlur:4,runSecondPass:!0,secondPassHoughThreshold:5,secondPassHoughLinesMax:5,houghThreshold:18,houghLinesMax:70,minTetragonRank:176,minTetragonSideRank:57,maxDiagonalFraction:1.0463,maxAvgAspectRatio:7.641,minAvgAspectRatio:3.17,maxAngleDeviation:15,minAngleDeviation:3,maxRightAngleDeviation:9,maxDivineAngleDeviation:3,minSquareFraction:.392,maxOutOfSpaceIndex:.018,maxSidesDistances:1.175,minSidesDistances:.342,erectLinearThreshold:15,inclinedLinearThreshold:18},n[KfxWebSDK.document.PASSPORT]={boundingCrop:!0,boundingPadding:15,aspectRatio:142/202,downscaleSize:12e4,perspectiveThreshold:1.00202,gaussianBlur:4,houghThreshold:18,houghLinesMax:70,minTetragonRank:140,minTetragonSideRank:51,maxDiagonalFraction:1.116,maxAvgAspectRatio:3.596,minAvgAspectRatio:1.241,maxAngleDeviation:42,minAngleDeviation:8,maxRightAngleDeviation:24,maxDivineAngleDeviation:13,minSquareFraction:.432,maxOutOfSpaceIndex:.017,maxSidesDistances:1.141,minSidesDistances:.427,erectLinearThreshold:15,inclinedLinearThreshold:25},n[KfxWebSDK.document.BILL_PAY]={},{getSettings:t,getSettingsForRealTimeEdgeDetection:i}}(),function(){"use strict";function t(e,t,i,a,n){this.width=e,this.height=t,this.threshold=a,this.expThreshold=n,this.gaussianBlur=i,this.kernels={},this.kernels.r=new jsfeat.matrix_t(e,t,jsfeat.S32C2_t),this.kernels.g=new jsfeat.matrix_t(e,t,jsfeat.S32C2_t),this.kernels.b=new jsfeat.matrix_t(e,t,jsfeat.S32C2_t),this.gradients={},this.gradients.r=new jsfeat.matrix_t(e,t,jsfeat.S32C1_t),this.gradients.g=new jsfeat.matrix_t(e,t,jsfeat.S32C1_t),this.gradients.b=new jsfeat.matrix_t(e,t,jsfeat.S32C1_t),this.u8={},this.u8.r=new jsfeat.matrix_t(e,t,jsfeat.U8C1_t),this.u8.g=new jsfeat.matrix_t(e,t,jsfeat.U8C1_t),this.u8.b=new jsfeat.matrix_t(e,t,jsfeat.U8C1_t),this.u8.main=new jsfeat.matrix_t(e,t,jsfeat.U8C1_t)}t.prototype.process=function(e){for(var t=e.data,i=t.length,a=this.u8.r.data,n=this.u8.g.data,r=this.u8.b.data,o=0,s=0;o<i;o+=4,s++)a[s]=t[o],n[s]=t[o+1],r[s]=t[o+2];i=this.width*this.height,jsfeat.imgproc.gaussian_blur(this.u8.r,this.u8.r,this.gaussianBlur),jsfeat.imgproc.gaussian_blur(this.u8.g,this.u8.g,this.gaussianBlur),jsfeat.imgproc.gaussian_blur(this.u8.b,this.u8.b,this.gaussianBlur),jsfeat.imgproc.sobel_derivatives(this.u8.r,this.kernels.r),jsfeat.imgproc.sobel_derivatives(this.u8.g,this.kernels.g),jsfeat.imgproc.sobel_derivatives(this.u8.b,this.kernels.b);var l,c,u=this.kernels.r.data,f=this.gradients.r.data,h=0,d=0,p=this.kernels.g.data,m=this.gradients.g.data,g=0,v=0,S=this.kernels.b.data,y=this.gradients.b.data,w=0,b=0;for(o=0;o<i;o++)l=o<<1,c=l+1,h=u[l],d=u[c],f[o]=h*h+d*d,g=p[l],v=p[c],m[o]=g*g+v*v,w=S[l],b=S[c],y[o]=w*w+b*b;var C,T,A,P,E,I,_,x,D,M,L,R,O,k,G,F,U,j,N,B,H,V,W,z,K,X,q,Y,Z,J,Q,$,ee,te,ie,ae,ne,re,oe,se,le,ce,ue=0,fe=0,he=0,de=0,pe=0,me=0,ge=0,ve=0,Se=0,ye=0,we=0,be=0,Ce=this.u8.main.data,Te=Ce[0],Ae=this.u8.main.cols;for(o=0;o<i;o++)l=o<<1,h=u[l],d=u[l+1],C=h>>31,T=d>>31,he=(h^C)-C|0,de=(d^T)-T|0,ue=h>0?1:-1,fe=d>0?Ae:-Ae,A=o+ue,P=o+fe,E=he-de,B=f[A-fe],V=f[P-ue],he>de?(N=f[A],H=f[o-ue],W=E*N+de*B,z=E*H+de*V,I=he):(N=f[o-fe],H=f[P],E=-E,W=E*N+he*B,z=E*H+he*V,I=de),K=f[o]*I,g=p[l],v=p[l+1],_=g>>31,x=v>>31,ge=(g^_)-_|0,ve=(v^x)-x|0,pe=g>0?1:-1,me=v>0?Ae:-Ae,D=o+pe,M=o+me,L=ge-ve,Y=m[D-me],J=m[M-pe],ge>ve?(q=m[D],Z=m[o-pe],Q=L*q+ve*Y,$=L*Z+ve*J,R=ge):(q=m[o-me],Z=m[M],L=-L,Q=L*q+ge*Y,$=L*Z+ge*J,R=ve),ee=m[o]*R,w=S[l],b=S[l+1],O=w>>31,k=b>>31,we=(w^O)-O|0,be=(b^k)-k|0,Se=w>0?1:-1,ye=b>0?Ae:-Ae,G=o+Se,F=o+ye,U=we-be,ae=y[G-ye],re=y[F-Se],we>be?(ie=y[G],ne=y[o-Se],oe=U*ie+be*ae,se=U*ne+be*re,j=we):(ie=y[o-ye],ne=y[F],U=-U,oe=U*ie+we*ae,se=U*ne+we*re,j=be),le=y[o]*j,X=K>=W&&K>z?255&I:0,te=ee>=Q&&ee>$?255&R:0,ce=le>=oe&&le>se?255&j:0,Ce[o]=Math.max.call(Math,X,te,ce),Te=Math.max(Ce[o],Te);if(Te<=this.expThreshold)throw Error("Image is too dark to process");var Pe,Ee=this.threshold*Te/255,Ie=new Array(i);for(o=0;o<i;o++)Pe=Ce[o]>=Ee?255:0,Ie[o]=Pe;return Ie},e.Sobel=t}(),function(){"use strict";function t(e,t,i,a,n,r,o){this.rho=e,this.angle=t,this.rank=void 0===a?0:a,this.ar=void 0===i?0:i,void 0===n||void 0===r||void 0===o?(this.sin=Math.sin(this.angle),this.cos=Math.cos(this.angle),this.cos=1===this.sin?0:this.cos,this.sin=1===this.cos?0:this.sin,this.t=Math.round(180*this.angle/Math.PI),180===this.t&&(this.t=0)):(this.sin=n,this.cos=r,this.t=o),this.isVertical=0===this.sin,this.isHorizontal=0===this.cos,this.b=this.rho/this.sin,this.k=-this.cos/this.sin,this.north=this.rho<0&&this.t>90,this.south=this.rho>0&&this.t>90}t.prototype.equals=function(e){return this.rho===e.rho&&this.angle===e.angle},t.prototype.isParallel=function(e){return this.rho!==e.rho&&this.angle===e.angle},t.prototype.intersect=function(e){if(this.equals(e)||this.isParallel(e))return[NaN,NaN];var t,i;return this.isVertical?(t=this.rho,i=e.get(t)):e.isVertical?(t=e.rho,i=this.get(t)):(t=(e.b-this.b)/(this.k-e.k),i=this.get(t)),[t,i]},t.prototype.get=function(e){return this.isHorizontal?this.rho:e*this.k+this.b},t.prototype.scale=function(e){return new t(e*this.rho,this.angle,this.ar,this.rank,this.sin,this.cos,this.t)},t.prototype.checkPoint=function(e,t){return t=void 0===t?0:t,Math.abs(e[0]*this.cos+e[1]*this.sin-this.rho)<=t},e.LinePolar=t}(),function(){"use strict";function t(e){var t=e[0],a=e[1],n=e[2];this.rectangle=e,this.length=this.rectangle.length,this.sideA=i(t,a),this.sideB=i(a,n),this.square=this.sideA*this.sideB;var r=t[0],o=t[1];this.mx=r+(n[0]-r)/2,this.my=o+(n[1]-o)/2;var s;this.sideA>this.sideB?(s=0,this["long"]=this.sideA,this["short"]=this.sideB):(s=1,this["long"]=this.sideB,this["short"]=this.sideA),this.ratio=this["long"]/this["short"],this.isSquareShape=this.ratio<=1.1;var l=s+1,c=this.rectangle[s],u=this.rectangle[l],f=c[0]-u[0];0===f?(this.tangens=NaN,this.radians=Math.PI/2,this.angle=90):(this.tangens=(c[1]-u[1])/f,this.radians=Math.atan(this.tangens),this.angle=180*this.radians/Math.PI)}var i=e.PointUtils.getDistance;t.prototype.shift=function(e,i){for(var a,n=[],r=0;r<this.length;r++)a=this.get(r),n.push([a[0]+e,a[1]+i]);return new t(n)},t.prototype.get=function(e){return this.rectangle[e]},t.prototype.getRadius=function(){for(var e,t,i,a=0,n=0;n<this.length;n++)e=this.get(n),t=e[0]-this.mx,i=e[1]-this.my,a=Math.max(a,t*t+i*i);return Math.sqrt(a)},t.prototype.rotate=function(e){for(var i,a,n,r=[],o=Math.sin(e),s=Math.cos(e),l=0;l<this.length;l++)i=this.get(l),a=i[0]-this.mx,n=i[1]-this.my,r.push([a*s-n*o+this.mx,n*s+a*o+this.my]);return new t(r)},e.Rectangle=t}(),function(){"use strict";function t(e,t,i,a){this.l1=e,this.l2=t,this.l3=i,this.l4=a,this.p1=this.l1.intersect(this.l2),this.p2=this.l2.intersect(this.l3),this.p3=this.l3.intersect(this.l4),this.p4=this.l4.intersect(this.l1),this.p12=o(this.p1,this.p2),this.p23=o(this.p2,this.p3),this.p34=o(this.p3,this.p4),this.p41=o(this.p4,this.p1),this.as1=this.p12+this.p34,this.as2=this.p23+this.p41,this.s12=this.as1*this.as2}var i=e.PointUtils.scale,a=e.PointUtils.getDistance,n=e.LineUtils.getLinesAngle,r=e.LineUtils.getLinesDistance,o=e.PointUtils.getSquareDistance,s=e.PointUtils.getOutOfSpaceLength,l=e.LineUtils.getLinePolarByPoints,c=e.LineUtils.getPointsOnLineByLengthFromAnotherPoint;t.prototype.getBound=function(t){var i=e.PointUtils.getBound([this.p1,this.p2,this.p3,this.p4]);return e.PointUtils.scaleAll(i,t)},t.prototype.getCenterPoint=function(e){var t=l(this.p1,this.p3),a=l(this.p2,this.p4);return i(t.intersect(a),e)},t.prototype.getRectangleInterpolation=function(e){var t,n=l(this.p1,this.p3),r=l(this.p2,this.p4),o=n.intersect(r),s=a(o,this.p1),u=a(o,this.p2),f=a(o,this.p3),h=a(o,this.p4),d=Math.min.apply(Math,[s,u,f,h]);t=c(n,o,d);var p=t[0],m=t[1];t=c(r,o,d);var g=t[0],v=t[1];return[i(p,e),i(g,e),i(m,e),i(v,e)]},t.prototype.getPerspectiveData=function(t,i){var n=this.getPoints(i);n=e.ConvexHull.convexHull(n).reverse();var r=a(n[0],n[1]),o=a(n[1],n[2]);if(r<o){var s=[];s.push(n[3]),s.push(n[0]),s.push(n[1]),s.push(n[2]),n=s,r=a(n[0],n[1]),o=a(n[1],n[2])}var l=a(n[2],n[3]),c=a(n[3],n[0]),u=Math.round((r+l)/2),f=Math.round((o+c)/2),h=Math.max(u,f),d=Math.min(u,f);return void 0!==t&&(d=Math.round(t*h)),{src:n,dst:[[0,0],[h,0],[h,d],[0,d]]}},t.prototype.getPerspectiveFraction=function(){var e=(Math.sqrt(this.p12)+Math.sqrt(this.p34))/2,t=(Math.sqrt(this.p23)+Math.sqrt(this.p41))/2,i=Math.sqrt(e*e+t*t),n=a(this.p1,this.p3),r=a(this.p2,this.p4),o=Math.min(n,r);return i>o?i/o:o/i},t.prototype.getPoints=function(t){for(var a=[this.p1,this.p2,this.p3,this.p4],n=e.PointUtils.roundToPoint,r=0,o=this.getCenterPoint(1);r<a.length;r++)a[r]=i(a[r],t),a[r]=n(a[r],o);return a},t.prototype.getConfidenceValue=function(){var e=this.l1.ar+this.l2.ar+this.l3.ar+this.l4.ar;return this.s12*e},t.prototype.getDiagonalFraction=function(){var e=o(this.p1,this.p3),t=o(this.p2,this.p4);return Math.max(e,t)/Math.min(e,t)},t.prototype.getAvgAspectRatio=function(){return Math.max(this.as1,this.as2)/Math.min(this.as1,this.as2)},t.prototype.getSidesAngleDeviation=function(){var e=n(this.l1,this.l3),t=n(this.l2,this.l4);return{max:Math.max(e,t),min:Math.min(e,t)}},t.prototype.getSquareFraction=function(e){return this.s12/e},t.prototype.getOutOfSpaceIndex=function(e,t,i){var a=s(this.p1,t,i);return a=Math.max(a,s(this.p2,t,i)),a=Math.max(a,s(this.p3,t,i)),a=Math.max(a,s(this.p4,t,i)),a/e},t.prototype.getSidesDistances=function(e){var t=r(this.l1,this.l3),i=r(this.l2,this.l4);return{max:Math.max(t,i)/e,min:Math.min(t,i)/e}},e.Tetragon=t}(),function(){"use strict";function t(e,t,i){this.width=e,this.height=t,this.radius=i,this.squareRadius=this.radius*this.radius;for(var a,n=new Array(e*t),r=0;r<n.length;r++)a=Math.floor(r/e),n[r]=[r-a*e,a];this.cache=n}function i(e){for(var t=-1,i={},n=0;n<e.length;n++)e[n]<0?a.call(this,e,i,e[n],n):e[n]>0&&(void 0===i[t]&&(i[t]=[]),a.call(this,e,i,t,n),t--);return i}function a(e,t,i,a){for(var n,r,o,s,l,c,u,f,h=this.cache[a],d=h[0],p=h[1],m=this.width,g=this.height,v=this.radius,S=this.squareRadius,y=Math.max(d-v,0),w=Math.max(p-v,0),b=Math.min(d+v,m-1),C=Math.min(p+v,g-1),T=y;T<=b;T++)for(var A=w;A<=C;A++)if(n=T-d,r=A-p,!(n*n+r*r>S))if(o=A*m+T,s=e[o],s>0)e[o]=i,t[i].push([T,A]);else if(s<0&&s!==i){for(l=t[s],c=l.length,f=0;f<c;f++)u=l[f],e[u[1]*m+u[0]]=i,t[i].push(u);delete t[s]}}t.prototype.find=function(e){var t,a=[],n=0,r=i.call(this,e);for(var o in r)r.hasOwnProperty(o)&&(t=r[o],t.length>n&&(n=t.length,a=t));return a},e.ContourFinder=t}(),e.ConvexHull=function(){"use strict";function t(t){if(t.length<3)return t;for(var i,a=[],n=t[0],r=e.PointUtils.equals,o=e.PointUtils.getSquareDistance,s=e.PointUtils.approximatePointToLineDistance,l=1;l<t.length;l++)i=t[l],(i[0]<n[0]||i[0]===n[0]&&i[1]<n[1])&&(n=i);var c,u,f,h;do{for(a.push(n),c=t[0],f=r(n,c),h=o(n,c),l=1;l<t.length;l++)i=t[l],u=s(n,c,i),(u>0||0===u&&o(n,i)>h||f)&&(c=i,f=r(n,c),h=o(n,c));n=c}while(!r(c,a[0]));return a}return{convexHull:t}}(),e.Hough=function(){"use strict";function t(e){return function(t,i){return e[i]-e[t]}}function i(e,t,i){var a,r,o,u,f,h=n,d=c(2*(t+i)+1),p=d+2,m=d-1,g=.5*m,v=(h+2)*p,S=new Array(v),y=new Array(v),w=new Array(v);for(a=0;a<v;a++)S[a]=0,y[a]=[-255,-255],w[a]=0;var b,C,T,A=0;for(a=0;a<i;a++)for(r=0;r<t;r++)if(e[a*t+r]>0)for(o=0;o<h;o++)u=c(r*l[o]+a*s[o])+g,f=(o+1)*p+u+1,S[f]++,b=y[f],C=b[0]-r,T=b[1]-a,-1<=C&&C<=1&&-1<=T&&T<=1&&w[f]++,b[0]=r,b[1]=a,w[f]>A&&(A=w[f]);return{c2:w,max_c2:A,accum:S}}function a(a,f,h,d,p,m,g){var v,S,y,w,b,C,T,A,P=[],E=n,I=c(2*(f+h)+1),_=I+2,x=I-2,D=I-1,M=.5*D,L=1/_,R=[];void 0===m&&(m=i(a,f,h)),T=m.c2,C=m.accum,A=m.max_c2;var O,k=100/A,G=d/k,F=e.Type.isFunction(g);for(y=0;y<I;y++)for(S=0;S<E;S++)b=(S+1)*_+y+1,O=C[b],T[b]>G&&O>C[b-1]&&O>=C[b+1]&&O>C[b-x]&&O>=C[b+_]&&(F?g(R,b,S*o,b-(S+1)*_-M-1):R.push(b));R.sort(t(T)),p=Math.min(p,R.length);var U,j,N,B=e.LinePolar;for(v=0;v<p;v++)w=R[v],S=u(w*L)-1,y=w-(S+1)*_-1,U=y-M,j=S*o,N=0<=j&&j<=r,U<0&&N||0===U&&!N||P.push(new B(U,j,T[w],c(k*T[w]),s[S],l[S],S));return P}for(var n=180,r=Math.PI/2,o=Math.PI/180,s=new Array(n),l=new Array(n),c=Math.round,u=Math.floor,f=0,h=0;f<n;h+=o,f++)s[f]=Math.sin(h),l[f]=Math.cos(h);return{getAccumulator:i,getLinesStandard:a}}(),e.LineExtractor=function(){"use strict";function e(e,t,i,a,n){for(var r,o,s=[],l={},c=0,u=t,f=-1,h=0;u<=i;u+=a)o=e[u],o>0&&(f===-1&&(f=u),h++),0!==o&&u!==i||f===-1||(r=o>0?u:u-1,l[f]=[f,h,r],f!==r&&(l[r]=l[f]),s.push(l[f]),c=Math.max(h,c),void 0===n[h]&&(n[h]=[]),n[h].push(l[f]),f=-1,h=0);return s.maxSize=c,s.map=l,s}function t(e,t,a){for(var n=0;n<e.length;n++)i(e[n],t,a)}function i(e,t,i){for(var a=e[0];a<=e[2];a+=t)i[a]=255}function a(e,i,a,n){for(var r,o=Object.keys(e),s=0;s<o.length;s++)(r=o[s])>i&&t(e[r],a,n)}function n(t,i,n,r,o){for(var l,c=[],u={},f=0,h=1,d=0,p=i-1;d<n;d++)c[d]=l=e(t,d*i,d*i+p,h,u),l.length>0&&(f=Math.max(l.maxSize,f));for(var m,g=[],v={},S=0,y=i,w=0,b=n-1;w<i;w++)g[w]=m=e(t,w,b*i+w,y,v),m.length>0&&(S=Math.max(m.maxSize,S));var C=Math.floor(f*r.erectLinearThreshold/100);C>5&&a(u,C,h,o);var T=Math.floor(S*r.erectLinearThreshold/100);T>5&&a(v,T,y,o),s(c,i,r,o)}function r(e,t,a){do i(e,1,a),e=e.track[t].next;while(null!==e)}function o(e){return{L:{next:null,size:e,referenced:!1},R:{next:null,size:e,referenced:!1}}}function s(e,t,i,a){for(var n,r,s,u,f,h,d,p,m=0;m<e.length;m++)for(var g=0;g<e[m].length;g++)n=e[m][g],r=n[1],u=n[0],f=n[2],n.track=o(r),s=e[m-1],void 0!==s&&0!==s.length&&(p=s.map,h=f-t,d=void 0!==p[h]?p[h]:void 0!==p[++h]?p[h]:void 0,c(n,d,"R"),h=u-t,d=void 0!==p[h]?p[h]:void 0!==p[--h]?p[h]:void 0,c(n,d,"L"));for(var v=[],S=0,y=[],w=0,m=0;m<e.length;m++)for(var g=0;g<e[m].length;g++)n=e[m][g],n.track.L.referenced||null===n.track.L.next||(y.push(n),w=Math.max(w,n.track.L.size)),n.track.R.referenced||null===n.track.R.next||(v.push(n),S=Math.max(S,n.track.R.size));l(v,Math.floor(S*i.inclinedLinearThreshold/100),"R",a),l(y,Math.floor(w*i.inclinedLinearThreshold/100),"L",a)}function l(e,t,i,a){if(e.length>0)for(var n=0;n<e.length;n++)e[n].track[i].size>t&&r(e[n],i,a)}function c(e,t,i){void 0!==t&&(e.track[i].next=t,e.track[i].size=t.track[i].size+e[1],e.track[i].referenced=!1,t.track[i].referenced=!0)}return{process:n}}(),e.Perspective=function(){"use strict";function t(t,a,n,r){var o=new jsfeat.matrix_t(3,3,jsfeat.F32_t|jsfeat.C1_t),s=e.GeneralSettings.getSettings(r).aspectRatio,l=a.getPerspectiveData(s,n),c=l.src,u=l.dst,f=c[0][0],h=c[0][1],d=u[0][0],p=u[0][1],m=c[1][0],g=c[1][1],v=u[1][0],S=u[1][1],y=c[2][0],w=c[2][1],b=u[2][0],C=u[2][1],T=c[3][0],A=c[3][1],P=u[3][0],E=u[3][1];jsfeat.math.perspective_4point_transform(o,f,h,d,p,m,g,v,S,y,w,b,C,T,A,P,E),jsfeat.matmath.invert_3x3(o,o);var I=e.ImageUtils.createEmptyImageData(b,C);return i(t,I,o.data),I}function i(e,t,i){for(var a,n,r,o,s,l,c,u,f=0|t.width,h=0|t.height,d=0|e.width,p=0|e.height,m=0,g=0,v=0,S=0,y=0,w=0,b=0,C=0,T=0,A=0,P=0,E=0,I=0,_=0,x=0,D=0,M=0,L=i[0],R=i[1],O=i[2],k=i[3],G=i[4],F=i[5],U=i[6],j=i[7],N=i[8],B=d-1,H=p-1,V=4*d,W=4*f,z=e.data,K=t.data,X=0,q=0;q<h;++q){w=R*q+O,b=G*q+F,C=j*q+N,c=q*W;for(var Y=0;Y<f;Y++,X+=4,w+=L,b+=k,C+=U)T=1/C,S=w*T,y=b*T,g=0|S,v=0|y,u=0,l=c+4*Y+3,S>0&&y>0&&g<B&&v<H&&(A=Math.max(S-g,0),P=Math.max(y-v,0),m=V*v+4*g|0,a=m+V,n=m+1,r=m+2,o=a+1,s=a+2,E=z[m]+A*(z[m+4]-z[m]),I=z[a]+A*(z[a+4]-z[a]),_=z[n]+A*(z[m+5]-z[n]),x=z[o]+A*(z[a+5]-z[o]),D=z[r]+A*(z[m+6]-z[r]),M=z[s]+A*(z[a+6]-z[s]),K[X]=E+P*(I-E),K[X+1]=_+P*(x-_),K[X+2]=D+P*(M-D),u=255),K[l]=u}}return{transform:t}}(),e.RotatingCallipers=function(){"use strict";function t(e){for(var t,h,d,p,m,g=[],v=e.length,S=a,y=new Array(v),w=new Array(v),b=v-1,C=0;b>=0;b--,C++)m=e[b],y[C]=[m[0],m[1]];var T,A,P,E,I=[a,a],_=[n,n];for(b=0;b<v;b++)h=y[b],d=h[0],p=h[1],w[b]=u(y[(b+1)%v],h),d<I[0]&&(I[0]=d,T=b),d>_[0]&&(_[0]=d,A=b),p<I[1]&&(I[1]=p,E=b),p>_[1]&&(_[1]=p,P=b);var x,D,M,L,R,O=r,k=o,G=s,F=l;for(b=0;b<v;b++){switch(t=[Math.acos(c(O,w[T])),Math.acos(c(k,w[A])),Math.acos(c(G,w[P])),Math.acos(c(F,w[E]))],t.indexOf(Math.min.apply(Math,t))){case 0:O=w[T],k=[-O[0],-O[1]],G=[O[1],-O[0]],F=[-G[0],-G[1]],T=(T+1)%v;break;case 1:k=w[A],O=[-k[0],-k[1]],G=[O[1],-O[0]],F=[-G[0],-G[1]],A=(A+1)%v;break;case 2:G=w[P],F=[-G[0],-G[1]],O=[F[1],-F[0]],k=[-O[0],-O[1]],P=(P+1)%v;break;case 3:F=w[E],G=[-F[0],-F[1]],O=[F[1],-F[0]],k=[-O[0],-O[1]],E=(E+1)%v}x=i(y[T],O,y[P],G),D=i(y[A],k,y[P],G),M=i(y[E],F,y[T],O),L=i(y[E],F,y[A],k),R=f(x,D)*f(x,M),R<S&&(g=[x,M,L,D],S=R)}return g}function i(e,t,i,a){var n=(i[0]-e[0])*a[1]-(i[1]-e[1])*a[0],r=t[0]*a[1]-t[1]*a[0],o=n/r;return[e[0]+o*t[0],e[1]+o*t[1]]}var a=Number.MAX_VALUE,n=Number.MIN_VALUE,r=[0,-1],o=[0,1],s=[-1,0],l=[1,0],c=e.PointUtils.dot,u=e.PointUtils.subtract,f=e.PointUtils.getSquareDistance;return{minBoundingRectangle:t}}(),function(){"use strict";function t(t,i){this.width=t,this.height=i,this.north=new e.LinePolar(0,Math.PI/2),this.south=new e.LinePolar(this.height,Math.PI/2),this.east=new e.LinePolar(this.width,0),this.west=new e.LinePolar(0,0)}function i(e){var t;return e[0]<0&&(t=this.west),e[0]>this.width&&(t=this.east),e[1]<0&&(t=this.north),e[1]>this.height&&(t=this.south),t}function a(e,t){var i;return t===this.west&&(i=[Math.ceil(e[0])+1,e[1]]),t===this.east&&(i=[Math.floor(e[0])-1,e[1]]),t===this.north&&(i=[e[0],Math.ceil(e[1])+1]),t===this.south&&(i=[e[0],Math.floor(e[1])-1]),i}function n(t,n,r,o,s,l){var c=i.call(this,l);if(void 0===c)return t;var u=e.PointUtils.getDistance,f=e.LineUtils.getParallelLineByPoint,h=[t.l1,t.l2,t.l3,t.l4],d=e.LineUtils.getLinesAngle(o,c),p=e.LineUtils.getLinesAngle(s,c),m=Math.sin(Math.PI*d/180),g=Math.sin(Math.PI*p/180),v=0===g?0:1/(1+m/g),S=o.intersect(c),y=s.intersect(c),w=0===v?S:1===v?y:null;if(null===w){var b=u(S,y),C=b*v,T=e.LineUtils.getPointsOnLineByLengthFromAnotherPoint(c,S,C);w=u(y,T[0])>u(y,T[1])?T[1]:T[0]}return w=a.call(this,w,c),h[n]=f(w,o),h[r]=f(w,s),new e.Tetragon(h[0],h[1],h[2],h[3])}t.prototype.process=function(e){var t=e;return t=n.call(this,t,0,1,t.l1,t.l2,t.p1),t=n.call(this,t,1,2,t.l2,t.l3,t.p2),t=n.call(this,t,2,3,t.l3,t.l4,t.p3),t=n.call(this,t,3,0,t.l4,t.l1,t.p4)},e.TetragonAligner=t}(),function(){"use strict";function t(t,i,a){this.width=t,this.height=i,this.square=this.width*this.height,this.squaredSquare=this.square*this.square,this.avgSize=(this.width+this.height)/2,this.settings=e.GeneralSettings.getSettings(a)}t.prototype.filter=function(e){if(e.getDiagonalFraction()>this.settings.maxDiagonalFraction)return!1;var t=e.getAvgAspectRatio();return!(t<this.settings.minAvgAspectRatio||t>this.settings.maxAvgAspectRatio)&&(!(e.getSquareFraction(this.squaredSquare)<this.settings.minSquareFraction)&&!(e.getOutOfSpaceIndex(this.avgSize,this.width,this.height)>this.settings.maxOutOfSpaceIndex))},e.TetragonFilter=t}(),function(){"use strict";function t(t,i,a,n,r){this.data=t,this.width=i,this.height=a,this.avgSize=(this.width+this.height)/2,this.type=n,this.settings=e.GeneralSettings.getSettings(this.type),this.had=r}function i(t,i){var a,n,s=this.settings.maxAngleDeviation,l=this.settings.minSidesDistances,c=this.settings.maxSidesDistances,u=c*this.avgSize,f=l*this.avgSize,h=e.LinePolar,d=function(e,t,l,c){a=new h(c,l),n=o(i,a),r(i,a)<=s&&n>=f&&n<=u&&e.push(t)},p=e.Hough.getLinesStandard(this.data,this.width,this.height,this.settings.secondPassHoughThreshold,this.settings.secondPassHoughLinesMax,this.had,d);return this.find(t.concat(p),!0)}var a=Math.abs,n=e.LineUtils.getLinesByAngle,r=e.LineUtils.getLinesAngle,o=e.LineUtils.getLinesDistance,s=e.LineUtils.getDivineAngle;t.prototype.find=function(t,l){for(var c,u,f,h,d,p,m,g,v,S,y,w,b,C=0,T=void 0!==l&&l,A=new e.TetragonFilter(this.width,this.height,this.type),P=this.settings.maxDivineAngleDeviation,E=this.settings.maxRightAngleDeviation,I=this.settings.minTetragonSideRank,_=this.settings.minAngleDeviation,x=this.settings.minSidesDistances,D=this.settings.maxSidesDistances,M=this.settings.maxAngleDeviation,L=this.settings.minTetragonRank,R=D*this.avgSize,O=x*this.avgSize,k=new Array(180),G=e.Tetragon,F=-1,U=!T,j=0;j<t.length&&t[j].rank>=I;j++){m=t[j];for(var N=j+1;N<t.length;N++)if(g=t[N],v=o(m,g),!(r(m,g)>_||v<O||v>R)){b=k[m.t],void 0===b&&(b=n(t,a(m.t+90)%180,E),k[m.t]=b),h=m.rank+g.rank;for(var B=0;B<b.length;B++)if(y=b[B],!(s(y,m,g)>P)){d=h+y.rank,F<d&&(F=d,p=y);for(var H=B+1;H<b.length;H++)w=b[H],S=o(y,w),r(y,w)>M||S<O||S>R||d+w.rank<L&&U||(c=new G(m,y,g,w),A.filter(c)&&(u=c.getConfidenceValue(),u>C&&(f=c,C=u)))}}}return T?f:(this.settings.runSecondPass&&void 0===f&&void 0!==y&&(f=i.call(this,t,p)),f)},e.TetragonFinder=t}(),function(){"use strict";function t(e,t,a,n){"string"==typeof e?(this.image=document.createElement("img"),this.image.src=e):this.image=e,this.font=t,this.textPadding=a,this.width=-1,this.height=-1,this.time=n,this.startTime=-1,i=!1}var i,a="Tap to Dismiss";t.prototype.setSize=function(e,t){this.width=e,this.height=t},t.prototype.isShown=function(){return this.startTime!==-1},t.prototype.isExpired=function(){if(this.startTime===-1)return!1;if(i)return!0;var e=(new Date).getTime(),t=this.startTime+this.time;return e>=t&&(i=!0,"function"==typeof this.callBack&&this.callBack()),i},t.prototype.draw=function(e){this.rememberStartTime(),this.drawImage(e),this.drawDismissText(e)},t.prototype.rememberStartTime=function(){this.startTime===-1&&this.image.complete&&(this.startTime=Date.now())},t.prototype.drawImage=function(e){var t=this.image;if(t.naturalWidth&&t.naturalHeight){var i;if(this.width!==-1&&this.height!==-1){var a=this.width/t.naturalWidth,n=this.height/t.naturalHeight;i=Math.min(a,n)}else i=1;var r=t.naturalWidth*i,o=t.naturalHeight*i,s=-(r>>1),l=-(o>>1);e.drawImage(t,s,l,r,o)}},t.prototype.drawDismissText=function(e){try{e.save(),e.rotate(Math.PI/2),e.font=this.font,e.fillStyle="white",e.textBaseline="top";var t=e.measureText(a),i=-(t.width>>1),n=(this.width>>1)+this.textPadding;e.fillText(a,i,n)}finally{e.restore()}},t.prototype.setExpireHandler=function(e){this.callBack=e},e.DocumentSample=t}(),e.Extraction=function(){function t(t){var i;if(null===t||"undefined"==typeof t)return i=new e.ValidationError("Please provide options needed for extraction."),e.report(g,i),!1;if("object"!=typeof t)return i=new e.ValidationError("Please provide valid options object"),e.report(g,i),!1;if(null===t.url||"undefined"==typeof t.url)return i=new e.ValidationError("Please provide url of the server."),e.report(g,i),!1;if("string"!=typeof t.url||0==t.url.length)return i=new e.ValidationError("Please provide valid url"),e.report(g,i),!1;if(null===t.images||"undefined"==typeof t.images)return i=new e.ValidationError("Please provide images for extraction."),e.report(g,i),!1;if("object"!=typeof t.images)return i=new e.ValidationError("Please provide array of images."),e.report(g,i),!1;if("[object Array]"!=Object.prototype.toString.call(t.images))return i=new e.ValidationError("Please provide array of images."),e.report(g,i),!1;if(0==t.images.length)return i=new e.ValidationError("Please provide atleast one image for extraction."),e.report(g,i),!1;if(null===t.serverParameters||"undefined"==typeof t.serverParameters)return i=new e.ValidationError("Please provide serverParameters for extraction."),e.report(g,i),!1;if("object"!=typeof t.serverParameters)return i=new e.ValidationError("Please provide valid server parameters."),e.report(g,i),!1;if(null==t.timingInfo&&"undefined"==typeof t.timingInfo)return i=new e.ValidationError("Please provide timingInfo."),e.report(g,i),!1;if("boolean"!=typeof t.timingInfo)return i=new e.ValidationError("Please provide valid timing info."),e.report(g,i),!1;for(var a=0;a<t.images.length;a++)if("[object Uint8Array]"!=Object.prototype.toString.call(t.images[a]))return i=new e.ValidationError("The image should be of Uint8Array format."),e.report(g,i),!1;return!0}function i(e,t,i){if(a(e,i)){var n={userIdentityWithPassword:{UserId:e.username,LogOnProtocol:7,UnconditionalLogOn:!0,Password:e.password}},r={url:e.url+S,serverParameters:n
};j(r,function(e){t(e)},function(e){i(e)})}}function a(t,i){return f(t)?null===t.url||"undefined"==typeof t.url?(error=new e.ValidationError("Please provide the URL needed for KTA login."),e.report(i,error),!1):"string"!=typeof t.url||0==t.url.length?(error=new e.ValidationError("Please provide valid url"),e.report(i,error),!1):null===t.username||"undefined"==typeof t.username?(error=new e.ValidationError("Please provide the username needed for KTA login."),e.report(i,error),!1):"string"!=typeof t.username||0==t.username.length?(error=new e.ValidationError("Please provide valid username"),e.report(i,error),!1):null===t.password||"undefined"==typeof t.password?(error=new e.ValidationError("Please provide the password needed for KTA login."),e.report(i,error),!1):"string"==typeof t.password&&0!=t.password.length||(error=new e.ValidationError("Please provide valid password"),e.report(i,error),!1):(error=new e.ValidationError("Please provide valid login options"),e.report(i,error),!1)}function n(){var e={jobWithDocsInitialization:{InputVariables:[{Value:null,Id:"Barcode"},{Value:!0,Id:"ProcessImage"},{Value:!0,Id:"Verification"}],Documents:[{DocumentName:null,RuntimeFields:null,FieldsToReturn:null,Base64Data:null,DocumentGroup:{Version:0,Id:null,Name:""},Data:null,MimeType:"image/jpeg",FolderTypeId:null,DocumentTypeId:null,ReturnFullTextOcr:!1,ReturnAllFields:!0,PageDataList:[],FilePath:null,PageDataCollection:null,FolderId:null}],StartDate:null,StoreFolderAndDocuments:!0},sessionId:"",processIdentity:{Version:0,Id:null,Name:""},variablesToReturn:{}};return e}function r(t){if(null==t)return null;for(var i=null,a={authenticationResult:null,VerificationPhoto64:null,transactionId:null,documentAlerts:null,documentTests:null,documentImageAnalysis:null,documentRiskVectorAnalysis:null,documentClassification:null},n=0;n<t.length;n++)"VerificationReserved"==t[n].Name&&(i=t[n].Value),"VerificationResult"==t[n].Name&&(a.authenticationResult=t[n].Value),"VerificationPhoto64"==t[n].Name&&(a.VerificationPhoto64=t[n].Value),"VerificationTransactionID"==t[n].Name&&(a.transactionId=t[n].Value);if(null!=i&&"undefined"!==i&&0!=e.Utils.isJSONValid(i)&&(i=JSON.parse(i),null!=i.DocumentInfo)){var r=i.DocumentInfo;r.DocumentAlerts.length<=0&&(r.DocumentAlerts=""),r.DocumentTests.length<=0&&(r.DocumentTests=""),r.DocumentImageAnalysis.length<=0&&(r.DocumentImageAnalysis=""),r.DocumentRiskVectorAnalysis.length<=0&&(r.DocumentRiskVectorAnalysis=""),r.DocumentClassification.length<=0&&(r.DocumentClassification=""),a.documentAlerts=r.DocumentAlerts,a.documentTests=r.DocumentTests,a.documentImageAnalysis=r.DocumentImageAnalysis,a.documentRiskVectorAnalysis=r.DocumentRiskVectorAnalysis,a.documentClassification=r.DocumentClassification}return a}function o(e){var t={sessionKey:m,words:[],"classificationResult ":[],documentId:e.d.DocumentId,extractionClass:p.serverParameters.documentName,JobId:e.d.JobIdentity.Id,fields:[]},i=k(e);return t.fields=s(i),t}function s(e){for(var t=[],i=e,a=0;a<i.length;a++){var n=i[a],r={id:null===n.Id?"":n.Id,text:null===n.Value?"":n.Value,name:null===n.Name?"":n.Name,confidence:null===n.Confidence?"":n.Confidence,errorDescription:null===n.ErrorDescription?"":n.ErrorDescription,valid:null===n.Valid?"":n.Valid};t.push(r)}return t}function l(){var e={jobWithDocsInitialization:{InputVariables:[],Documents:[{DocumentName:null,RuntimeFields:null,FieldsToReturn:null,Base64Data:null,DocumentGroup:{Version:0,Id:null,Name:""},Data:null,MimeType:"image/jpeg",ReturnFullTextOcr:!1,FolderTypeId:null,DocumentTypeId:null,ReturnAllFields:!0,PageDataList:[],FilePath:null,PageDataCollection:null,FolderId:null}],StartDate:null,StoreFolderAndDocuments:!0},sessionId:"",processIdentity:{Version:0,Id:null,Name:""},variablesToReturn:{}};return e}function c(e){for(var t=e.d,i=t.ReturnedDocumentFields[0].ReturnedDocumentFields,a={sessionKey:m,words:[],"classificationResult ":[],documentId:t.DocumentId,extractionClass:p.serverParameters.documentName,JobId:t.JobIdentity.Id,fields:[]},n=[],r=0;r<i.length;r++){var o=i[r],s={id:null===o.Id?"":o.Id,text:null===o.Value?"":o.Value,name:null===o.Name?"":o.Name,confidence:null===o.Confidence?"":o.Confidence,errorDescription:null===o.ErrorDescription?"":o.ErrorDescription,valid:null===o.Valid?"":o.Valid};n.push(s)}return a.fields=n,a}function u(t,i){var a;return f(t)?null===t.url||"undefined"==typeof t.url?(a=new e.ValidationError("Please provide the url needed for KTA extraction."),e.report(i,a),!1):"string"!=typeof t.url?(a=new e.ValidationError("Please provide valid url."),e.report(i,a),!1):0==t.url.length?(a=new e.ValidationError("Please provide valid url."),e.report(i,a),!1):null===t.serverParameters||"undefined"==typeof t.serverParameters?(a=new e.ValidationError("Please provide the server parameters needed for KTA extraction."),e.report(i,a),!1):"object"!=typeof t.serverParameters?(a=new e.ValidationError("Please provide valid server parameters."),e.report(i,a),!1):null===t.serverParameters.processIdentityName||"undefined"==typeof t.serverParameters.processIdentityName?(a=new e.ValidationError("Please provide the process identity name needed for KTA extraction."),e.report(i,a),!1):"string"!=typeof t.serverParameters.processIdentityName?(a=new e.ValidationError("Please provide valid process identity name needed for KTA extraction."),e.report(i,a),!1):0==t.serverParameters.processIdentityName.length?(a=new e.ValidationError("Please provide valid process identity name needed for KTA extraction."),e.report(i,a),!1):null===t.images||"undefined"==typeof t.images?(a=new e.ValidationError("Please provide array of images."),e.report(i,a),!1):"object"!=typeof t.images?(a=new e.ValidationError("Please provide array of images."),e.report(i,a),!1):"[object Array]"!=Object.prototype.toString.call(t.images)?(a=new e.ValidationError("Please provide array of images."),e.report(i,a),!1):0==t.images.length?(a=new e.ValidationError("Please provide atleast one image for extraction."),e.report(i,a),!1):null==t.timingInfo&&"undefined"==typeof t.timingInfo?(a=new e.ValidationError("Please provide timingInfo."),e.report(i,a),!1):"boolean"!=typeof t.timingInfo?(a=new e.ValidationError("Please provide valid timing info."),e.report(i,a),!1):"undefined"!=typeof t.serverParameters.sessionId&&null!=t.serverParameters.sessionId&&0!=t.serverParameters.sessionId.length||(a=new e.ValidationError("Please provide valid KTA sessionId"),e.report(i,a),!1):(a=new e.ValidationError("Please provide valid options object"),e.report(i,a),!1)}function f(e){return null!==e&&"undefined"!=typeof e&&"object"==typeof e}function h(e){var t=e.d;return null===t||"undefined"===t?null:t.DocumentId}function d(e){var t=e.d;return null===t||"undefined"===t?null:t.SessionId}var p,m,g,v,S="/UserService.svc/json/LogOnWithPassword2",y="/JobService.svc/json/CreateJobSyncWithDocuments",w="ErrorDetails",b="VerificationErrorInfo",C=new Date,T=function(i,a,n){v&&(v=null),v=new XMLHttpRequest,g=n;var r=t(i);if(r){var o,s={StartTime:new Date,Duration:null,FinishTime:null,message:""},l=i.serverParameters;v.addEventListener("load",function(t){if(i.timingInfo){s.FinishTime=new Date,s.Duration=(s.FinishTime-s.StartTime)/1e3;var n="Time: "+s.Duration+" seconds.";s.message=n}if(null==v||4!=v.readyState||200!=v.status){if(v.responseText.length>0){var r=new Error(v.responseText);return void e.report(g,r)}var r=new Error("The RTTI server may be offline or does not exist.");return void e.report(g,r)}try{o=JSON.parse(this.response)}catch(l){o=null}if(null==o){var r=new Error("We didn't receive a valid server response.");return void e.report(g,r)}if(o.exceptionMessage||o.Message&&o.Message.length>0){var r=new Error(o.Message);return void e.report(g,r)}"function"==typeof a&&(i.timingInfo?a(o,s):a(o,null))}),v.addEventListener("error",function(t){if(0==v.status){var i=new Error("The RTTI server may be offline or does not exist.");return void e.report(g,i)}if(null==t.Message||"undefined"==t.Message){var i=new Error("The RTTI server may be offline or does not exist.");return void e.report(g,i)}var i=new Error(t.Message);return void e.report(g,i)}),v.open("POST",i.url,!0),v.setRequestHeader("Accept","application/json");var c=new FormData;if(l)for(var u in l)l.hasOwnProperty(u)&&c.append(u,l[u]);for(var f=0;f<i.images.length;f++)c.append("file"+f,new Blob([i.images[f]],{type:"image/jpeg"}));v.send(c)}},A=function(i,a,n){v&&(v=null),v=new XMLHttpRequest,g=n;var r=t(i);if(r){var o={StartTime:new Date,Duration:null,FinishTime:null,message:""},s=i.serverParameters;v.addEventListener("load",function(t){if(i.timingInfo){o.FinishTime=new Date,o.Duration=(o.FinishTime-o.StartTime)/1e3;var n="Time: "+o.Duration+" seconds.";o.message=n}if(null==v||4!=v.readyState||200!=v.status){if(v.responseText.length>0){var r=new Error(v.responseText);return void e.report(g,r)}var r=new Error("The RTTI server may be offline or does not exist.");return void e.report(g,r)}a(this.response,o)}),v.addEventListener("error",function(t){if(0==v.status){var i=new Error("The RTTI server may be offline or does not exist.");return void e.report(g,i)}if(null==t.Message||"undefined"==t.Message){var i=new Error("The RTTI server may be offline or does not exist.");return void e.report(g,i)}var i=new Error(t.Message);return void e.report(g,i)}),v.open("POST",i.url,!0),v.setRequestHeader("Accept","application/json");var l=new FormData;if(s)for(var c in s)s.hasOwnProperty(c)&&l.append(c,s[c]);for(var u=0;u<i.images.length;u++)l.append("file"+u,new Blob([i.images[u]],{type:"image/jpeg"}));v.send(l)}},P=function(e,t,a){return i(e,t,a)},E=function(t,a,n){p=t;var r=u(t,n);if(r){C=new Date;var o=function(t){if(m=d(t),null===m||"undefined"==typeof m){var i=new Error("Session id is not defined.");return void e.report(errorCallBackForKTA,i)}var r=L(p);j(r,function(e){O(e,a,n)},function(e){n(e)})},s=function(t){var i=new Error(t);e.report(n,i)};if("undefined"!=typeof p.serverParameters.sessionId&&null!=p.serverParameters.sessionId){m=p.serverParameters.sessionId;var l=L(p);j(l,function(e){O(e,a,n)},function(e){n(e)})}else i(t,o,s)}},I=function(t,a,n){p=t;var r=u(t,n);if(r){C=new Date;var o=function(t){if(m=d(t),null===m||"undefined"==typeof m){var i=new Error("Session id is not defined.");return void e.report(n,i)}var r=_(p);j(r,function(e){x(e,a,n)},function(e){n(e)})},s=function(t){var i=new Error(t);e.report(n,i)};if("undefined"!=typeof p.serverParameters.sessionId&&null!=p.serverParameters.sessionId){m=p.serverParameters.sessionId;var l=_(p);j(l,function(e){x(e,a,n)},function(e){n(e)})}else i(t,o,s)}},_=function(e){delete e.serverParameters.sessionId;var t=n(),i=t.jobWithDocsInitialization,a=i.Documents;U(e.images,a[0].PageDataList),t.sessionId=m,t.processIdentity.Name=e.serverParameters.processIdentityName,e.serverParameters.ktaDeleteDocument&&"YES"===e.serverParameters.ktaDeleteDocument?t.jobWithDocsInitialization.StoreFolderAndDocuments=!1:t.jobWithDocsInitialization.StoreFolderAndDocuments=!0,F(e);for(var r=i.InputVariables,o=Object.keys(e.serverParameters),s=0;s<o.length;s++){var l={Value:e.serverParameters[o[s]],Id:o[s]};r.push(l)}var c={url:e.url+y,serverParameters:t};return c},x=function(t,i,a){if(!G(t,a,!1)){var n=D(t);if(null==n){var r=new Error("Authentication Results not found in Server response");return void e.report(a,r)}var o=N(p);null!=o?i(n,o):i(n,null)}},D=function(e){var t=k(e),i=r(t);if(null==i)return null;var a=o(e),n={authenticationResponse:i,extractionResponse:a};return n},M=function(e,t,i){p=e;var a=u(e,i);if(a&&(C=new Date,"undefined"!=typeof p.serverParameters.sessionId&&null!=p.serverParameters.sessionId)){m=p.serverParameters.sessionId;var n=L(p);j(n,function(e){R(e,t)},function(e){i(e)})}},L=function(e){delete e.serverParameters.sessionId;var t=l(),i=t.jobWithDocsInitialization,a=i.Documents;U(e.images,a[0].PageDataList),t.sessionId=m,t.processIdentity.Name=e.serverParameters.processIdentityName,e.serverParameters.ktaDeleteDocument&&"YES"===e.serverParameters.ktaDeleteDocument?t.jobWithDocsInitialization.Documents[0].DeleteDocument=!0:t.jobWithDocsInitialization.Documents[0].DeleteDocument=!1,F(e);for(var n=i.InputVariables,r=Object.keys(e.serverParameters),o=0;o<r.length;o++){var s={Value:e.serverParameters[r[o]],Id:r[o]};n.push(s)}var c={url:e.url+y,serverParameters:t};return c},R=function(e,t){var i=N(p);t(e,i)},O=function(t,i,a){var n=h(t);if(null===n||"undefined"==typeof n){var r=new Error("Document id is not defined.");return void e.report(a,r)}if(!G(t,a,!0)){var o=c(t),s=N(p);return void(null!=s?i(o,s):i(o))}},k=function(e){var t=e.d;return null===t||"undefined"===t?null:t.ReturnedDocumentFields[0].ReturnedDocumentFields},G=function(t,i,a){var n=k(t);if(null==n)return!0;for(var r=0;r<n.length;r++)if(n[r].Name==w&&a||n[r].Name==b){var o=n[r].Value;if(null!=o){var s;if("string"==typeof o){if(0===o.length)return!1;s=JSON.parse(o)}else s=o;var l=new Error(a?s.errordescription:s.ErrorMessage);return e.report(i,l),!0}return!1}return!1},F=function(e){delete e.serverParameters.processIdentityName,delete e.serverParameters.username,delete e.serverParameters.password,delete e.serverParameters.documentGroupName,delete e.serverParameters.documentName,delete e.serverParameters.ktaDeleteDocument},U=function(e,t){for(var i=0;i<e.length;i++){var a={Data:null,Base64Data:e[i],RuntimeFields:{},MimeType:"image/jpeg"};t.push(a)}},j=function(t,i,a){v&&(v=null),v=new XMLHttpRequest;var n,r=t.serverParameters;v.addEventListener("load",function(t){if(null==v||4!=v.readyState||200!=v.status){if(v.responseText.length>0){var r=new Error(v.responseText);return void e.report(a,r)}var r=new Error("The KTA server may be offline or does not exist.");return void e.report(a,r)}try{n=JSON.parse(this.response)}catch(o){n=null}if(null==n){var r=new Error("We didn't receive a valid server response.");return void e.report(a,r)}if(n.exceptionMessage||n.Message&&n.Message.length>0){var r=new Error(n.Message);return void e.report(a,r)}"function"==typeof i&&i(n)}),v.addEventListener("error",function(t){if(0==v.status){var i=new Error("The KTA server may be offline or does not exist.");return void e.report(a,i)}if(null==t.Message||"undefined"==t.Message){var i=new Error("The KTA server may be offline or does not exist.");return void e.report(a,i)}var i=new Error(t.Message);return void e.report(a,i)}),v.open("POST",t.url,!0),v.setRequestHeader("Accept","application/json"),v.setRequestHeader("Content-Type","application/json;charset=utf-8"),v.timeout=6e4,v.ontimeout=function(){var t=new Error("Session Timeout occurred.");e.report(a,t)},v.send(JSON.stringify(r))},N=function(e){var t=null;if(p.timingInfo){t={StartTime:C,Duration:null,FinishTime:null,message:""},t.FinishTime=new Date,t.Duration=(t.FinishTime-t.StartTime)/1e3;var i="Time: "+t.Duration+" seconds.";t.message=i}return t},B=function(){v&&null!=v&&(v.abort(),v=null)};return{extractWithRttiServer:T,performExtractionWithRttiServer:A,loginToKTAServer:P,authenticateIDWithKtaServer:I,extractWithKtaServer:E,executeRequestOnKtaServer:M,cancelExtraction:B}}(),function(){"use strict";function t(e,t,i){if(this.screenWidth=e,this.screenHeight=t,this.screenSquare=this.screenWidth*this.screenHeight,this.padding=i.framePadding,this.aspectRatio=i.frameAspectRatio,this.color=i.frameCornerColor,this.transparency=i.outOfFrameTransparency,this.cornerWidth=i.frameCornerWidth,this.cornerHeight=i.frameCornerHeight,0===this.aspectRatio)this.x=this.padding*this.screenWidth/100,this.y=this.padding*this.screenHeight/100,this.width=this.screenWidth-2*this.x,this.height=this.screenHeight-2*this.y;else{var a=this.padding*this.screenWidth/100,n=this.padding*this.screenHeight/100,r=(this.screenWidth-this.aspectRatio*this.screenHeight)/2,o=a,s=(o-r)/this.aspectRatio,l=this.screenWidth-2*o,c=this.screenHeight-2*s,u=o>=0&&s>=n&&l>0&&c>0,f=l*c,h=n,d=r+h*this.aspectRatio,p=this.screenWidth-2*d,m=this.screenHeight-2*h,g=d>=a&&h>=0&&p>0&&m>0,v=p*m;if(u&&g)this.x=f>v?o:d,this.y=f>v?s:h,this.width=f>v?l:p,this.height=f>v?c:m;else if(u&&!g)this.x=o,this.y=s,this.width=l,this.height=c;else{if(u||!g)throw Error("Aspect ratio "+this.aspectRatio+" and padding "+this.padding+" are incorrect");this.x=d,this.y=h,this.width=p,this.height=m}}this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=Math.round(this.width),this.height=Math.round(this.height),this.mx=this.x+this.width/2,this.my=this.y+this.height/2,this.square=this.width*this.height;var S=this.x,y=this.y,w=S+this.width,b=y+this.height,C=this.screenWidth,T=this.screenHeight,A=this.cornerWidth,P=this.cornerHeight,E=S-P,I=y-P,_=A-P,x=w-_,D=b-_;this.boostParamsForOutOfFrameRender=[[0,0,S,T],[S,0,C,y],[C-S,y,S,T],[S,T-y,C-2*S,y]],this.boostParamsForFrameCornersRender=[[E,I,A,P],[E,I,P,A],[x,I,A,P],[w,I,P,A],[E,D,P,A],[E,b,A,P],[x,b,A,P],[w,D,P,A]]}function i(e,t){for(var i=0;i<t.length;i++)e.fillRect.apply(e,t[i])}t.prototype.getTargetFrameCropData=function(t,i){var a,n,r=Math.sqrt(t*i/this.screenSquare),o=e.GeneralSettings.getSettingsForRealTimeEdgeDetection().targetFrameCropEvrsPadding,s=Math.floor(r*this.x-o),l=Math.floor(r*this.y-o);if(s<0||l<0)s=0,l=0,a=t,n=i;else{var c=2*o;a=Math.ceil(r*this.width+c),n=Math.ceil(r*this.height+c)}return[s,l,a,n]},t.prototype.draw=function(t,a){t.beginPath(),t.fillStyle="#000000",t.globalAlpha=this.transparency,i(t,this.boostParamsForOutOfFrameRender),t.globalAlpha=1,a===e.Hints.HOLD_STEADY||a===e.Hints.CAPTURE_OK?(t.strokeStyle=this.color,t.lineWidth=this.cornerHeight,t.rect(this.x,this.y,this.width,this.height)):(t.fillStyle=this.color,i(t,this.boostParamsForFrameCornersRender)),t.closePath(),t.stroke()},e.Frame=t}(),e.Guidance=function(){"use strict";function t(t){(t.square<K||0===C&&t.ratio>W||C>0&&Math.abs(t.ratio-C)>z)&&l(e.Hints.FILL_AREA)}function i(t){for(var i,a,n,r=0;r<t.length;r++)if(i=t.get(r),a=i[0],n=i[1],a<B||a>H||n<B||n>V){l(e.Hints.FILL_AREA);break}}function a(t){(Math.abs(P-t.mx)>I||Math.abs(E-t.my)>_)&&l(e.Hints.CENTER)}function n(t){M/t.square<q.minFillFraction&&l(e.Hints.ZOOM_OUT)}function r(t){if(M/t.square>q.maxFillFraction)return void l(e.Hints.ZOOM_IN);var i=q.longAxisThreshold,a=q.shortAxisThreshold;if(0!==i||0!==a){var n=0!==i&&t["long"]>=x,r=0!==a&&t["short"]>=D;n||r||l(e.Hints.ZOOM_IN)}}function o(t){if(!t.isSquareShape&&90!==q.turnSkewAngleTolerance){var i=Math.abs(t.angle)%180;i=Math.min(i,180-i);var a=A>T?90-i:i;a>q.turnSkewAngleTolerance&&l(e.Hints.ROTATE)}}function s(){ie&&(45!==q.pitchThreshold&&te>q.pitchThreshold&&l(e.Hints.HOLD_LEVEL),45!==q.rollThreshold&&ee>q.rollThreshold&&l(e.Hints.HOLD_LEVEL))}function l(t){if(void 0===Q[t]?Q[t]=1:Q[t]++,U=!0,N<X)N++;else{var i,a=0;for(var n in Q)Q.hasOwnProperty(n)&&a<Q[n]&&(a=Q[n],i=n);i===e.Hints.HOLD_STEADY?void 0===j&&(j=setTimeout(function(){i=e.Hints.CAPTURE_OK,e.CaptureEventAppStats.logCaptureGuidanceEvents(i,"",1),F(i),c(),j=void 0},q.captureTimeout)):(clearTimeout(j),j=void 0),e.CaptureEventAppStats.logCaptureGuidanceEvents(i,"",1),F(i),c()}}function c(){Q={},N=1}function u(t){e.Utils.validateOptions(t,Z)}function f(){return e.Utils.getOptions(q)}function h(){return e.Utils.getOptions(Y)}function d(t){u(t),e.Utils.setOptions(q,t,Y)}function p(){e.Utils.resetOptions(q,Y)}function m(e){F=e,ae.addListener(oe)}function g(){F=void 0,ae.removeListener(oe)}function v(e,t){void 0!==t&&e.drawImage(J[t],L,R,O,O)}function S(){for(var e in J)if(J.hasOwnProperty(e)){var t=J[e],i=t.getContext("2d");i.clearRect(0,0,t.width,t.height),i=null,t=null}J={},G=void 0}function y(t){void 0===G&&(G={},G[e.Hints.FILL_AREA]="fit-document.png",G[e.Hints.ZOOM_IN]="zoom-in.png",G[e.Hints.ZOOM_OUT]="zoom-out.png",G[e.Hints.CENTER]="center.png",G[e.Hints.ROTATE]="rotate.png",G[e.Hints.HOLD_LEVEL]="hold-parallel.png",G[e.Hints.HOLD_STEADY]="hold-steady.png",G[e.Hints.CAPTURE_OK]="done.png");var i=0,a={},n=Object.keys(G).length;for(var r in G)if(G.hasOwnProperty(r)){var o=new Image;o.src=e.Utils.getImageUrl(G[r]);var s=function(r,o){return function(){var s=e.ImageUtils.createEmptyCanvas(O,O),l=s.getContext("2d"),c=O/2;l.beginPath(),l.globalAlpha=k,l.arc(c,c,c-2,0,2*Math.PI),l.fillStyle="#000000",l.fill(),l.globalAlpha=1,l.globalCompositeOperation="source-over",l.drawImage(o,0,0,O,O),l.closePath(),J[r]=s,i++,o.removeEventListener("load",a[r]),delete a[r],i===n&&t()}}(r,o);a[r]=s,o.addEventListener("load",s)}}e.Hints={FILL_AREA:"0",ZOOM_IN:"1",ZOOM_OUT:"2",CENTER:"3",ROTATE:"4",HOLD_LEVEL:"5",HOLD_STEADY:"6",CAPTURE_OK:"7"};var w,b,C,T,A,P,E,I,_,x,D,M,L,R,O,k,G,F,U,j,N,B,H,V,W,z,K,X,q={minFillFraction:.65,maxFillFraction:1.8,longAxisThreshold:85,shortAxisThreshold:60,centerToleranceFraction:.19,captureTimeout:1700,turnSkewAngleTolerance:10,pitchThreshold:15,rollThreshold:15},Y={minFillFraction:.65,maxFillFraction:1.8,longAxisThreshold:85,shortAxisThreshold:60,centerToleranceFraction:.19,captureTimeout:1700,turnSkewAngleTolerance:10,pitchThreshold:15,rollThreshold:15},Z={minFillFraction:{type:"number",min:{value:0,include:!1},max:{value:1,include:!1}},maxFillFraction:{type:"number",min:{value:1,include:!1}},longAxisThreshold:{type:"number",min:{value:0,include:!0},max:{value:100,include:!0}},shortAxisThreshold:{type:"number",min:{value:0,include:!0},max:{value:100,include:!0}},centerToleranceFraction:{type:"number",min:{value:0,include:!1},max:{value:1,include:!1}},captureTimeout:{type:"number",min:{value:0,include:!1}},turnSkewAngleTolerance:{type:"number",min:{value:0,include:!0},max:{value:90,include:!0}},pitchThreshold:{type:"number",min:{value:0,include:!0},max:{value:45,include:!0}},rollThreshold:{type:"number",min:{value:0,include:!0},max:{value:45,include:!0}}},J={},Q={},$=[t,i,s,o,n,a,r],ee=0,te=0,ie=!1,ae=new e.LevelSensor,ne=function(t,i,a,n){w=t.screenWidth,b=t.screenHeight,T=t.width,A=t.height,P=t.mx,E=t.my,M=t.square;var r=O!==a.guidanceSize||k!==a.outOfFrameTransparency;O=a.guidanceSize,k=a.outOfFrameTransparency,L=(w-O)/2,R=(b-O)/2,c();var o=e.GeneralSettings.getSettingsForRealTimeEdgeDetection();return B=i*o.outOfScreenDownscaledPadding,H=w-B,V=b-B,I=T*q.centerToleranceFraction,_=A*q.centerToleranceFraction,x=Math.max(T,A)*q.longAxisThreshold/100,D=Math.min(T,A)*q.shortAxisThreshold/100,C=e.Math.getLongToShortAspectRatio(t.aspectRatio),W=o.maxRatioThreshold,z=o.maxRatioDeviationThreshold,K=M*o.minSquareThreshold,X=o.maxGuidanceThreshold,r||void 0===G?void y(n):void n()},re=function(t){U=!1;var i=new e.Rectangle(t);for(var a in $)if($.hasOwnProperty(a)&&($[a](i),U))return;l(e.Hints.HOLD_STEADY)},oe=function(e){if(!ie){if(!e)return;ie=!0}te=Math.abs(e.beta),ee=Math.abs(e.gamma)};return{configure:ne,draw:v,processRectangle:re,processGuidance:l,clearGuidance:c,start:m,stop:g,getOptions:f,getDefaultOptions:h,setOptions:d,resetOptions:p,clearCanvases:S}}(),e.ImageProcessor=function(){"use strict";function t(t,r){var o=a(t),s=t.width,l=t.height,c=s>>4,u=.85,f=t.data,h=i(s,l),d=h.data,p=new Uint32Array(d.buffer),m=0,g=0,v=0;for(g=0;g<l;g++,v+=s)for(m=0;m<s;m++){var S=f[v+m<<2],y=Math.max(m-c,0),w=Math.max(g-c,0),b=Math.min(m+c,s-1),T=Math.min(g+c,l-1),A=(b-y+1)*(T-w+1),P=n(o,s,y,w,b,T);S*A>P*u?p[v+m]=4294967295:p[v+m]=4278190080}"function"==typeof r&&(e.ProcessEventAppStats.logAppStats({ProcessingProfile:C.BITONAL}),r(h))}function i(e,t){var i=document.createElement("canvas");return i.getContext("2d").createImageData(e,t)}function a(e){var t=e.data,i=e.width,a=e.height,n=new Int32Array(i*a),r=0,o=0,s=0,l=0;for(r=0;r<i;r++)l+=t[r<<2],n[r]=l;for(o=1,s=i;o<a;o++,s+=i)for(l=0,r=0;r<i;r++)l+=t[s+r<<2],n[s+r]=n[s-i+r]+l;return n}function n(e,t,i,a,n,r){var o=e[n+r*t];return a>0&&(o-=e[n+(a-1)*t],i>0&&(o+=e[i-1+(a-1)*t])),i>0&&(o-=e[i-1+r*t]),o}var r,o=1024,s=1048576,l=function(t,i,a){e.Utils.verifyImageData("imageData",t);var n=t.width,r=t.height,o=new jsfeat.matrix_t(n,r,jsfeat.U8_t|jsfeat.C1_t),s=jsfeat.COLOR_RGBA2GRAY;jsfeat.imgproc.grayscale(t.data,n,r,o,s);for(var l=new Uint32Array(t.data.buffer),c=255<<24,u=o.cols*o.rows,f=0;--u>=0;)f=o.data[u],l[u]=c|f<<16|f<<8|f;i(t)},c=function(t,i,a){e.Utils.verifyImageData("imageData",t),r=i,e.ProcessEventAppStats.logProcessStartTime(C.BITONAL),l(t,f,a)},u=function(t,i,a,n){e.Utils.verifyImageData("imageData",t),e.ProcessEventAppStats.logProcessStartTime(C.SETDPI),e.Utils.validateOptions(i,{dpi:{mandatory:!0,type:"number",min:{value:0,include:!1}}});var r=t.width,o=t.height,s=document.createElement("canvas"),l=s.getContext("2d");s.width=r,s.height=o,l.putImageData(t,0,0);var c=s.toDataURL("image/jpeg"),u={};u[piexif.ImageIFD.XResolution]=[i.dpi,1],u[piexif.ImageIFD.YResolution]=[i.dpi,1];var f={"0th":u},h=piexif.dump(f),d=piexif.insert(h,c);return e.ProcessEventAppStats.logAppStats({ProcessingProfile:C.SETDPI}),a(d)},f=function(e){t(e,r)},h=function(t,i,a,n){e.Utils.verifyImageData("imageData",t),e.ProcessEventAppStats.logProcessStartTime(C.AUTOCROP);for(var r=[],o=Object.keys(KfxWebSDK.document),s=0;s<o.length;s++)r.push(KfxWebSDK.document[o[s]]);e.Utils.validateOptions(i,{type:{type:"number",options:r,mandatory:!0}});var l=[KfxWebSDK.document.MOBILE_ID,KfxWebSDK.document.CHECK_DEPOSIT,KfxWebSDK.document.PASSPORT];if(l.indexOf(i.type)<0)return void a(t);var c=new e.CannyDetector(t,i.type),u=c.process();e.ProcessEventAppStats.logAppStats({ProcessingProfile:C.AUTOCROP}),a(u)},d=function(t,i,a,n){e.Utils.verifyImageData("imageData",t),e.ProcessEventAppStats.logProcessStartTime(C.SCALE),e.Utils.validateOptions(i,{scaleMegapixels:{mandatory:!0,type:"number",min:{value:0,include:!1}}});var r=1,l=i.scaleMegapixels,c=t.width,u=t.height,f=c,h=u;if(l){var d=f*h/s;r=d<=l?1:Math.sqrt(l/d)}if(1===r)return void a(t);f*=r,h*=r;for(var p=e.ImageUtils.createEmptyCanvas(f,h),m=p.getContext("2d"),g=o,v=e.ImageUtils.createEmptyCanvas(g,g),S=v.getContext("2d"),y=Math.ceil(g*f/c),w=Math.ceil(g*h/u),b=0,T=0,A=0,P=0;b<u;){for(A=0,P=0;A<c;)S.clearRect(0,0,g,g),S.putImageData(t,-A,-b),m.drawImage(v,0,0,g,g,P,T,y,w),A+=g,P+=y;b+=g,T+=w}var E=m.getImageData(0,0,f,h);e.ProcessEventAppStats.logAppStats({ProcessingProfile:C.SCALE}),a(E)};return{processImageToBitonal:c,autoCrop:h,scaleImage:d,changeDPIForImage:u}}(),function(){"use strict";function t(e,t,i){if(this.screenWidth=e,this.screenHeight=t,this.screenSquare=this.screenWidth*this.screenHeight,this.padding=i.framePadding,this.aspectRatio=i.frameAspectRatio,this.color=i.frameColor,this.transparency=i.outOfFrameTransparency,this.outOfFrameColor=i.outOfFrameColor,this.frameThickness=i.frameThickness,0===this.aspectRatio)this.x=this.padding*this.screenWidth/100,this.y=this.padding*this.screenHeight/100,this.width=this.screenWidth-2*this.x,this.height=this.screenHeight-2*this.y;else{var a=this.padding*this.screenWidth/100,n=this.padding*this.screenHeight/100,r=(this.screenWidth-this.aspectRatio*this.screenHeight)/2,o=a,s=(o-r)/this.aspectRatio,l=this.screenWidth-2*o,c=this.screenHeight-2*s,u=o>=0&&s>=n&&l>0&&c>0,f=l*c,h=n,d=r+h*this.aspectRatio,p=this.screenWidth-2*d,m=this.screenHeight-2*h,g=d>=a&&h>=0&&p>0&&m>0,v=p*m;if(u&&g)this.x=f>v?o:d,this.y=f>v?s:h,this.width=f>v?l:p,this.height=f>v?c:m;else if(u&&!g)this.x=o,this.y=s,this.width=l,this.height=c;else{if(u||!g)throw Error("Aspect ratio "+this.aspectRatio+" and padding "+this.padding+" are incorrect");this.x=d,this.y=h,this.width=p,this.height=m}}this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=Math.round(this.width),this.height=Math.round(this.height),this.mx=this.x+this.width/2,this.my=this.y+this.height/2,this.square=this.width*this.height,this.radiusX=this.width/2,this.radiusY=this.height/2,this.square=this.width*this.height,this.rotation=0,this.start=0,this.end=2*Math.PI,this.clockwise=!1}function i(e,t,i,a,n,r,o,s,l){e.ellipse(t,i,a,n,r,o,s,l)}t.prototype.draw=function(t,a,n,r){t.beginPath(),t.globalAlpha=this.transparency,t.fillStyle=this.outOfFrameColor,t.fillRect(0,0,this.screenWidth,this.screenHeight),t.globalAlpha=1,a===e.SelfieHints.HOLD_STEADY||a===e.SelfieHints.CAPTURE_OK||a===e.SelfieHints.BLINK_NOW&&n>=4&&r===e.SelfieHints.BLINK_NOW?(t.strokeStyle="#00FF00",t.lineWidth=this.frameThickness,i(t,this.mx,this.my,this.radiusX,this.radiusY,this.rotation,this.start,this.end,this.clockwise)):(t.strokeStyle=this.color,t.lineWidth=this.frameThickness,i(t,this.mx,this.my,this.radiusX,this.radiusY,this.rotation,this.start,this.end,this.clockwise)),t.globalCompositeOperation="destination-out",t.fill(),t.globalCompositeOperation="source-over",t.stroke(),t.closePath()},e.SelfieFrame=t}(),e.SelfieGuidance=function(){"use strict";function t(t){P*j.minFaceSize>t.square?(Y(!1),n(e.SelfieHints.MOVE_CLOSER)):P<t.square&&(Y(!1),n(e.SelfieHints.MOVE_BACK))}function i(t){(Math.abs(b-t.mx)>T||Math.abs(C-t.my)>A)&&(Y(!1),n(e.SelfieHints.CENTER_FACE))}function a(){F.enableAutoCapture===!1?n(e.SelfieHints.BLINK_NOW):H||(k.blinkDetectedListener=function(){Y(!0),n(e.SelfieHints.HOLD_STEADY)},n(e.SelfieHints.BLINK_NOW))}function n(t){if(void 0===W[t]?W[t]=1:W[t]++,L=!0,O<U)O++;else{var i,a=0;for(var n in W)W.hasOwnProperty(n)&&a<W[n]&&(a=W[n],i=n);i===e.SelfieHints.HOLD_STEADY?void 0===R&&(R=setTimeout(function(){i=e.SelfieHints.CAPTURE_OK,e.SelfieCaptureEventAppStats.logSelfieCaptureGuidanceEvents(i,"",1),M(i),r(),R=void 0},j.captureTimeout)):(clearTimeout(R),R=void 0),e.SelfieCaptureEventAppStats.logSelfieCaptureGuidanceEvents(i,"",1),M(i),r()}}function r(){W={},O=1}function o(t){e.Utils.validateOptions(t,B)}function s(){return e.Utils.getOptions(j)}function l(){return e.Utils.getOptions(N)}function c(t){o(t),e.Utils.setOptions(j,t,N)}function u(){e.Utils.resetOptions(j,N)}function f(e){M=e}function h(){M=void 0,Y(!1)}function d(t,i,a){void 0!==G&&G===i?z+=1:z=0,G=i,void 0!==i&&z>=4&&i===e.SelfieHints.BLINK_NOW?p(t,a):void 0!==i&&(i===e.SelfieHints.CAPTURE_OK||z>=4)&&t.drawImage(V[i],E,I,_,_)}function p(e,t){var i=F.enableAutoCapture===!1?"Tap to capture":"Blink slowly";try{t[0]="20px",e.font=t.join(" ");var a=e.measureText(i),n=v-a.width>>1,r=C-(w>>1)-18;e.save(),e.fillStyle="#000000",e.fillRect(n-5,r-20,a.width+10,30),e.fillStyle="#FFFFFF",e.fillText(i,n,r)}finally{e.restore()}}function m(){for(var e in V)if(V.hasOwnProperty(e)){var t=V[e],i=t.getContext("2d");i.clearRect(0,0,t.width,t.height),i=null,t=null}V={},D=void 0}function g(t){void 0===D&&(D={},D[e.SelfieHints.CENTER_FACE]="center_face.png",D[e.SelfieHints.MOVE_CLOSER]="move_closer.png",D[e.SelfieHints.MOVE_BACK]="move_back_new.png",D[e.SelfieHints.BLINK_NOW]="blink_now.png",D[e.SelfieHints.HOLD_STEADY]="hold-steady.png",D[e.SelfieHints.CAPTURE_OK]="done.png");var i=0,a={},n=Object.keys(D).length;for(var r in D)if(D.hasOwnProperty(r))if(r!==e.SelfieHints.BLINK_NOW){var o=new Image;o.src=e.Utils.getImageUrl(D[r]);var s=function(r,o){return function(){var s=e.ImageUtils.createEmptyCanvas(_,_),l=s.getContext("2d"),c=_/2;l.beginPath(),l.globalAlpha=x,l.arc(c,c,c-2,0,2*Math.PI),l.fillStyle="#000000",l.fill(),l.globalAlpha=1,l.globalCompositeOperation="source-over",l.drawImage(o,0,0,_,_),l.closePath(),V[r]=s,i++,o.removeEventListener("load",a[r]),delete a[r],i===n&&t()}}(r,o);a[r]=s,o.addEventListener("load",s)}else i++}e.SelfieHints={CENTER_FACE:"0",MOVE_CLOSER:"1",MOVE_BACK:"2",BLINK_NOW:"3",HOLD_STEADY:"4",CAPTURE_OK:"5"};var v,S,y,w,b,C,T,A,P,E,I,_,x,D,M,L,R,O,k,G,F,U,j={minFaceSize:.5,centerToleranceFraction:.15,captureTimeout:1700},N={minFaceSize:.5,centerToleranceFraction:.15,captureTimeout:1700},B={minFaceSize:{type:"number",min:{value:0,include:!1},max:{value:1,include:!1}},centerToleranceFraction:{type:"number",min:{value:0,include:!1},max:{value:1,include:!1}},captureTimeout:{type:"number",min:{value:0,include:!1}}},H=!1,V={},W={},z=0,K=[t,i,a],X=function(t,i,a,n){v=t.screenWidth,S=t.screenHeight,k=i,y=t.width,w=t.height,b=t.mx,C=t.my,P=t.square,F=a;var o=_!==a.guidanceSize||x!==a.guidanceTransparency;_=a.guidanceSize,x=a.guidanceTransparency,E=(v-_)/2,I=(S-_)/2,r(),H=!1;var s=e.GeneralSettings.getSettingsForRealTimeEdgeDetection();return T=y*j.centerToleranceFraction,A=w*j.centerToleranceFraction,U=s.maxGuidanceThreshold,o||void 0===D?void g(n):void n()},q=function(t){
L=!1;var i=new e.Rectangle(t);for(var a in K)if(K.hasOwnProperty(a)&&(K[a](i),L))return;n(e.SelfieHints.HOLD_STEADY)},Y=function(e){H=e,k.blinkDetectedListener=null,k.state=0},Z=function(){return z},J=function(){return G};return{configure:X,draw:d,processRectangle:q,processGuidance:n,clearGuidance:r,start:f,stop:h,getOptions:s,getDefaultOptions:l,setOptions:c,resetOptions:u,resetBlinkDetection:Y,delay:Z,currentHint:J,clearCanvases:m}}();var E={APP_STATS_UNINITIALIZED:"APP_STATS_UNINITIALIZED",APP_STATS_INITIALIZING:"APP_STATS_INITIALIZING",APP_STATS_INITIALIZED:"APP_STATS_INITIALIZED",APP_STATS_RECORDING:"APP_STATS_RECORDING",APP_STATS_EXPORTING:"APP_STATS_EXPORTING",APP_STATS_BEGINNING_SESSION:"APP_STATS_BEGINNING_SESSION"},I={ERROR_STATS_ALLREADY_INIT:"App Stats Already Initialized",ERROR_STATS_NOT_INIT:"App Stats Not Initialized. Please initialize first",ERROR_STATS_ALLREADY_RECORDING:"App Stats Already started recording",ERROR_STATS_BEGIN_SESSION_NOT_ALLOWED:"App Stats begin session not allowed in this state",ERROR_STATS_STARTED_BEGIN_SESSION_NOT_ALLOWED:"App Stats Session Started , Please stop session first",ERROR_STATS_END_SESSION_NOT_ALLOWED:"App Stats end session not allowed in this state",ERROR_STATS_LOG_SESSION_NOT_ALLOWED:"App Stats log session not allowed in this state",ERROR_STATS_LOG_FIELDCHANGE_NOT_ALLOWED:"App Stats log field change event not allowed in this state",ERROR_STATS_EXPORT_NOT_ALLOWED:"App Stats export not allowed in this state",ERROR_STATS_NOT_ALLOWED:"App Stats not allowed in this state",ERROR_STATS_STOP_NOT_ALLOWED:"App Stats stop record not allowed in this state",ERROR_STATS_EMPTY_PARAMS:"Parameters should not be empty"},_={SESSION_LOGGED:"session logged",FIELD_CHANGE_LOGGED:"field change event logged"},x=E.APP_STATS_UNINITIALIZED,D=function(){return x};KfxWebSDK.AppStats=function(){"use strict";var a=!1,n=function(t,i){if(e.Utils.verifyCallbacks({successCallBack:t,errorCallBack:i}),x!==E.APP_STATS_UNINITIALIZED){var a=new e.StateError(I.ERROR_STATS_ALLREADY_INIT);return void e.report(i,a)}x=E.APP_STATS_INITIALIZING,e.AppStats.initAppStats(t,i)},r=function(t,i){if(e.Utils.verifyCallbacks({successCallBack:t,errorCallBack:i}),x===E.APP_STATS_UNINITIALIZED){var n=new e.StateError(I.ERROR_STATS_NOT_INIT);return void e.report(i,n)}if(x===E.APP_STATS_RECORDING||x===E.APP_STATS_BEGINNING_SESSION||x===E.APP_STATS_EXPORTING){var r=new e.StateError(I.ERROR_STATS_ALLREADY_RECORDING);return void e.report(i,r)}0==d.length&&d.push(e.AppStats.prepareEnvironment()),x=E.APP_STATS_RECORDING,a=!0,h=!0,"function"==typeof t&&t(x)},o=function(t,i){if(e.Utils.verifyCallbacks({successCallBack:t,errorCallBack:i}),x!==E.APP_STATS_RECORDING){var n=new e.StateError(I.ERROR_STATS_STOP_NOT_ALLOWED+" "+D());return void e.report(i,n)}x=E.APP_STATS_INITIALIZED,a=!1,h=!1,"function"==typeof t&&t(x)},s=function(){return h},l=function(a,n,r){e.Utils.verifyCallbacks({successCallBack:n,errorCallBack:r});try{if(x===E.APP_STATS_UNINITIALIZED||x===E.APP_STATS_INITIALIZED||x===E.APP_STATS_EXPORTING||x===E.APP_STATS_BEGINNING_SESSION){var o=new e.StateError(I.ERROR_STATS_BEGIN_SESSION_NOT_ALLOWED+" "+D());return void e.report(r,o)}e.Utils.validateOptions(a,{sessionkey:{type:"string",mandatory:!0},category:{type:"string",mandatory:!0}}),t=a.sessionkey,i=a.category,x=E.APP_STATS_BEGINNING_SESSION,e.AppStats.logSessionEvent("BeginSession","",""),"function"==typeof n&&n(x)}catch(s){e.report(r,s)}},c=function(t,i,a){e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a});try{if(x!==E.APP_STATS_BEGINNING_SESSION){var n=new e.StateError(I.ERROR_STATS_LOG_SESSION_NOT_ALLOWED+" "+D());return void e.report(a,n)}e.Utils.validateOptions(t,{sessionType:{type:"string",mandatory:!0},response:{type:"string",mandatory:!1}}),e.AppStats.logSessionEvent(t.sessionType,t.response,t.DocumentID),"function"==typeof i&&i(_.SESSION_LOGGED)}catch(r){e.report(a,r)}},u=function(a,n,r){e.Utils.verifyCallbacks({successCallBack:n,errorCallBack:r});try{if(x===E.APP_STATS_UNINITIALIZED||x===E.APP_STATS_INITIALIZED||x===E.APP_STATS_EXPORTING||x===E.APP_STATS_RECORDING){var o=new e.StateError(I.ERROR_STATS_END_SESSION_NOT_ALLOWED+" "+D());return void e.report(r,o)}e.Utils.validateOptions(a,{success:{type:"boolean",mandatory:!0},message:{type:"string",mandatory:!1}}),a.success?e.AppStats.logSessionEvent("SessionCompleteSuccess",a.message,a.DocumentID):e.AppStats.logSessionEvent("SessionCompleteError",a.message,""),t=null,i=null,x=E.APP_STATS_RECORDING,"function"==typeof n&&n(x)}catch(s){e.report(r,s)}},f=function(t,i){if(e.Utils.verifyCallbacks({successCallBack:t,errorCallBack:i}),x===E.APP_STATS_UNINITIALIZED||x===E.APP_STATS_RECORDING||x===E.APP_STATS_EXPORTING||x===E.APP_STATS_BEGINNING_SESSION){var a=new e.StateError(I.ERROR_STATS_EXPORT_NOT_ALLOWED+" "+D());return void e.report(i,a)}x=E.APP_STATS_EXPORTING,e.AppStats.exportAppStats(function(e){x=E.APP_STATS_INITIALIZED,t(e)},i)},p=function(t,i,a){e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a});try{if(x!==E.APP_STATS_RECORDING&&x!==E.APP_STATS_BEGINNING_SESSION){var n=new e.StateError(I.ERROR_STATS_LOG_FIELDCHANGE_NOT_ALLOWED+" "+D());return void e.report(a,n)}e.LogisticsEventAppStats.logAppStats(t),"function"==typeof i&&i(_.FIELD_CHANGE_LOGGED)}catch(r){e.report(a,r)}};return{initAppStats:n,startRecord:r,stopRecord:o,isRecording:s,beginSession:l,endSession:u,logSessionEvent:c,logFieldChangeEvent:p,exportAppStats:f}}(),KfxWebSDK.Capture=function(){"use strict";var t=!1,i=function(i,a,n){e.Utils.verifyCallbacks({successCallBack:a,errorCallBack:n});try{e.Utils.validateOptions(i,{useVideoStream:{mandatory:!0,type:"boolean"}}),e.AppStats.prepareInstance(T.CAPTURE);var r=function(r){t=r,t?(e.Utils.validateOptions(i,{preference:{mandatory:!0,type:"string",options:["camera","gallery"]}}),e.CaptureEventAppStats.logAppStats(A.CAPTURE_FALLBACK,"",1),e.CaptureFallback.configure(i,a,n)):(e.Utils.validateOptions(i,{containerId:{mandatory:!0,type:"string",html:{tag:"div",hasChild:!1}},preview:{type:"boolean"}}),e.CaptureEventAppStats.logAppStats(A.ADVANCE_CAPTURE,"",1),e.WebCapture.configure(i,a,n))};if(i.useVideoStream===!1)return void r(!0);KfxWebSDK.Utilities.supportsAutoCapture(function(){r(!i.useVideoStream)},function(){r(!0)})}catch(o){var s=function(){e.report(n,o)};h(s,s,!0)}},a=function(i,a,n){if(e.Utils.verifyCallbacks({successCallBack:a,errorCallBack:n}),!t)try{e.WebCapture.checkSetOptionsAllowed(),e.WebCapture.setOptions(i),a()}catch(r){e.report(n,r)}},n=function(t,i){e.Utils.verifyCallbacks({successCallBack:t,errorCallBack:i});var a=e.WebCapture.getOptions(),n=e.Guidance.getOptions(),r=a;r.criteria=n,t(r)},r=function(t,i){e.Utils.verifyCallbacks({successCallBack:t,errorCallBack:i});var a=e.WebCapture.getDefaultOptions(),n=e.Guidance.getDefaultOptions(),r=a;r.criteria=n,t(r)},o=function(i,a){if(e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a}),!t)try{e.WebCapture.capture(i,a)}catch(n){e.report(a,n)}},s=function(i,a){e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a});try{t?e.CaptureFallback.choosePicture(i,a):e.WebCapture.start(i,a,!1)}catch(n){e.report(a,n)}},l=function(i,a){e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a});try{t&&e.CaptureFallback.choosePictureAsBase64(i,a)}catch(n){e.report(a,n)}},c=function(i,a){if(e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a}),!t)try{e.WebCapture.start(i,a,!0)}catch(n){e.report(a,n)}},u=function(i,a){if(e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a}),!t)try{e.WebCapture.stop(i,a)}catch(n){e.report(a,n)}},f=function(t,i){e.Utils.verifyCallbacks({successCallBack:t,errorCallBack:i}),h(t,i,!0)},h=function(i,a,n){try{t?e.CaptureFallback.destroy():e.WebCapture.destroy(n),i()}catch(r){e.report(a,r)}};return{create:i,setOptions:a,getOptions:n,getDefaultOptions:r,takePicture:s,takePictureContinually:c,forceTakePicture:o,choosePictureAsBase64:l,stopCapture:u,destroy:f}}(),KfxWebSDK.DocumentExtractor=function(){"use strict";var t=function(t,i,a){e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a}),e.Extraction.extractWithRttiServer(t,i,a)},i=function(t,i,a){e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a}),e.Extraction.performExtractionWithRttiServer(t,i,a)},a=function(t,i,a){e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a}),e.Extraction.loginToKTAServer(t,i,a)},n=function(t,i,a){e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a}),e.Extraction.authenticateIDWithKtaServer(t,i,a)},r=function(t,i,a){e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a}),e.Extraction.extractWithKtaServer(t,i,a)},o=function(t,i,a){e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a}),e.Extraction.executeRequestOnKtaServer(t,i,a)},s=function(){e.Extraction.cancelExtraction()};return{extractionWithRttiServer:t,performExtractionWithRttiServer:i,loginToKTAServer:a,extractionWithKtaServer:r,authenticateIDWithKtaServer:n,executeRequestOnKtaServer:o,cancelExtraction:s}}(),KfxWebSDK.ImageProcessor=function(){"use strict";var t=function(t,i,a){e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a});try{e.ImageProcessor.processImageToBitonal(t,i,a)}catch(n){e.report(a,n)}},i=function(t,i,a,n){if(e.Utils.verifyCallbacks({successCallBack:a,errorCallBack:n}),e.Utils.isClassInstance(t,"HTMLImageElement"))return void e.report(n,new e.ValidationError("HTMLImageElement is deprecated, use ImageData instead"));try{e.ImageProcessor.scaleImage(t,i,a,n)}catch(r){e.report(n,r)}},a=function(t,i,a,n){e.Utils.verifyCallbacks({successCallBack:a,errorCallBack:n});try{e.ImageProcessor.autoCrop(t,i,a,n)}catch(r){e.report(n,r)}},n=function(t,i,a,n){e.Utils.verifyCallbacks({successCallBack:a,errorCallBack:n});try{e.ImageProcessor.changeDPIForImage(t,i,a,n)}catch(r){e.report(n,r)}};return{bitonal:t,autoCrop:a,scale:i,setDPI:n}}(),function(){"use strict";function t(t){e.Utils.validateOptions({containerId:t},{containerId:{type:"string",html:{tag:"div"}}}),this.containerId=t,this.container=document.getElementById(this.containerId),this.isActive=!1;var i=e.Utils.createElement,n=i("div","kfx-layout kfx-review"),r=i("div","kfx-content"),o=i("canvas","kfx-image"),s=new a;r.appendChild(o),n.appendChild(r),n.appendChild(s.element),this.element=n,this.canvas=o,this.toolbarView=s}function i(t,i){for(var a=e.Utils.toggleElement,n=0;n<t.children.length;n++)a(t.children[n],i)}function a(){function t(e){var t=i("button","kfx-button "+e),a=i("div","kfx-text");return t.appendChild(a),t}var i=e.Utils.createElement,a=i("div","kfx-toolbar"),n=t("kfx-accept");a.appendChild(n);var r=t("kfx-retake");a.appendChild(r),this.element=a,this.acceptButton=n,this.retakeButton=r}t.prototype.review=function(t,a,n){e.Utils.verifyArgument("imageData",t,"ImageData"),e.Utils.verifyCallbacks({acceptCallBack:a,retakeCallBack:n}),i(this.container,!1);var r=this.canvas;r.width=t.width,r.height=t.height;var o=r.getContext("2d");o.putImageData(t,0,0);var s=this.element;this.container.appendChild(s);var l=this.toolbarView,c=function(){l.acceptButton.removeEventListener("click",h),l.retakeButton.removeEventListener("click",d)},u=this,f=function(){o.clearRect(0,0,this.canvas.width,this.canvas.height);var e=document.getElementById(this.containerId);e&&(e.removeChild(s),i(e,!0)),u.isActive=!1},h=function(){l.acceptButton.classList.contains("kfx-next")||c.call(u);try{a()}finally{l.acceptButton.classList.contains("kfx-next")?l.acceptButton.classList.remove("kfx-next"):f.call(u)}},d=function(){c.call(u);try{n()}finally{f.call(u)}};l.acceptButton.addEventListener("click",h),l.retakeButton.addEventListener("click",d),u.isActive=!0},a.prototype.disable=function(){e.Utils.toggleClass(this.element,"kfx-invisible",!0)},a.prototype.enable=function(){e.Utils.toggleClass(this.element,"kfx-invisible",!1)},KfxWebSDK.ReviewControl=t}(),KfxWebSDK.SelfieCapture=function(){"use strict";var t=!1,i=function(i,a,n){e.Utils.verifyCallbacks({successCallBack:a,errorCallBack:n});try{e.Utils.validateOptions(i,{videoStream:{mandatory:!0,type:"boolean"}}),e.AppStats.prepareInstance(T.SELFIE_CAPTURE);var r=function(r){if(t=r){if(e.Utils.isMobileOrTablet()===!1)throw{message:"Your device does not have camera support",code:KfxWebSDK.ERROR_CODE_SELFIECAPTURE};e.SelfieCaptureEventAppStats.logAppStats(P.SELFIE_FALLBACK,"",1),e.SelfieCaptureFallback.configure(i,a,n)}else e.Utils.validateOptions(i,{containerId:{mandatory:!0,type:"string",html:{tag:"div",hasChild:!1}},preview:{type:"boolean"}}),e.SelfieCaptureEventAppStats.logAppStats(P.ADVANCE_CAPTURE,"",1),e.SelfieCapture.configure(i,a,n)};if(i.videoStream===!1)return void r(!0);KfxWebSDK.Utilities.supportsSelfieCapture(function(){r(!i.videoStream)},function(){r(!0)})}catch(o){var s=function(){e.report(n,o)};f(s,s,!0)}},a=function(i,a,n){if(e.Utils.verifyCallbacks({successCallBack:a,errorCallBack:n}),!t)try{e.SelfieCapture.checkSetOptionsAllowed(),e.SelfieCapture.setOptions(i),a()}catch(r){e.report(n,r)}},n=function(i,a){if(e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a}),!t){var n=e.SelfieCapture.getOptions(),r=e.SelfieGuidance.getOptions(),o=n;o.criteria=r,i(o)}},r=function(t,i){e.Utils.verifyCallbacks({successCallBack:t,errorCallBack:i});var a=e.SelfieCapture.getDefaultOptions(),n=e.SelfieGuidance.getDefaultOptions(),r=a;r.criteria=n,t(r)},o=function(i,a){e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a});try{t?e.SelfieCaptureFallback.choosePicture(i,a):e.SelfieCapture.start(i,a)}catch(n){e.report(a,n)}},s=function(i,a){if(e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a}),!t)try{e.SelfieCapture.capture(i,a)}catch(n){e.report(a,n)}},l=function(i,a){if(e.Utils.verifyCallbacks({successCallBack:i,errorCallBack:a}),!t)try{e.SelfieCapture.stop(i,a)}catch(n){e.report(a,n)}},c=function(t,i,a){e.Utils.verifyCallbacks({successCallBack:t,errorCallBack:i});try{e.SelfieCapture.loadModels(t,i,a)}catch(n){e.report(i,n)}},u=function(t,i){e.Utils.verifyCallbacks({successCallBack:t,errorCallBack:i}),f(t,i,!0)},f=function(i,a,n){try{t?e.SelfieCaptureFallback.destroy():e.SelfieCapture.destroy(n),i()}catch(r){e.report(a,r)}};return{create:i,setOptions:a,getOptions:n,getDefaultOptions:r,takeSelfie:o,forceTakeSelfie:s,stopCapture:l,destroy:u,loadModels:c}}(),KfxWebSDK.Utilities=function(){"use strict";function t(){if(void 0!==u)return u;if(!i())return!1;if(!a())return!1;var e,t,n=l,r=window.navigator.userAgent;r=r.substring(0,r.indexOf(" AppleWebKit"));for(var o in n)if(n.hasOwnProperty(o)){e=n[o];for(var s in e)if(e.hasOwnProperty(s)){t=e[s];for(var c=0;c<t.length;c++)if(r.indexOf(t[c])>=0)return!1}}return!0}function i(){return window.location.protocol.indexOf("https")>=0}function a(){var t=window.navigator,i=t.getUserMedia;return t.mediaDevices&&(i=t.mediaDevices.getUserMedia||t.mediaDevices.mozGetUserMedia||t.mediaDevices.webkitGetUserMedia||t.mediaDevices.msGetUserMedia),e.Type.isFunction(i)}function n(){if(void 0!==s)return s;if(!i())return!1;var t=e.Utils.getDeviceDetails();if("Android"===t.os.name&&t.os.version<4.5)return!1;if(!a())return!1;var n,r,o=c,l=window.navigator.userAgent;l=l.substring(0,l.indexOf(" AppleWebKit"));for(var u in o)if(o.hasOwnProperty(u)){n=o[u];for(var f in n)if(n.hasOwnProperty(f)){r=n[f];for(var h=0;h<r.length;h++)if(l.indexOf(r[h])>=0)return!1}}return!0}function r(t,i){if(null!==f&&f===!0)return void t();if(null!==h)return void(h?t:i)();if(s=n(),!s)return void i();var a=new e.UserMediaManager(document.createElement("video")),r=function(){a.destroy(),a=null,h=!0,t()},o=function(){a.destroy(),a=null,h=!1,i()};a.configureForSelfie(r,o)}function o(i,a){if(null!==f)return void(f?i:a)();if(!t())return f=!1,void a();var n=new e.UserMediaManager(document.createElement("video")),r=function(){n.destroy(),n=null,f=!0,i()},o=function(){n.destroy(),n=null,f=!1,a()};n.configure(r,o)}var s,l={Samsung:{"Galaxy S2":["GT-I9100","SPH-D710","SC-02C","SC-03D","Galaxy S2","GT-I9100G","GT-I9100T","GT-I9210T","GT-I9100M","SGH-I757M","SGH-I727R","SGH-I927","SGH-T989D","GT-I9108","GT-I9100G","SCH-I929","GT-I9100P","ISW11SC","SHW-M250K","SHW-M250L","SHW-M250S","SGH-I777","SGH-I727","SGH-I927","SCH-R760"],"Galaxy S3":["GT-I9300","GT-I9305","SC-06D","SC-03E","Galaxy S3","SHV-E210K","SHV-E210L","SHV-E210S","SGH-T999","SGH-T999L","SGH-I747","SGH-N064","SGH-N035","SCH-J021","SCH-R530","SCH-I535","SCH-S960L","SCH-S968C","GT-I9308","SCH-I939"],"Galaxy Note 3":["SM-N900","GT-N9000","SCL22","SC-01F","SM-W900W8","SM-N9005","SM-N9002","SM-N9006","SM-N900A","SM-N900T","SM-N900P","SM-N900V","SM-N900R4"],"Galaxy S4":["GT-I9505","GT-I9500","GT-I9515","GT-I9506","GT-I9502","SCH-I545","SPH-L720","SGH-M919","SGH-I337","SHV-E300","SC-04E","GT-I9192","SGH-i337","Galaxy S4","SHV-E300K","SHV-E300L","SHV-E300S","SHV-E330K","SHV-E330L","SHV-E330S","GT-I9505","GT-I9506","GT-I9505G","SGH-I337","SGH-M919","SCH-I545","SPH-L720","SCH-R970","GT-I9508","SCH-I959","GT-I9502","SGH-N045","SGH-I337M","SGH-M919V","SCH-R970X","SCH-R970C"],"Galaxy S4 Mini":["GT-I9195","GT-I9190","GT-I9195L","GT-I9195T","GT-I9192","GT-I9197","GT-I9198","SGH-I257M","SCH-I435"],"Galaxy Note 4":["SM-N910C","SM-N910P","SM-N910G","SM-N910V","SM-N910H","SM-N910A","SM-N910F","SM-N910R4","SM-N910S","SM-N910T","SM-N910U","SM-N910W8"],"Galaxy S5":["SM-G900","Galaxy S5","SM-G900H","SM-G900F","SM-G900FD","SM-G900I","SM-G900K","SM-G900L","SM-G900S","SM-G900M","SM-G900MD","SM-G900W8","SM-G900T","SM-G900T1","SM-G900A","SM-G900V","SM-G900R4","SM-G900P","SM-G9006W","SM-G9008V","SM-G9009D","SM-G900D","SM-G900J"],"Galaxy S6":["SM-G925F","SM-G928X","SM-G920V","Galaxy S6","SM-G925A","SM-G925S","SM-G925FQ","SM-G925i","SM-G925P","SM-G925R4","SM-G925T","SM-G925V","SM-G925W8","SM-G920FQ","SM-G920i","SM-G920P","SM-G920R4","SM-G920T","SM-G920S","SM-G920V","SM-G920W8"],"Galaxy S7":["SM-G935F","SM-G930V","SM-G930F","Galaxy S7","SM-G935FD","SM-G935W8","SM-G935S","SM-G935K","SM-G935L","SM-G9350","SM-G935V","SM-G935A","SM-G935P","SM-G935T","SM-G935U","SM-G935R4","SC-02H","SCV33","SM-G935U","SM-891A","SM-G930FD","SM-G930W8","SM-G930S","SM-G930K","SM-G930L","SM-G9300 ","SM-G930AZ","SM-G930P","SM-G930T","SM-G930R4","SM-G930R4","SM-G9308","SM-G930U","SM-G930A"],"Galaxy Tab S":["SM-T800","SM-T700","SM-T805","SM-T705","SCT21","SM-T807","SM-T807P","SM-T807V"],"Galaxy S10 Plus":["SM-G9750","SM-G975F","SM-G975U","SM-G975W","SM-G9758","SM-G975XU","SM-G975N"]},LG:{G2:["LG-D802","VS980 4G","LG-D800","LG-D801","LG-LS980","LG-D805","LG-D803","L-01F"],G3:["LG-D855","VS985 4G","LG-D850","LG-D851","LG-D852","LG-D858","LG-D859","LG-LS990","LG-US990","LG-AS985","LG-F400"],G4:["LG-H815","LG-H540","LG-H818","LG-H818N","LG-H818P","LG-LS991","LG-H810","LG-H819","LGLS991","LGVS986","LG LS991"],G5:["LG-H820","LG-H830","LG-H840","LG-H848","LG-H850","LG-H860","LG-VS987","LG-LS992"],G6:["LG-H870","LG-H870S","LG-H870K","LG-H870V","LG-H870DS","LG-H871","LG-H872","LG-H872PR","LG-H873","LG-G600S","LG-G600K","LG-G600L","LG-G600V","LG-US997","LG-LS993","LG-AS993","LG-VS998B","LG-VS998G","LG-VS998P","LG-VS998T","LG-VS998W"],G7:["LM-G710EAW","LMG710EAW","LM-G710","LMG710","LM-G710N","LMG710N","LM-G710EM","LMG710EM","LM-G710AWM","LMG710AWM","LM-G710EMW","LMG710EMW","LM-G710TM","LMG710TM","LM-G710ULM","LMG710ULM","LM-G710VMX","LMG710VMX","LM-G710PM","LMG710PM","LM-G710VM","LMG710VM"],"Optimus G Pro":["LG-E940","LG-E980","LG-E986","LG-E988","LG-E989"]},HTC:{"One M8":["HTC_0P6B","HTC6525LVW","HTC_PN071","HTC_P4550","HTC One M8"],"One M9":["HTC One M9"]},Motorola:{"Moto X 2nd Gen":["XT1092","XT1093","XT1094","XT1095","XT1096","XT1097","XT1085"],"Moto G":["XT1033","XT1032","XT1034","XT1028","XT1068","XT1031","XT1039","XT1040","XT1042","XT1045"],"Moto G4":["Moto G (4)","XT1625","XT1622","XT1621","XT1620","XT1626","XT1624"]},Nexus:{"Nexus 4":["Nexus 4"],"Nexus 9":["Nexus 9"]},OnePlus:{6:["ONEPLUS A6003"]},Asus:{"Asus ZenFone 2(E)":["ASUS ZenFone 2"],"Asus ZenFone Zoom":["ASUS_Z00XS","ASUS_ZX550","ASUS_ZX551ML"],"Asus Zoom 3":["ASUS_Z01HDA"],"Asus ZenPad 10":["P028","P023","P01T","P001","P00C"]},Sony:{"Xperia Tablet Z":["SGP311","SGP312","SGP321","SGP511","SO-03E","SGP351"],"Xperia Z1":["C6916","C6903","SO-02F","Xperia Z1","SOL23","C6902","C6906","C6943","L39t","L39h","D5503"]},HUAWEI:{"MediaPad M5 Pro":["CMR-W19","CMR-AL19"]},Google:{"Pixel C":["Pixel C"]}},c={Nexus:{"Nexus 9":["Nexus 9"],"Nexus 4":["Nexus 4"],"Nexus 5":["Nexus 5"],"Nexus 6":["Nexus 6"],"Nexus 6P":["Nexus 6P"]},Samsung:{"Galaxy Tab S":["SM-T800","SM-T700","SM-T801","SM-T805","SM-T705","SCT21","SM-T807","SM-T807P","SM-T807V"],"Galaxy Note 3":["SM-N900","GT-N9000","SCL22","SC-01F","SM-W900W8","SM-N9005","SM-N9002","SM-N9006","SM-N900A","SM-N900T","SM-N900P","SM-N900V","SM-N900R4"]},Motorola:{"Moto X":["XT1049","XT1050","XT1052","XT1053","XT1055","XT1056","XT1058","XT1060"],"Moto X 2nd Gen":["XT1092","XT1093","XT1094","XT1095","XT1096","XT1097","XT1085"],"Moto G4":["Moto G (4)","XT1625","XT1622","XT1621","XT1620","XT1626","XT1624"],"Moto G3":["MotoG3","MotoG3-TE","XT1540","XT1543","XT1544","XT1548","XT1541"]},Sony:{"Xperia Z1":["C6916","C6903","SO-02F","Xperia Z1","SOL23","C6902","C6906","C6943","L39t","L39h","D5503"]},Asus:{"Asus ZenFone Zoom":["ASUS_Z00XS","ASUS_ZX550","ASUS_ZX551ML"]},Redmi:{"Note 4":["Note 4"]},MI:{"MI 5X":["MI 5X"]},HTC:{"One M8":["HTC_0P6B","HTC6525LVW","HTC_PN071","HTC_P4550","HTC One M8"],"Desire 12+":["HTC Desire 12+"]}},u=t(),f=null,h=null;return{supportsAutoCapture:o,supportsSelfieCapture:r}}()}();
//# sourceMappingURL=KfxWebSDK.js.map
